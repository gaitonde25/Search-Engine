b'Misha and Grisha are funny boys, so they like to use new underground. The underground has n stations connected with n\xe2\x80\x89-\xe2\x80\x891 routes so that each route connects two stations, and it is possible to reach every station from any other.'
b'The boys decided to have fun and came up with a plan. Namely, in some day in the morning Misha will ride the underground from station s to station f by the shortest path, and will draw with aerosol an ugly text "Misha was here" on every station he will pass through (including s and f). After that on the same day at evening Grisha will ride from station t to station f by the shortest path and will count stations with Misha\'s text. After that at night the underground workers will wash the texts out, because the underground should be clean. '
b'The boys have already chosen three stations a, b and c for each of several following days, one of them should be station s on that day, another should be station f, and the remaining should be station t. They became interested how they should choose these stations s, f, t so that the number Grisha will count is as large as possible. They asked you for help.'
b'Input'
b'The first line contains two integers n and q (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105)\xc2\xa0\xe2\x80\x94 the number of stations and the number of days.'
b"The second line contains n\xe2\x80\x89-\xe2\x80\x891 integers p2,\xe2\x80\x89p3,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The integer pi means that there is a route between stations pi and i. It is guaranteed that it's possible to reach every station from any other."
b'The next q lines contains three integers a, b and c each (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)\xc2\xa0\xe2\x80\x94 the ids of stations chosen by boys for some day. Note that some of these ids could be same.'
b'Output'
b'Print q lines. In the i-th of these lines print the maximum possible number Grisha can get counting when the stations s, t and f are chosen optimally from the three stations on the i-th day.'
Tags
dfs and similar, graphs, trees, *1900
