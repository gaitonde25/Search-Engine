b'As a professional private tutor, Kuroni has to gather statistics of an exam. Kuroni has appointed you to complete this important task. You must not disappoint him.'
b'The exam consists of nn questions, and mm students have taken the exam. Each question was worth 11 point. Question ii was solved by at least lili and at most riri students. Additionally, you know that the total score of all students is tt.'
b'Furthermore, you took a glance at the final ranklist of the quiz. The students were ranked from 11 to mm, where rank 11 has the highest score and rank mm has the lowest score. Ties were broken arbitrarily.'
b'You know that the student at rank pipi had a score of sisi for 1\xe2\x89\xa4i\xe2\x89\xa4q1\xe2\x89\xa4i\xe2\x89\xa4q.'
b'You wonder if there could have been a huge tie for first place. Help Kuroni determine the maximum number of students who could have gotten as many points as the student with rank 11, and the maximum possible score for rank 11 achieving this maximum number of students.'
b'Input'
b'The first line of input contains two integers (1\xe2\x89\xa4n,m\xe2\x89\xa41051\xe2\x89\xa4n,m\xe2\x89\xa4105), denoting the number of questions of the exam and the number of students respectively.'
b'The next nn lines contain two integers each, with the ii-th line containing lili and riri (0\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4m0\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4m).'
b'The next line contains a single integer qq (0\xe2\x89\xa4q\xe2\x89\xa4m0\xe2\x89\xa4q\xe2\x89\xa4m). '
b'The next qq lines contain two integers each, denoting pipi and sisi (1\xe2\x89\xa4pi\xe2\x89\xa4m1\xe2\x89\xa4pi\xe2\x89\xa4m, 0\xe2\x89\xa4si\xe2\x89\xa4n0\xe2\x89\xa4si\xe2\x89\xa4n). It is guaranteed that all pipi are distinct and if pi\xe2\x89\xa4pjpi\xe2\x89\xa4pj, then si\xe2\x89\xa5sjsi\xe2\x89\xa5sj.'
b'The last line contains a single integer tt (0\xe2\x89\xa4t\xe2\x89\xa4nm0\xe2\x89\xa4t\xe2\x89\xa4nm), denoting the total score of all students.'
b'Output'
b'Output two integers: the maximum number of students who could have gotten as many points as the student with rank 11, and the maximum possible score for rank 11 achieving this maximum number of students. If there is no valid arrangement that fits the given data, output \xe2\x88\x921\xe2\x88\x921 \xe2\x88\x921\xe2\x88\x921.'
Tags
binary search, greedy, *3500
