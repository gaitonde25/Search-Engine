b'Polycarp lives on a coordinate line at the point x=0x=0. He goes to his friend that lives at the point x=ax=a. Polycarp can move only from left to right, he can pass one unit of length each second.'
b"Now it's raining, so some segments of his way are in the rain. Formally, it's raining on nn non-intersecting segments, the ii-th segment which is in the rain is represented as [li,ri][li,ri] (0\xe2\x89\xa4li<ri\xe2\x89\xa4a0\xe2\x89\xa4li<ri\xe2\x89\xa4a)."
b"There are mm umbrellas lying on the line, the ii-th umbrella is located at point xixi (0\xe2\x89\xa4xi\xe2\x89\xa4a0\xe2\x89\xa4xi\xe2\x89\xa4a) and has weight pipi. When Polycarp begins his journey, he doesn't have any umbrellas."
b"During his journey from x=0x=0 to x=ax=a Polycarp can pick up and throw away umbrellas. Polycarp picks up and throws down any umbrella instantly. He can carry any number of umbrellas at any moment of time. Because Polycarp doesn't want to get wet, he must carry at least one umbrella while he moves from xx to x+1x+1 if a segment [x,x+1][x,x+1] is in the rain (i.e. if there exists some ii such that li\xe2\x89\xa4xli\xe2\x89\xa4x and x+1\xe2\x89\xa4rix+1\xe2\x89\xa4ri)."
b'The condition above is the only requirement. For example, it is possible to go without any umbrellas to a point where some rain segment starts, pick up an umbrella at this point and move along with an umbrella. Polycarp can swap umbrellas while he is in the rain.'
b"Each unit of length passed increases Polycarp's fatigue by the sum of the weights of umbrellas he carries while moving."
b'Can Polycarp make his way from point x=0x=0 to point x=ax=a? If yes, find the minimum total fatigue after reaching x=ax=a, if Polycarp picks up and throws away umbrellas optimally.'
b'Input'
b"The first line contains three integers aa, nn and mm (1\xe2\x89\xa4a,m\xe2\x89\xa42000,1\xe2\x89\xa4n\xe2\x89\xa4\xe2\x8c\x88a2\xe2\x8c\x891\xe2\x89\xa4a,m\xe2\x89\xa42000,1\xe2\x89\xa4n\xe2\x89\xa4\xe2\x8c\x88a2\xe2\x8c\x89) \xe2\x80\x94 the point at which Polycarp's friend lives, the number of the segments in the rain and the number of umbrellas."
b'Each of the next nn lines contains two integers lili and riri (0\xe2\x89\xa4li<ri\xe2\x89\xa4a0\xe2\x89\xa4li<ri\xe2\x89\xa4a) \xe2\x80\x94 the borders of the ii-th segment under rain. It is guaranteed that there is no pair of intersecting segments. In other words, for each pair of segments ii and jj either ri<ljri<lj or rj<lirj<li.'
b'Each of the next mm lines contains two integers xixi and pipi (0\xe2\x89\xa4xi\xe2\x89\xa4a0\xe2\x89\xa4xi\xe2\x89\xa4a, 1\xe2\x89\xa4pi\xe2\x89\xa41051\xe2\x89\xa4pi\xe2\x89\xa4105) \xe2\x80\x94 the location and the weight of the ii-th umbrella.'
b'Output'
b'Print "-1" (without quotes) if Polycarp can\'t make his way from point x=0x=0 to point x=ax=a. Otherwise print one integer \xe2\x80\x94 the minimum total fatigue after reaching x=ax=a, if Polycarp picks up and throws away umbrellas optimally.'
Tags
dp, *2100
