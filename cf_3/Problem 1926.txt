b'There are nn cities in Treeland connected with n\xe2\x88\x921n\xe2\x88\x921 bidirectional roads in such that a way that any city is reachable from any other; in other words, the graph of cities and roads is a tree. Treeland is preparing for a seasonal virus epidemic, and currently, they are trying to evaluate different infection scenarios.'
b'In each scenario, several cities are initially infected with different virus species. Suppose that there are kiki virus species in the ii-th scenario. Let us denote vjvj the initial city for the virus jj, and sjsj the propagation speed of the virus jj. The spread of the viruses happens in turns: first virus 11 spreads, followed by virus 22, and so on. After virus kiki spreads, the process starts again from virus 11.'
b'A spread turn of virus jj proceeds as follows. For each city xx not infected with any virus at the start of the turn, at the end of the turn it becomes infected with virus jj if and only if there is such a city yy that:'
b' city yy was infected with virus jj at the start of the turn; the path between cities xx and yy contains at most sjsj edges; all cities on the path between cities xx and yy (excluding yy) were uninfected with any virus at the start of the turn.'
b'Once a city is infected with a virus, it stays infected indefinitely and can not be infected with any other virus. The spread stops once all cities are infected.'
b'You need to process qq independent scenarios. Each scenario is described by kiki virus species and mimi important cities. For each important city determine which the virus it will be infected by in the end.'
b'Input'
b'The first line contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of cities in Treeland.'
b'The following n\xe2\x88\x921n\xe2\x88\x921 lines describe the roads. The ii-th of these lines contains two integers xixi and yiyi (1\xe2\x89\xa4xi,yi\xe2\x89\xa4n1\xe2\x89\xa4xi,yi\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 indices of cities connecting by the ii-th road. It is guaranteed that the given graph of cities and roads is a tree.'
b'The next line contains a single integer qq (1\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of infection scenarios. qq scenario descriptions follow.'
b'The description of the ii-th scenario starts with a line containing two integers kiki and mimi (1\xe2\x89\xa4ki,mi\xe2\x89\xa4n1\xe2\x89\xa4ki,mi\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the number of virus species and the number of important cities in this scenario respectively. It is guaranteed that \xe2\x88\x91qi=1ki\xe2\x88\x91i=1qki and \xe2\x88\x91qi=1mi\xe2\x88\x91i=1qmi do not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'The following kiki lines describe the virus species. The jj-th of these lines contains two integers vjvj and sjsj (1\xe2\x89\xa4vj\xe2\x89\xa4n1\xe2\x89\xa4vj\xe2\x89\xa4n, 1\xe2\x89\xa4sj\xe2\x89\xa41061\xe2\x89\xa4sj\xe2\x89\xa4106)\xc2\xa0\xe2\x80\x93 the initial city and the propagation speed of the virus species jj. It is guaranteed that the initial cities of all virus species within a scenario are distinct.'
b'The following line contains mimi distinct integers u1,\xe2\x80\xa6,umiu1,\xe2\x80\xa6,umi (1\xe2\x89\xa4uj\xe2\x89\xa4n1\xe2\x89\xa4uj\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 indices of important cities.'
b'Output'
b'Print qq lines. The ii-th line should contain mimi integers\xc2\xa0\xe2\x80\x94 indices of virus species that cities u1,\xe2\x80\xa6,umiu1,\xe2\x80\xa6,umi are infected with at the end of the ii-th scenario.'
Tags
data structures, dfs and similar, dp, shortest paths, trees, *3000
