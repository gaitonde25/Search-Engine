b'Wu got hungry after an intense training session, and came to a nearby store to buy his favourite instant noodles. After Wu paid for his purchase, the cashier gave him an interesting task.'
b'You are given a bipartite graph with positive integers in all vertices of the right half. For a subset SS of vertices of the left half we define N(S)N(S) as the set of all vertices of the right half adjacent to at least one vertex in SS, and f(S)f(S) as the sum of all numbers in vertices of N(S)N(S). Find the greatest common divisor of f(S)f(S) for all possible non-empty subsets SS (assume that GCD of empty set is 00).'
b'Wu is too tired after his training to solve this problem. Help him!'
b'Input'
b'The first line contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa45000001\xe2\x89\xa4t\xe2\x89\xa4500000)\xc2\xa0\xe2\x80\x94 the number of test cases in the given test set. Test case descriptions follow.'
b'The first line of each case description contains two integers nn and mm (1\xc2\xa0\xe2\x89\xa4\xc2\xa0n,\xc2\xa0m\xc2\xa0\xe2\x89\xa4\xc2\xa05000001\xc2\xa0\xe2\x89\xa4\xc2\xa0n,\xc2\xa0m\xc2\xa0\xe2\x89\xa4\xc2\xa0500000)\xc2\xa0\xe2\x80\x94 the number of vertices in either half of the graph, and the number of edges respectively.'
b'The second line contains nn integers cici (1\xe2\x89\xa4ci\xe2\x89\xa410121\xe2\x89\xa4ci\xe2\x89\xa41012). The ii-th number describes the integer in the vertex ii of the right half of the graph.'
b'Each of the following mm lines contains a pair of integers uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n), describing an edge between the vertex uiui of the left half and the vertex vivi of the right half. It is guaranteed that the graph does not contain multiple edges.'
b'Test case descriptions are separated with empty lines. The total value of nn across all test cases does not exceed 500000500000, and the total value of mm across all test cases does not exceed 500000500000 as well.'
b'Output'
b'For each test case print a single integer\xc2\xa0\xe2\x80\x94 the required greatest common divisor.'
Tags
graphs, hashing, math, number theory, *2300
