b'There are nn reindeer at the North Pole, all battling for the highest spot on the "Top Reindeer" leaderboard on the front page of CodeNorses (a popular competitive reindeer gaming website). Interestingly, the "Top Reindeer" title is just a measure of upvotes and has nothing to do with their skill level in the reindeer games, but they still give it the utmost importance.'
b'Currently, the ii-th reindeer has a score of aiai. You would like to influence the leaderboard with some operations. In an operation, you can choose a reindeer, and either increase or decrease his score by 11 unit. Negative scores are allowed.'
b'You have mm requirements for the resulting scores. Each requirement is given by an ordered pair (u,v)(u,v), meaning that after all operations, the score of reindeer uu must be less than or equal to the score of reindeer vv.'
b'Your task is to perform the minimum number of operations so that all requirements will be satisfied.'
b'Input'
b'The first line contains two integers nn and mm (2\xe2\x89\xa4n\xe2\x89\xa410002\xe2\x89\xa4n\xe2\x89\xa41000; 1\xe2\x89\xa4m\xe2\x89\xa410001\xe2\x89\xa4m\xe2\x89\xa41000)\xc2\xa0\xe2\x80\x94 the number of reindeer and requirements, respectively.'
b'The second line contains nn integers a1,\xe2\x80\xa6,ana1,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa41091\xe2\x89\xa4ai\xe2\x89\xa4109), where aiai is the current score of reindeer ii.'
b'The next mm lines describe the requirements.'
b'The ii-th of these lines contains two integers uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n; ui\xe2\x89\xa0viui\xe2\x89\xa0vi)\xc2\xa0\xe2\x80\x94 the two reindeer of the ii-th requirement.'
b'Output'
b'Print nn integers b1,\xe2\x80\xa6,bnb1,\xe2\x80\xa6,bn (\xe2\x88\x921015\xe2\x89\xa4bi\xe2\x89\xa41015\xe2\x88\x921015\xe2\x89\xa4bi\xe2\x89\xa41015), where bibi is the score of the ii-th reindeer after all operations.'
b'If there are multiple solutions achieving the minimum number of operations, you may output any.'
b'We can prove that there is always an optimal solution such that |bi|\xe2\x89\xa41015|bi|\xe2\x89\xa41015 for all ii.'
Tags
binary search, constructive algorithms, data structures, divide and conquer, flows, graphs, shortest paths, *3000
