b"One fine day Sasha went to the park for a walk. In the park, he saw that his favorite bench is occupied, and he had to sit down on the neighboring one. He sat down and began to listen to the silence. Suddenly, he got a question: what if in different parts of the park, the silence sounds in different ways? So it was. Let's divide the park into 1\xc3\x9711\xc3\x971 meter squares and call them cells, and numerate rows from 11 to nn from up to down, and columns from 11 to mm from left to right. And now, every cell can be described with a pair of two integers (x,y)(x,y), where xx\xc2\xa0\xe2\x80\x94 the number of the row, and yy\xc2\xa0\xe2\x80\x94 the number of the column. Sasha knows that the level of silence in the cell (i,j)(i,j) equals to fi,jfi,j, and all fi,jfi,j form a permutation of numbers from 11 to n\xe2\x8b\x85mn\xe2\x8b\x85m. Sasha decided to count, how many are there pleasant segments of silence?"
b'Let\'s take some segment [l\xe2\x80\xa6r][l\xe2\x80\xa6r]. Denote SS as the set of cells (i,j)(i,j) that l\xe2\x89\xa4fi,j\xe2\x89\xa4rl\xe2\x89\xa4fi,j\xe2\x89\xa4r. Then, the segment of silence [l\xe2\x80\xa6r][l\xe2\x80\xa6r] is pleasant if there is only one simple path between every pair of cells from SS (path can\'t contain cells, which are not in SS). In other words, set SS should look like a tree on a plain. Sasha has done this task pretty quickly, and called the algorithm\xc2\xa0\xe2\x80\x94 "algorithm of silence\'s sounds".'
b'Time passed, and the only thing left from the algorithm is a legend. To prove the truthfulness of this story, you have to help Sasha and to find the number of different pleasant segments of silence. Two segments [l1\xe2\x80\xa6r1][l1\xe2\x80\xa6r1], [l2\xe2\x80\xa6r2][l2\xe2\x80\xa6r2] are different, if l1\xe2\x89\xa0l2l1\xe2\x89\xa0l2 or r1\xe2\x89\xa0r2r1\xe2\x89\xa0r2 or both at the same time.'
b'Input'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n,m\xe2\x89\xa410001\xe2\x89\xa4n,m\xe2\x89\xa41000, 1\xe2\x89\xa4n\xe2\x8b\x85m\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x8b\x85m\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the size of the park.'
b'Each from next nn lines contains mm integers fi,jfi,j (1\xe2\x89\xa4fi,j\xe2\x89\xa4n\xe2\x8b\x85m1\xe2\x89\xa4fi,j\xe2\x89\xa4n\xe2\x8b\x85m)\xc2\xa0\xe2\x80\x94 the level of silence in the cell with number (i,j)(i,j).'
b'It is guaranteed, that all fi,jfi,j are different.'
b'Output'
b'Print one integer\xc2\xa0\xe2\x80\x94 the number of pleasant segments of silence.'
Tags
data structures, trees, *3200
