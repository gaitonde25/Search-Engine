b'Dalaran is a flying city of magic. It consists of nn floating islands connected by mm bridges (each bridge can be traversed in both directions). Every island is reachable from every other along these bridges. It would be a shame if some magic experiment went horribly wrong and this magnificent city got destroyed, right?'
b"Well, just guess what happened. A portal to demons' realm was opened at the island 11. This is the start of day 11 of the catastrophe, and all kk mages have gathered at the island 11 (they were trying to close the portal, but found out that it was impossible). At the start of day 22, a gigantic horde of demons will emerge from the portal, capture the island 11 and kill every mage staying at that island. During each day ii, if the island vv was captured by demons by the start of the day, the horde of demons will travel across all bridges connected directly to vv, capture every island they reach, and kill every mage they meet along the way."
b'Each bridge contains exactly one magic stone. Each mage at the start of the day can do one of the following actions:'
b'  Spend one day travelling along one of the bridges connected to the island where the mage currently is. When passing through a bridge, the mage can pick up the magic stone from it (if there is any; each magic stone can be picked up by at most one mage). If the bridge is passed by the demons during the same day, or by the start of the next day, the island where the mage goes is already captured by the demonic horde (even if they arrive there at the same moment), the mage is killed.  Perform a teleportation ritual to get to safety outside Dalaran. This ritual consumes two magic stones (and cannot be performed if the mage has less than two stones). '
b'Each magic stone decays in 22 days, so if is picked up in the middle of day ii, it decays in the middle of day i+2i+2. Decayed stones cannot be used in teleportation ritual.'
b'Calculate the maximum number of mages that can get to safety.'
b'Input'
b'The first line contains three integers nn, mm and kk (2\xe2\x89\xa4n\xe2\x89\xa41052\xe2\x89\xa4n\xe2\x89\xa4105; n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa4105n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa4105; 1\xe2\x89\xa4k\xe2\x89\xa41051\xe2\x89\xa4k\xe2\x89\xa4105) \xe2\x80\x94 the number of islands, the number of bridges and the number of mages.'
b'Then mm lines follow, the ii-th line contains two integers xixi and yiyi (1\xe2\x89\xa4xi,yi\xe2\x89\xa4n1\xe2\x89\xa4xi,yi\xe2\x89\xa4n; xi\xe2\x89\xa0yixi\xe2\x89\xa0yi) denoting a bridge between the islands xixi and yiyi.'
b'Each pair of islands has at most one bridge connecting them. Every island is reachable from every other island along the bridges.'
b'Output'
b'Print one integer \xe2\x80\x94 the maximum number of mages that can get to safety.'
Tags
*special problem, flows, *3100
