b'You are given a rooted tree consisting of nn vertices. Vertices are numbered from 11 to nn. Any vertex can be the root of a tree.'
b'A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root.'
b'The tree is specified by an array of ancestors bb containing nn numbers: bibi is an ancestor of the vertex with the number ii. The ancestor of a vertex uu is a vertex that is the next vertex on a simple path from uu to the root. For example, on the simple path from 55 to 33 (the root), the next vertex would be 11, so the ancestor of 55 is 11.'
b'The root has no ancestor, so for it, the value of bibi is ii (the root is the only vertex for which bi=ibi=i).'
b'For example, if n=5n=5 and b=[3,1,3,3,1]b=[3,1,3,3,1], then the tree looks like this.'
b'  An example of a rooted tree for n=5n=5, the root of the tree is a vertex number 33. '
b'You are given an array pp\xc2\xa0\xe2\x80\x94 a permutation of the vertices of the tree. If it is possible, assign any positive integer weights on the edges, so that the vertices sorted by distance from the root would form the given permutation pp.'
b'In other words, for a given permutation of vertices pp, it is necessary to choose such edge weights so that the condition dist[pi]<dist[pi+1]dist[pi]<dist[pi+1] is true for each ii from 11 to n\xe2\x88\x921n\xe2\x88\x921. dist[u]dist[u] is a sum of the weights of the edges on the path from the root to uu. In particular, dist[u]=0dist[u]=0 if the vertex uu is the root of the tree.'
b'For example, assume that p=[3,1,2,5,4]p=[3,1,2,5,4]. In this case, the following edge weights satisfy this permutation:'
b'  the edge (3,43,4) has a weight of 102102;  the edge (3,13,1) has weight of 11;  the edge (1,21,2) has a weight of 1010;  the edge (1,51,5) has a weight of 100100. '
b'The array of distances from the root looks like: dist=[1,11,0,102,101]dist=[1,11,0,102,101]. The vertices sorted by increasing the distance from the root form the given permutation pp.'
b'Print the required edge weights or determine that there is no suitable way to assign weights. If there are several solutions, then print any of them.'
b'Input'
b'The first line of input data contains an integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104) \xe2\x80\x94 the number of input data sets in the test.'
b'Each test case consists of three lines.'
b'The first of them contains an integer nn (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105). It is the number of vertices in the tree.'
b'The second line contains nn integers b1,b2,\xe2\x80\xa6,bnb1,b2,\xe2\x80\xa6,bn (1\xe2\x89\xa4bi\xe2\x89\xa4n1\xe2\x89\xa4bi\xe2\x89\xa4n). It is guaranteed that the bb array encodes some rooted tree.'
b'The third line contains the given permutation pp: nn of different integers p1,p2,\xe2\x80\xa6,pnp1,p2,\xe2\x80\xa6,pn (1\xe2\x89\xa4pi\xe2\x89\xa4n1\xe2\x89\xa4pi\xe2\x89\xa4n).'
b'It is guaranteed that the sum of the values nn over all test cases in the test does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each set of input data print the answer on a separate line.'
b'If the solution exists, print an array of nn integers w1,w2,\xe2\x80\xa6,wnw1,w2,\xe2\x80\xa6,wn, where wiwi is the weight of the edge that leads from bibi to ii. For the root there is no such edge, so use the value wi=0wi=0. For all other vertices, the values of wiwi must satisfy the inequality 1\xe2\x89\xa4wi\xe2\x89\xa41091\xe2\x89\xa4wi\xe2\x89\xa4109. There can be equal numbers among wiwi values, but all sums of weights of edges from the root to vertices must be different and satisfy the given permutation.'
b'If there are several solutions, output any of them.'
b'If no solution exists, output -1.'
Tags
constructive algorithms, trees, *1500
