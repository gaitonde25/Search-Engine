b'You are given a binary matrix AA of size n\xc3\x97nn\xc3\x97n. Rows are numbered from top to bottom from 11 to nn, columns are numbered from left to right from 11 to nn. The element located at the intersection of row ii and column jj is called AijAij. Consider a set of 44 operations:'
b'  Cyclically shift all rows up. The row with index ii will be written in place of the row i\xe2\x88\x921i\xe2\x88\x921 (2\xe2\x89\xa4i\xe2\x89\xa4n2\xe2\x89\xa4i\xe2\x89\xa4n), the row with index 11 will be written in place of the row nn.  Cyclically shift all rows down. The row with index ii will be written in place of the row i+1i+1 (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), the row with index nn will be written in place of the row 11.  Cyclically shift all columns to the left. The column with index jj will be written in place of the column j\xe2\x88\x921j\xe2\x88\x921 (2\xe2\x89\xa4j\xe2\x89\xa4n2\xe2\x89\xa4j\xe2\x89\xa4n), the column with index 11 will be written in place of the column nn.  Cyclically shift all columns to the right. The column with index jj will be written in place of the column j+1j+1 (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921), the column with index nn will be written in place of the column 11. '
b'  The 3\xc3\x9733\xc3\x973 matrix is shown on the left before the 33-rd operation is applied to it, on the right\xc2\xa0\xe2\x80\x94 after. '
b'You can perform an arbitrary (possibly zero) number of operations on the matrix; the operations can be performed in any order.'
b'After that, you can perform an arbitrary (possibly zero) number of new xor-operations:'
b'  Select any element AijAij and assign it with new value Aij\xe2\x8a\x951Aij\xe2\x8a\x951. In other words, the value of (Aij+1)mod2(Aij+1)mod2 will have to be written into element AijAij. '
b'Each application of this xor-operation costs one burl. Note that the 44 shift operations\xc2\xa0\xe2\x80\x94 are free. These 44 operations can only be performed before xor-operations are performed.'
b'Output the minimum number of burles you would have to pay to make the AA matrix unitary. A unitary matrix is a matrix with ones on the main diagonal and the rest of its elements are zeros (that is, Aij=1Aij=1 if i=ji=j and Aij=0Aij=0 otherwise).'
b'Input'
b'The first line of the input contains an integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104)\xc2\xa0\xe2\x80\x94the number of test cases in the test.'
b'The descriptions of the test cases follow. Before each test case, an empty line is written in the input.'
b'The first line of each test case contains a single number nn (1\xe2\x89\xa4n\xe2\x89\xa420001\xe2\x89\xa4n\xe2\x89\xa42000)'
b'This is followed by nn lines, each containing exactly nn characters and consisting only of zeros and ones. These lines describe the values in the elements of the matrix.'
b'It is guaranteed that the sum of n2n2 values over all test cases does not exceed 4\xe2\x8b\x851064\xe2\x8b\x85106.'
b'Output'
b'For each test case, output the minimum number of burles you would have to pay to make the AA matrix unitary. In other words, print the minimum number of xor-operations it will take after applying cyclic shifts to the matrix for the AA matrix to become unitary.'
Tags
brute force, constructive algorithms, greedy, implementation, *1600
