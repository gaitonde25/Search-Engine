b'You are given a set of nn segments on a line [Li;Ri][Li;Ri]. All 2n2n segment endpoints are pairwise distinct integers.'
b'The set is laminar\xc2\xa0\xe2\x80\x94 any two segments are either disjoint or one of them contains the other.'
b'Choose a non-empty subsegment [li,ri][li,ri] with integer endpoints in each segment (Li\xe2\x89\xa4li<ri\xe2\x89\xa4RiLi\xe2\x89\xa4li<ri\xe2\x89\xa4Ri) in such a way that no two subsegments intersect (they are allowed to have common endpoints though) and the sum of their lengths (\xe2\x88\x91ni=1ri\xe2\x88\x92li\xe2\x88\x91i=1nri\xe2\x88\x92li) is maximized.'
b'Input'
b'The first line contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851031\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85103)\xc2\xa0\xe2\x80\x94 the number of segments.'
b'The ii-th of the next nn lines contains two integers LiLi and RiRi (0\xe2\x89\xa4Li<Ri\xe2\x89\xa41090\xe2\x89\xa4Li<Ri\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the endpoints of the ii-th segment.'
b'All the given 2n2n segment endpoints are distinct. The set of segments is laminar.'
b'Output'
b'On the first line, output the maximum possible sum of subsegment lengths.'
b'On the ii-th of the next nn lines, output two integers lili and riri (Li\xe2\x89\xa4li<ri\xe2\x89\xa4RiLi\xe2\x89\xa4li<ri\xe2\x89\xa4Ri), denoting the chosen subsegment of the ii-th segment.'
Tags
dp, *3200
