b'You have two strings aa and bb of equal even length nn consisting of characters 0 and 1.'
b"We're in the endgame now. To finally make the universe perfectly balanced, you need to make strings aa and bb equal."
b'In one step, you can choose any prefix of aa of even length and reverse it. Formally, if a=a1a2\xe2\x80\xa6ana=a1a2\xe2\x80\xa6an, you can choose a positive even integer p\xe2\x89\xa4np\xe2\x89\xa4n and set aa to apap\xe2\x88\x921\xe2\x80\xa6a1ap+1ap+2\xe2\x80\xa6anapap\xe2\x88\x921\xe2\x80\xa6a1ap+1ap+2\xe2\x80\xa6an.'
b"Find a way to make aa equal to bb using at most n+1n+1 reversals of the above kind, or determine that such a way doesn't exist. The number of reversals doesn't have to be minimized."
b'Input'
b'The first line contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa420001\xe2\x89\xa4t\xe2\x89\xa42000), denoting the number of test cases.'
b'Each test case consists of two lines. The first line contains a string aa of length nn, and the second line contains a string bb of the same length (2\xe2\x89\xa4n\xe2\x89\xa440002\xe2\x89\xa4n\xe2\x89\xa44000; nmod2=0nmod2=0). Both strings consist of characters 0 and 1.'
b"The sum of nn over all tt test cases doesn't exceed 40004000."
b'Output'
b"For each test case, if it's impossible to make aa equal to bb in at most n+1n+1 reversals, output a single integer \xe2\x88\x921\xe2\x88\x921."
b'Otherwise, output an integer kk (0\xe2\x89\xa4k\xe2\x89\xa4n+10\xe2\x89\xa4k\xe2\x89\xa4n+1), denoting the number of reversals in your sequence of steps, followed by kk even integers p1,p2,\xe2\x80\xa6,pkp1,p2,\xe2\x80\xa6,pk (2\xe2\x89\xa4pi\xe2\x89\xa4n2\xe2\x89\xa4pi\xe2\x89\xa4n; pimod2=0pimod2=0), denoting the lengths of prefixes of aa to be reversed, in chronological order.'
b"Note that kk doesn't have to be minimized. If there are many solutions, output any of them."
Tags
constructive algorithms, *3300
