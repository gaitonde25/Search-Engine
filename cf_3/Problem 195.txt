b'Dima is taking part in a show organized by his friend Peter. In this show Dima is required to cross a 3\xc3\x97n3\xc3\x97n rectangular field. Rows are numbered from 11 to 33 and columns are numbered from 11 to nn.'
b"The cell in the intersection of the ii-th row and the jj-th column of the field contains an integer ai,jai,j. Initially Dima's score equals zero, and whenever Dima reaches a cell in the row ii and the column jj, his score changes by ai,jai,j. Note that the score can become negative."
b"Initially all cells in the first and the third row are marked as available, and all cells in the second row are marked as unavailable. However, Peter offered Dima some help: there are qq special offers in the show, the ii-th special offer allows Dima to mark cells in the second row between lili and riri as available, though Dima's score reduces by kiki whenever he accepts a special offer. Dima is allowed to use as many special offers as he wants, and might mark the same cell as available multiple times."
b'Dima starts his journey in the cell (1,1)(1,1) and would like to reach the cell (3,n)(3,n). He can move either down to the next row or right to the next column (meaning he could increase the current row or column by 1), thus making n+1n+1 moves in total, out of which exactly n\xe2\x88\x921n\xe2\x88\x921 would be horizontal and 22 would be vertical.'
b'Peter promised Dima to pay him based on his final score, so the sum of all numbers of all visited cells minus the cost of all special offers used. Please help Dima to maximize his final score.'
b'Input'
b'The first input line contains two integers nn and qq (1\xe2\x89\xa4n,q\xe2\x89\xa45000001\xe2\x89\xa4n,q\xe2\x89\xa4500000)\xc2\xa0\xe2\x80\x94 the number of columns in the field and the number of special offers.'
b'The next three lines describe the field, ii-th of them contains nn integers ai1ai1, ai2ai2, ..., ainain (\xe2\x88\x92109\xe2\x89\xa4aij\xe2\x89\xa4109)\xe2\x88\x92109\xe2\x89\xa4aij\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the values in the ii-th row.'
b'The next qq lines describe special offers: the ii-th offer is described by 3 integers lili, riri and kiki (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n, 1\xe2\x89\xa4ki\xe2\x89\xa41091\xe2\x89\xa4ki\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the segment that becomes unblocked and the cost of this special offer.'
b'Output'
b'Output one integer\xc2\xa0\xe2\x80\x94 the maximum final score Dima can achieve.'
Tags
data structures, divide and conquer, dp, implementation, shortest paths, *2800
