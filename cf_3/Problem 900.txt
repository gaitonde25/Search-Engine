b'In Fire City, there are nn intersections and mm one-way roads. The ii-th road goes from intersection aiai to bibi and has length lili miles. '
b'There are qq cars that may only drive along those roads. The ii-th car starts at intersection vivi and has an odometer that begins at sisi, increments for each mile driven, and resets to 00 whenever it reaches titi. Phoenix has been tasked to drive cars along some roads (possibly none) and return them to their initial intersection with the odometer showing 00.'
b'For each car, please find if this is possible. '
b"A car may visit the same road or intersection an arbitrary number of times. The odometers don't stop counting the distance after resetting, so odometers may also be reset an arbitrary number of times."
b'Input'
b'The first line of the input contains two integers nn and mm (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105; 1\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of intersections and the number of roads, respectively.'
b'Each of the next mm lines contain three integers aiai, bibi, and lili (1\xe2\x89\xa4ai,bi\xe2\x89\xa4n1\xe2\x89\xa4ai,bi\xe2\x89\xa4n; ai\xe2\x89\xa0biai\xe2\x89\xa0bi; 1\xe2\x89\xa4li\xe2\x89\xa41091\xe2\x89\xa4li\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the information about the ii-th road. The graph is not necessarily connected. It is guaranteed that between any two intersections, there is at most one road for each direction.'
b'The next line contains an integer qq (1\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of cars.'
b'Each of the next qq lines contains three integers vivi, sisi, and titi (1\xe2\x89\xa4vi\xe2\x89\xa4n1\xe2\x89\xa4vi\xe2\x89\xa4n; 0\xe2\x89\xa4si<ti\xe2\x89\xa41090\xe2\x89\xa4si<ti\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the initial intersection of the ii-th car, the initial number on the ii-th odometer, and the number at which the ii-th odometer resets, respectively.'
b'Output'
b"Print qq answers. If the ii-th car's odometer may be reset to 00 by driving through some roads (possibly none) and returning to its starting intersection vivi, print YES. Otherwise, print NO."
Tags
dfs and similar, graphs, math, number theory, *2700
