b'SIHanatsuka - EMber'
b' '
b'SIHanatsuka - ATONEMENT'
b'Back in time, the seven-year-old Nora used to play lots of games with her creation ROBO_Head-02, both to have fun and enhance his abilities.'
b"One day, Nora's adoptive father, Phoenix Wyle, brought Nora nn boxes of toys. Before unpacking, Nora decided to make a fun game for ROBO."
b'She labelled all nn boxes with nn distinct integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an and asked ROBO to do the following action several (possibly zero) times:'
b'  Pick three distinct indices ii, jj and kk, such that ai\xe2\x88\xa3ajai\xe2\x88\xa3aj and ai\xe2\x88\xa3akai\xe2\x88\xa3ak. In other words, aiai divides both ajaj and akak, that is ajmodai=0ajmodai=0, akmodai=0akmodai=0.  After choosing, Nora will give the kk-th box to ROBO, and he will place it on top of the box pile at his side. Initially, the pile is empty.  After doing so, the box kk becomes unavailable for any further actions. '
b'Being amused after nine different tries of the game, Nora asked ROBO to calculate the number of possible different piles having the largest amount of boxes in them. Two piles are considered different if there exists a position where those two piles have different boxes.'
b'Since ROBO was still in his infant stages, and Nora was still too young to concentrate for a long time, both fell asleep before finding the final answer. Can you help them?'
b'As the number of such piles can be very large, you should print the answer modulo 109+7109+7.'
b'Input'
b'The first line contains an integer nn (3\xe2\x89\xa4n\xe2\x89\xa4603\xe2\x89\xa4n\xe2\x89\xa460), denoting the number of boxes.'
b'The second line contains nn distinct integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4601\xe2\x89\xa4ai\xe2\x89\xa460), where aiai is the label of the ii-th box.'
b'Output'
b'Print the number of distinct piles having the maximum number of boxes that ROBO_Head can have, modulo 109+7109+7.'
Tags
bitmasks, combinatorics, dp, *3500
