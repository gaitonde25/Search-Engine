b'Monocarp plays a computer game. There are nn different sets of armor and mm different weapons in this game. If a character equips the ii-th set of armor and wields the jj-th weapon, their power is usually equal to i+ji+j; but some combinations of armor and weapons synergize well. Formally, there is a list of qq ordered pairs, and if the pair (i,j)(i,j) belongs to this list, the power of the character equipped with the ii-th set of armor and wielding the jj-th weapon is not i+ji+j, but i+j+1i+j+1.'
b"Initially, Monocarp's character has got only the 11-st armor set and the 11-st weapon. Monocarp can obtain a new weapon or a new set of armor in one hour. If he wants to obtain the kk-th armor set or the kk-th weapon, he must possess a combination of an armor set and a weapon that gets his power to kk or greater. Of course, after Monocarp obtains a weapon or an armor set, he can use it to obtain new armor sets or weapons, but he can go with any of the older armor sets and/or weapons as well."
b'Monocarp wants to obtain the nn-th armor set and the mm-th weapon. What is the minimum number of hours he has to spend on it? '
b'Input'
b'The first line contains two integers nn and mm (2\xe2\x89\xa4n,m\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n,m\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of armor sets and the number of weapons, respectively.'
b'The second line contains one integer qq (0\xe2\x89\xa4q\xe2\x89\xa4min(2\xe2\x8b\x85105,nm)0\xe2\x89\xa4q\xe2\x89\xa4min(2\xe2\x8b\x85105,nm)) \xe2\x80\x94 the number of combinations that synergize well.'
b'Then qq lines follow, the ii-th line contains two integers aiai and bibi (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n; 1\xe2\x89\xa4bi\xe2\x89\xa4m1\xe2\x89\xa4bi\xe2\x89\xa4m) meaning that the aiai-th armor set synergizes well with the bibi-th weapon. All pairs (ai,bi)(ai,bi) are distinct.'
b'Output'
b'Print one integer \xe2\x80\x94 the minimum number of hours Monocarp has to spend to obtain both the nn-th armor set and the mm-th weapon.'
Tags
brute force, dp, greedy, shortest paths, *2800
