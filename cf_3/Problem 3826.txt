b'In the year of 30XX30XX participants of some world programming championship live in a single large hotel. The hotel has nn floors. Each floor has mm sections with a single corridor connecting all of them. The sections are enumerated from 11 to mm along the corridor, and all sections with equal numbers on different floors are located exactly one above the other. Thus, the hotel can be represented as a rectangle of height nn and width mm. We can denote sections with pairs of integers (i,j)(i,j), where ii is the floor, and jj is the section number on the floor.'
b"The guests can walk along the corridor on each floor, use stairs and elevators. Each stairs or elevator occupies all sections (1,x)(1,x), (2,x)(2,x), \xe2\x80\xa6\xe2\x80\xa6, (n,x)(n,x) for some xx between 11 and mm. All sections not occupied with stairs or elevators contain guest rooms. It takes one time unit to move between neighboring sections on the same floor or to move one floor up or down using stairs. It takes one time unit to move up to vv floors in any direction using an elevator. You can assume you don't have to wait for an elevator, and the time needed to enter or exit an elevator is negligible."
b'You are to process qq queries. Each query is a question "what is the minimum time needed to go from a room in section (x1,y1)(x1,y1) to a room in section (x2,y2)(x2,y2)?"'
b'Input'
b'The first line contains five integers n,m,cl,ce,vn,m,cl,ce,v (2\xe2\x89\xa4n,m\xe2\x89\xa41082\xe2\x89\xa4n,m\xe2\x89\xa4108, 0\xe2\x89\xa4cl,ce\xe2\x89\xa41050\xe2\x89\xa4cl,ce\xe2\x89\xa4105, 1\xe2\x89\xa4cl+ce\xe2\x89\xa4m\xe2\x88\x9211\xe2\x89\xa4cl+ce\xe2\x89\xa4m\xe2\x88\x921, 1\xe2\x89\xa4v\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4v\xe2\x89\xa4n\xe2\x88\x921)\xc2\xa0\xe2\x80\x94 the number of floors and section on each floor, the number of stairs, the number of elevators and the maximum speed of an elevator, respectively.'
b'The second line contains clcl integers l1,\xe2\x80\xa6,lcll1,\xe2\x80\xa6,lcl in increasing order (1\xe2\x89\xa4li\xe2\x89\xa4m1\xe2\x89\xa4li\xe2\x89\xa4m), denoting the positions of the stairs. If cl=0cl=0, the second line is empty.'
b'The third line contains cece integers e1,\xe2\x80\xa6,ecee1,\xe2\x80\xa6,ece in increasing order, denoting the elevators positions in the same format. It is guaranteed that all integers lili and eiei are distinct.'
b'The fourth line contains a single integer qq (1\xe2\x89\xa4q\xe2\x89\xa41051\xe2\x89\xa4q\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of queries.'
b'The next qq lines describe queries. Each of these lines contains four integers x1,y1,x2,y2x1,y1,x2,y2 (1\xe2\x89\xa4x1,x2\xe2\x89\xa4n1\xe2\x89\xa4x1,x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1,y2\xe2\x89\xa4m1\xe2\x89\xa4y1,y2\xe2\x89\xa4m)\xc2\xa0\xe2\x80\x94 the coordinates of starting and finishing sections for the query. It is guaranteed that the starting and finishing sections are distinct. It is also guaranteed that these sections contain guest rooms, i.\xc2\xa0e. y1y1 and y2y2 are not among lili and eiei.'
b'Output'
b'Print qq integers, one per line\xc2\xa0\xe2\x80\x94 the answers for the queries.'
Tags
binary search, *1600
