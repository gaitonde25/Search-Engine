b'Oscolcovo city has a campus consisting of n student dormitories, n universities and n military offices. Initially, the i-th dormitory belongs to the i-th university and is assigned to the i-th military office.'
b'Life goes on and the campus is continuously going through some changes. The changes can be of four types:'
b'  University aj merges with university bj. After that all the dormitories that belonged to university bj are assigned to to university aj, and university bj disappears.  Military office cj merges with military office dj. After that all the dormitories that were assigned to military office dj, are assigned to military office cj, and military office dj disappears.  Students of university xj move in dormitories. Lets kxj is the number of dormitories that belong to this university at the time when the students move in. Then the number of students in each dormitory of university xj increases by kxj (note that the more dormitories belong to the university, the more students move in each dormitory of the university).  Military office number yj conducts raids on all the dormitories assigned to it and takes all students from there. '
b'Thus, at each moment of time each dormitory is assigned to exactly one university and one military office. Initially, all the dormitory are empty.'
b'Your task is to process the changes that take place in the campus and answer the queries, how many people currently live in dormitory qj.'
b'Input'
b'The first line contains two integers, n and m (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x895\xc2\xb7105) \xe2\x80\x94 the number of dormitories and the number of queries, respectively.'
b'Next m lines contain the queries, each of them is given in one of the following formats: '
b'  \xc2\xabU aj bj\xc2\xbb \xe2\x80\x94 merging universities;  \xc2\xabM cj dj\xc2\xbb \xe2\x80\x94 merging military offices;  \xc2\xabA xj\xc2\xbb \xe2\x80\x94 students of university xj moving in the dormitories;  \xc2\xabZ yj\xc2\xbb \xe2\x80\x94 a raid in military office yj;  \xc2\xabQ qj\xc2\xbb \xe2\x80\x94 a query asking the number of people in dormitory qj. '
b' All the numbers in the queries are positive integers and do not exceed '
b'n'
b'. It is guaranteed that at the moment of the query the universities and military offices, that are present in the query, exist.'
b'Output'
b'In the i-th line print the answer to the i-th query asking the number of people in the dormitory.'
Tags
binary search, data structures, dsu, trees, *3100
