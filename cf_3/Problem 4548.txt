b'After his birthday party, Timofey went to his favorite tree alley in a park. He wants to feed there his favorite birds\xc2\xa0\xe2\x80\x94 crows.'
b"It's widely known that each tree is occupied by a single crow family. The trees in the alley form a row and are numbered from 1 to n. Some families are friends to each other. For some reasons, two families can be friends only if they live not too far from each other, more precisely, there is no more than k\xe2\x80\x89-\xe2\x80\x891 trees between any pair of friend families. Formally, the family on the u-th tree and the family on the v-th tree can be friends only if |u\xe2\x80\x89-\xe2\x80\x89v|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k holds."
b'One of the friendship features is that if some family learns that Timofey is feeding crows somewhere, it notifies about this all friend families. Thus, after Timofey starts to feed crows under some tree, all the families that are friends to the family living on this tree, as well as their friends and so on, fly to the feeding place. Of course, the family living on the tree also comes to the feeding place.'
b'Today Timofey came to the alley and noticed that all the families that live on trees with numbers strictly less than l or strictly greater than r have flown away. Thus, it is not possible to pass the information about feeding through them. Moreover, there is no need to feed them. Help Timofey to learn what is the minimum number of trees under which he has to feed crows so that all the families that have remained will get the information about feeding. You are given several situations, described by integers l and r, you need to calculate the answer for all of them.'
b'Input'
b'The first line contains integers n and k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x895), where n is the number of trees, and k is the maximum possible distance between friend families.'
b'The next line contains single integer m (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7k)\xc2\xa0\xe2\x80\x94 the number of pair of friend families. '
b'Each of the next m lines contains two integers u and v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105), that means that the families on trees u and v are friends. It is guaranteed that u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v and |u\xe2\x80\x89-\xe2\x80\x89v|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. All the given pairs are distinct.'
b'The next line contains single integer q (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105)\xc2\xa0\xe2\x80\x94 the number of situations you need to calculate the answer in.'
b'Each of the next q lines contains two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105), that means that in this situation families that have flown away lived on such trees x, so that either x\xe2\x80\x89<\xe2\x80\x89l or x\xe2\x80\x89>\xe2\x80\x89r.'
b'Output'
b'Print q lines. Line i should contain single integer\xc2\xa0\xe2\x80\x94 the answer in the i-th situation.'
Tags
data structures, divide and conquer, dsu, *2900
