b'Alan Turing is standing on a tape divided into cells that is infinite in both directions.'
b'Cells are numbered with consecutive integers from left to right. Alan is initially standing in cell 00. Every cell xx has cell x\xe2\x88\x921x\xe2\x88\x921 on the left and cell x+1x+1 on the right.'
b'Each cell can either contain an integer or be empty. Initially all cells are empty.'
b'Alan is given a permutation a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an of integers from 11 to nn that was chosen uniformly at random among all permutations of length nn.'
b'At time 11, integer a1a1 is written down into cell 00 where Alan is located.'
b"At each time ii from 22 to nn inclusive, the following happens. First, Alan decides whether to stay in the same cell he's currently in, move to the neighboring cell on the left, or move to the neighboring cell on the right. After that, integer aiai is written down into the cell where Alan is located. If that cell already contained some integer, the old integer is overwritten and irrelevant from that moment on."
b'Once anan is written down into some cell at time nn, sequence bb of all integers contained in the cells from left to right is formed. Empty cells are ignored.'
b"Turing's award is equal to the length of the longest increasing subsequence of sequence bb."
b'Help Alan and determine the largest possible value of his award if he acts optimally.'
b'Input'
b'Each test contains multiple test cases. The first line contains the number of test cases tt (1\xe2\x89\xa4t\xe2\x89\xa410001\xe2\x89\xa4t\xe2\x89\xa41000). Description of the test cases follows.'
b'Each test case is given in two lines. The first line of each test case contains a single integer nn (2\xe2\x89\xa4n\xe2\x89\xa4150002\xe2\x89\xa4n\xe2\x89\xa415000)\xc2\xa0\xe2\x80\x94 the length of the permutation given to Alan.'
b'The second line contains nn distinct integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the elements of the permutation.'
b'It is guaranteed that the permutation was chosen uniformly at random among all permutations of the corresponding length.'
b'The sum of nn over all test cases does not exceed 1500015000.'
b'Output'
b"For each test case output a single integer\xc2\xa0\xe2\x80\x94 the largest possible value of Turing's award."
b'Hacks are not allowed for this problem.'
Tags
data structures, dp, *3400
