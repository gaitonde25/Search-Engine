b'Welcome! Everything is fine.'
b'You have arrived in The Medium Place, the place between The Good Place and The Bad Place. You are assigned a task that will either make people happier or torture them for eternity.'
b'You have a list of kk pairs of people who have arrived in a new inhabited neighborhood. You need to assign each of the 2k2k people into one of the 2k2k houses. Each person will be the resident of exactly one house, and each house will have exactly one resident.'
b"Of course, in the neighborhood, it is possible to visit friends. There are 2k\xe2\x88\x9212k\xe2\x88\x921 roads, each of which connects two houses. It takes some time to traverse a road. We will specify the amount of time it takes in the input. The neighborhood is designed in such a way that from anyone's house, there is exactly one sequence of distinct roads you can take to any other house. In other words, the graph with the houses as vertices and the roads as edges is a tree."
b"The truth is, these kk pairs of people are actually soulmates. We index them from 11 to kk. We denote by f(i)f(i) the amount of time it takes for the ii-th pair of soulmates to go to each other's houses."
b'As we have said before, you will need to assign each of the 2k2k people into one of the 2k2k houses. You have two missions, one from the entities in The Good Place and one from the entities of The Bad Place. Here they are:'
b"  The first mission, from The Good Place, is to assign the people into the houses such that the sum of f(i)f(i) over all pairs ii is minimized. Let's define this minimized sum as GG. This makes sure that soulmates can easily and efficiently visit each other;  The second mission, from The Bad Place, is to assign the people into the houses such that the sum of f(i)f(i) over all pairs ii is maximized. Let's define this maximized sum as BB. This makes sure that soulmates will have a difficult time to visit each other. "
b'What are the values of GG and BB?'
b'Input'
b'The first line of input contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa45001\xe2\x89\xa4t\xe2\x89\xa4500) denoting the number of test cases. The next lines contain descriptions of the test cases.'
b'The first line of each test case contains a single integer kk denoting the number of pairs of people (1\xe2\x89\xa4k\xe2\x89\xa41051\xe2\x89\xa4k\xe2\x89\xa4105). The next 2k\xe2\x88\x9212k\xe2\x88\x921 lines describe the roads; the ii-th of them contains three space-separated integers ai,bi,tiai,bi,ti which means that the ii-th road connects the aiai-th and bibi-th houses with a road that takes titi units of time to traverse (1\xe2\x89\xa4ai,bi\xe2\x89\xa42k1\xe2\x89\xa4ai,bi\xe2\x89\xa42k, ai\xe2\x89\xa0biai\xe2\x89\xa0bi, 1\xe2\x89\xa4ti\xe2\x89\xa41061\xe2\x89\xa4ti\xe2\x89\xa4106). It is guaranteed that the given roads define a tree structure.'
b'It is guaranteed that the sum of the kk in a single file is at most 3\xe2\x8b\x851053\xe2\x8b\x85105.'
b'Output'
b'For each test case, output a single line containing two space-separated integers GG and BB. '
Tags
dfs and similar, graphs, greedy, trees, *2000
