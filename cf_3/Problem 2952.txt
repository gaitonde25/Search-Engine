b'You are given a tree with nn nodes and qq queries.'
b'Every query starts with three integers kk, mm and rr, followed by kk nodes of the tree a1,a2,\xe2\x80\xa6,aka1,a2,\xe2\x80\xa6,ak. To answer a query, assume that the tree is rooted at rr. We want to divide the kk given nodes into at most mm groups such that the following conditions are met: '
b'  Each node should be in exactly one group and each group should have at least one node.  In any group, there should be no two distinct nodes such that one node is an ancestor (direct or indirect) of the other. '
b'You need to output the number of ways modulo 109+7109+7 for every query.'
b'Input'
b'The first line contains two integers nn and qq (1\xe2\x89\xa4n,q\xe2\x89\xa41051\xe2\x89\xa4n,q\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of vertices in the tree and the number of queries, respectively.'
b'Each of the next n\xe2\x88\x921n\xe2\x88\x921 lines contains two integers uu and vv (1\xe2\x89\xa4u,v\xe2\x89\xa4n,u\xe2\x89\xa0v1\xe2\x89\xa4u,v\xe2\x89\xa4n,u\xe2\x89\xa0v), denoting an edge connecting vertex uu and vertex vv. It is guaranteed that the given graph is a tree.'
b'Each of the next qq lines starts with three integers kk, mm and rr (1\xe2\x89\xa4k,r\xe2\x89\xa4n1\xe2\x89\xa4k,r\xe2\x89\xa4n, 1\xe2\x89\xa4m\xe2\x89\xa4min(300,k)1\xe2\x89\xa4m\xe2\x89\xa4min(300,k))\xc2\xa0\xe2\x80\x94 the number of nodes, the maximum number of groups and the root of the tree for the current query, respectively. They are followed by kk distinct integers a1,a2,\xe2\x80\xa6,aka1,a2,\xe2\x80\xa6,ak (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n), denoting the nodes of the current query.'
b'It is guaranteed that the sum of kk over all queries does not exceed 105105.'
b'Output'
b'Print qq lines, where the ii-th line contains the answer to the ii-th query.'
Tags
data structures, dfs and similar, dp, graphs, trees, *2500
