b'Leha is planning his journey from Moscow to Saratov. He hates trains, so he has decided to get from one city to another by car.'
b"The path from Moscow to Saratov can be represented as a straight line (well, it's not that straight in reality, but in this problem we will consider it to be straight), and the distance between Moscow and Saratov is nn km. Let's say that Moscow is situated at the point with coordinate 00 km, and Saratov \xe2\x80\x94 at coordinate nn km."
b'Driving for a long time may be really difficult. Formally, if Leha has already covered ii kilometers since he stopped to have a rest, he considers the difficulty of covering (i+1)(i+1)-th kilometer as ai+1ai+1. It is guaranteed that for every i\xe2\x88\x88[1,n\xe2\x88\x921]i\xe2\x88\x88[1,n\xe2\x88\x921] ai\xe2\x89\xa4ai+1ai\xe2\x89\xa4ai+1. The difficulty of the journey is denoted as the sum of difficulties of each kilometer in the journey.'
b'Fortunately, there may be some rest sites between Moscow and Saratov. Every integer point from 11 to n\xe2\x88\x921n\xe2\x88\x921 may contain a rest site. When Leha enters a rest site, he may have a rest, and the next kilometer will have difficulty a1a1, the kilometer after it \xe2\x80\x94 difficulty a2a2, and so on.'
b"For example, if n=5n=5 and there is a rest site in coordinate 22, the difficulty of journey will be 2a1+2a2+a32a1+2a2+a3: the first kilometer will have difficulty a1a1, the second one \xe2\x80\x94 a2a2, then Leha will have a rest, and the third kilometer will have difficulty a1a1, the fourth \xe2\x80\x94 a2a2, and the last one \xe2\x80\x94 a3a3. Another example: if n=7n=7 and there are rest sites in coordinates 11 and 55, the difficulty of Leha's journey is 3a1+2a2+a3+a43a1+2a2+a3+a4."
b"Leha doesn't know which integer points contain rest sites. So he has to consider every possible situation. Obviously, there are 2n\xe2\x88\x9212n\xe2\x88\x921 different distributions of rest sites (two distributions are different if there exists some point xx such that it contains a rest site in exactly one of these distributions). Leha considers all these distributions to be equiprobable. He wants to calculate pp \xe2\x80\x94 the expected value of difficulty of his journey."
b'Obviously, p\xe2\x8b\x852n\xe2\x88\x921p\xe2\x8b\x852n\xe2\x88\x921 is an integer number. You have to calculate it modulo 998244353998244353.'
b'Input'
b'The first line contains one number nn (1\xe2\x89\xa4n\xe2\x89\xa41061\xe2\x89\xa4n\xe2\x89\xa4106) \xe2\x80\x94 the distance from Moscow to Saratov.'
b'The second line contains nn integer numbers a1a1, a2a2, ..., anan (1\xe2\x89\xa4a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an\xe2\x89\xa41061\xe2\x89\xa4a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an\xe2\x89\xa4106), where aiai is the difficulty of ii-th kilometer after Leha has rested.'
b'Output'
b'Print one number \xe2\x80\x94 p\xe2\x8b\x852n\xe2\x88\x921p\xe2\x8b\x852n\xe2\x88\x921, taken modulo 998244353998244353.'
Tags
combinatorics, math, probabilities, *2000
