b"She does her utmost to flawlessly carry out a person's last rites and preserve the world's balance of yin and yang."
b'Hu Tao, being the little prankster she is, has tried to scare you with this graph problem! You are given a connected undirected graph of nn nodes with mm edges. You also have qq queries. Each query consists of two nodes aa and bb.'
b"Initially, all edges in the graph have a weight of 00. For each query, you must choose a simple path starting from aa and ending at bb. Then you add 11 to every edge along this path. Determine if it's possible, after processing all qq queries, for all edges in this graph to have an even weight. If so, output the choice of paths for each query. "
b'If it is not possible, determine the smallest number of extra queries you could add to make it possible. It can be shown that this number will not exceed 10181018 under the given constraints.'
b'A simple path is defined as any path that does not visit a node more than once.'
b'An edge is said to have an even weight if its value is divisible by 22.'
b'Input'
b'The first line contains two integers nn and mm (2\xe2\x89\xa4n\xe2\x89\xa43\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa43\xe2\x8b\x85105, n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa4min(n(n\xe2\x88\x921)2,3\xe2\x8b\x85105)n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa4min(n(n\xe2\x88\x921)2,3\xe2\x8b\x85105)).'
b'Each of the next mm lines contains two integers xx and yy (1\xe2\x89\xa4x,y\xe2\x89\xa4n1\xe2\x89\xa4x,y\xe2\x89\xa4n, x\xe2\x89\xa0yx\xe2\x89\xa0y) indicating an undirected edge between node xx and yy. The input will not contain self-loops or duplicate edges, and the provided graph will be connected.'
b'The next line contains a single integer qq (1\xe2\x89\xa4q\xe2\x89\xa43\xe2\x8b\x851051\xe2\x89\xa4q\xe2\x89\xa43\xe2\x8b\x85105).'
b'Each of the next qq lines contains two integers aa and bb (1\xe2\x89\xa4a,b\xe2\x89\xa4n,a\xe2\x89\xa0b1\xe2\x89\xa4a,b\xe2\x89\xa4n,a\xe2\x89\xa0b), the description of each query.'
b'It is guaranteed that nq\xe2\x89\xa43\xe2\x8b\x85105nq\xe2\x89\xa43\xe2\x8b\x85105.'
b'Output'
b'If it is possible to force all edge weights to be even, print "YES" on the first line, followed by 2q2q lines indicating the choice of path for each query in the same order the queries are given. For each query, the first line should contain a single integer xx: the number of nodes in the chosen path. The next line should then contain xx spaced separated integers pipi indicating the path you take (p1=a,px=bp1=a,px=b and all numbers should fall between 11 and nn). This path cannot contain duplicate nodes and must be a valid simple path in the graph.'
b'If it is impossible to force all edge weights to be even, print "NO" on the first line and the minimum number of added queries on the second line.'
Tags
constructive algorithms, dfs and similar, graph matchings, graphs, greedy, trees, *2200
