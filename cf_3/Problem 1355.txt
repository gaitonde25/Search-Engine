b'Mr. Chanek has an orchard structured as a rooted ternary tree with NN vertices numbered from 11 to NN. The root of the tree is vertex 11. PiPi denotes the parent of vertex ii, for (2\xe2\x89\xa4i\xe2\x89\xa4N)(2\xe2\x89\xa4i\xe2\x89\xa4N). Interestingly, the height of the tree is not greater than 1010. Height of a tree is defined to be the largest distance from the root to a vertex in the tree.'
b'There exist a bush on each vertex of the tree. Initially, all bushes have fruits. Fruits will not grow on bushes that currently already have fruits. The bush at vertex ii will grow fruits after AiAi days since its last harvest.'
b'Mr. Chanek will visit his orchard for QQ days. In day ii, he will harvest all bushes that have fruits on the subtree of vertex XiXi. For each day, determine the sum of distances from every harvested bush to XiXi, and the number of harvested bush that day. Harvesting a bush means collecting all fruits on the bush.'
b'For example, if Mr. Chanek harvests all fruits on subtree of vertex XX, and harvested bushes [Y1,Y2,\xe2\x80\xa6,YM][Y1,Y2,\xe2\x80\xa6,YM], the sum of distances is \xe2\x88\x91Mi=1distance(X,Yi)\xe2\x88\x91i=1Mdistance(X,Yi)'
b'distance(U,V)distance(U,V) in a tree is defined to be the number of edges on the simple path from UU to VV.'
b'Input'
b'The first line contains two integers NN and QQ (1\xe2\x89\xa4N,\xc2\xa0Q,\xe2\x89\xa45\xe2\x8b\x85104)(1\xe2\x89\xa4N,\xc2\xa0Q,\xe2\x89\xa45\xe2\x8b\x85104), which denotes the number of vertices and the number of days Mr. Chanek visits the orchard.'
b'The second line contains NN integers AiAi (1\xe2\x89\xa4Ai\xe2\x89\xa45\xe2\x8b\x85104)(1\xe2\x89\xa4Ai\xe2\x89\xa45\xe2\x8b\x85104), which denotes the fruits growth speed on the bush at vertex ii, for (1\xe2\x89\xa4i\xe2\x89\xa4N)(1\xe2\x89\xa4i\xe2\x89\xa4N).'
b'The third line contains N\xe2\x88\x921N\xe2\x88\x921 integers PiPi (1\xe2\x89\xa4Pi\xe2\x89\xa4N,Pi\xe2\x89\xa0i)(1\xe2\x89\xa4Pi\xe2\x89\xa4N,Pi\xe2\x89\xa0i), which denotes the parent of vertex ii in the tree, for (2\xe2\x89\xa4i\xe2\x89\xa4N)(2\xe2\x89\xa4i\xe2\x89\xa4N). It is guaranteed that each vertex can be the parent of at most 33 other vertices. It is also guaranteed that the height of the tree is not greater than 1010.'
b"The next QQ lines contain a single integer XiXi (1\xe2\x89\xa4Xi\xe2\x89\xa4N)(1\xe2\x89\xa4Xi\xe2\x89\xa4N), which denotes the start of Mr. Chanek's visit on day ii, for (1\xe2\x89\xa4i\xe2\x89\xa4Q)(1\xe2\x89\xa4i\xe2\x89\xa4Q)."
b'Output'
b'Output QQ lines, line ii gives the sum of distances from the harvested bushes to XiXi, and the number of harvested bushes.'
Tags
data structures, *2800
