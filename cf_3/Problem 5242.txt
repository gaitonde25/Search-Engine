b'You are given a tree T with n vertices (numbered 1 through n) and a letter in each vertex. The tree is rooted at vertex 1.'
b"Let's look at the subtree Tv of some vertex v. It is possible to read a string along each simple path starting at v and ending at some vertex in Tv (possibly v itself). Let's denote the number of distinct strings which can be read this way as . "
b"Also, there's a number cv assigned to each vertex v. We are interested in vertices with the maximum value of ."
b'You should compute two statistics: the maximum value of  and the number of vertices v with the maximum .'
b'Input'
b'The first line of the input contains one integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89300\xe2\x80\x89000)\xc2\xa0\xe2\x80\x94 the number of vertices of the tree.'
b'The second line contains n space-separated integers ci (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89109).'
b'The third line contains a string s consisting of n lowercase English letters\xc2\xa0\xe2\x80\x94 the i-th character of this string is the letter in vertex i.'
b'The following n\xe2\x80\x89-\xe2\x80\x891 lines describe the tree T. Each of them contains two space-separated integers u and v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) indicating an edge between vertices u and v.'
b"It's guaranteed that the input will describe a tree."
b'Output'
b'Print two lines. '
b'On the first line, print  over all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. '
b'On the second line, print the number of vertices v for which .'
Tags
data structures, dfs and similar, dsu, hashing, strings, trees, *2400
