b'Polycarp is developing a new version of an old video game "Pac-Man". Though he really enjoyed playing the original game, he didn\'t like some aspects of it, so he decided to alter the rules a bit.'
b"In Polycarp's version, you play as Pac-Man and you have to collect pellets scattered over the game world while avoiding dangerous ghosts (no difference from the original yet). Polycarp didn't like the fact that there was no escape from the ghosts in the original, so, in his version, the game world is divided into nn safe zones with mm one-directional pathways between them \xe2\x80\x94 and it is guaranteed that Pac-Man can reach any safe zone from any other. Since safe zones are safe, the ghosts cannot attack Pac-Man while it is there, it is in danger only while traversing the pathways. Pac-Man starts the game in the safe zone ss."
b'All pellets are scattered over the safe zones; initially, the ii-th safe zone contains aiai pellets (and if Pac-Man is in a safe zone, it may freely collect all the pellets in it). The pellets disappear after being collected, but after the last pellet in the game world is collected, new pellets spawn in the safe zones in the same quantity as before (aiai new pellets spawn in the ii-th zone). The pellets can be respawned any number of times, so the game is essentially infinite.'
b'Polycarp has already determined the structure of the game world and the number of pellets in each safe zone. Now he is trying to find out if the game is difficult enough. There are qq goals in the game, the ii-th goal is to collect at least CiCi pellets from the beginning of the game. Polycarp denotes the difficulty of the ii-th goal as the minimum number of times the player has to traverse a one-directional pathway in order to collect CiCi pellets (since only traversing a pathway puts Pac-Man in danger). If some pathway is traversed multiple times while Pac-Man is collecting the pellets, it is included in the answer the same number of times.'
b'Help Polycarp to calculate the difficulty of each goal!'
b'Input'
b'The first line contains four integers nn, mm, qq and ss (2\xe2\x89\xa4n\xe2\x89\xa4152\xe2\x89\xa4n\xe2\x89\xa415; n\xe2\x89\xa4m\xe2\x89\xa4n(n\xe2\x88\x921)n\xe2\x89\xa4m\xe2\x89\xa4n(n\xe2\x88\x921); 1\xe2\x89\xa4q\xe2\x89\xa450001\xe2\x89\xa4q\xe2\x89\xa45000; 1\xe2\x89\xa4s\xe2\x89\xa4n1\xe2\x89\xa4s\xe2\x89\xa4n) \xe2\x80\x94 the number of safe zones, the number of pathways, the number of goals and the index of the starting safe zone, respectively.'
b'The second line contains nn integers a1a1, a2a2, ..., anan (1\xe2\x89\xa4ai\xe2\x89\xa41091\xe2\x89\xa4ai\xe2\x89\xa4109), where aiai is the initial number of pellets in the ii-th safe zone (and the number of pellets that spawn in the ii-th safe zone when the last pellet in the world is collected).'
b'Then mm lines follow, each line contains two integers vivi and uiui (1\xe2\x89\xa4vi,ui\xe2\x89\xa4n1\xe2\x89\xa4vi,ui\xe2\x89\xa4n; vi\xe2\x89\xa0uivi\xe2\x89\xa0ui) denoting a one-directional pathway from the safe zone vivi to the safe zone uiui. Each ordered pair (vi,ui)(vi,ui) appears in this section at most once (there are no multiple pathways from vivi to uiui), and it is possible to reach every safe zone from every other safe zone using these pathways.'
b'The last line contains qq integers C1C1, C2C2, ..., CqCq (1\xe2\x89\xa4Ci\xe2\x89\xa410151\xe2\x89\xa4Ci\xe2\x89\xa41015), where CiCi is the minimum number of pellets the player has to collect in order to fulfil the ii-th goal.'
b'Output'
b'For each goal ii, print one integer \xe2\x80\x94 its difficulty (the minimum number of times the player has to traverse along some pathway in order to collect at least CiCi pellets).'
Tags
*special problem, dp, *2900
