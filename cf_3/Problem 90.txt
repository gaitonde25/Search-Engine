b"The King is gone. After the King's rule, all the roads in the Kingdom are run down and need repair. Three of the King's children, Adrian, Beatrice and Cecilia, are dividing the Kingdom between themselves."
b"Adrian and Beatrice do not like each other and do not plan to maintain any relations between themselves in the future. Cecilia is on good terms with both of them. Moreover, most of the Kingdom's workers support Cecilia, so she has better resources and more opportunity to repair the infrastructure and develop the\xc2\xa0economy. "
b'Cecilia proposes to partition the Kingdom into three districts: A\xc2\xa0(for Adrian), B\xc2\xa0(for Beatrice), and C\xc2\xa0(for Cecilia), and let Adrian and Beatrice to negotiate and choose any towns they want to be in their districts, and agree on how they want to partition the Kingdom into three districts.'
b"Adrian's castle is located in town aa, and Beatrice's one is located in town bb. So Adrian and Beatrice want their castles to be located in districts A and B, respectively. Cecilia doesn't have a castle, so district C can consist of no towns."
b"There is an issue for Adrian and Beatrice. When they choose the towns, they will have to pay for the roads' repair."
b"The cost to repair the road of length ll is 2l2l gold. However, Adrian and Beatrice don't have to bear all the repair costs. The repair cost for the road of length ll that they bear depends on what towns it connects:"
b'  For a road between two towns inside district A, Adrian has to pay 2l2l gold;  For a road between two towns inside district B, Beatrice has to pay 2l2l gold;  For a road between towns from district A and district C, Adrian has to pay ll gold, Cecilia bears the\xc2\xa0remaining cost;  For a road between towns from district B and district C, Beatrice has to pay ll gold, Cecilia bears the\xc2\xa0remaining cost. '
b"The roads that connect towns from district A and district B won't be repaired, since Adrian and Beatrice are not planning to use them, so no one pays for them. Cecilia herself will repair the roads that connect the towns inside district C, so Adrian and Beatrice won't bear the cost of their repair either."
b"Adrian and Beatrice want to minimize the total cost they spend on roads' repair. Find the cheapest way for them to partition the Kingdom into three districts."
b'Input'
b'The first line contains two integers nn and mm\xc2\xa0\xe2\x80\x94 the number of towns and the number of roads in the\xc2\xa0Kingdom (2\xe2\x89\xa4n\xe2\x89\xa410002\xe2\x89\xa4n\xe2\x89\xa41000; 0\xe2\x89\xa4m\xe2\x89\xa420000\xe2\x89\xa4m\xe2\x89\xa42000).'
b'The second line contains two integers that represent town aa and town bb\xc2\xa0\xe2\x80\x94 the towns that have to be located in district A and district B, respectively (1\xe2\x89\xa4a,b\xe2\x89\xa4n1\xe2\x89\xa4a,b\xe2\x89\xa4n; a\xe2\x89\xa0ba\xe2\x89\xa0b).'
b'The following mm lines describe the Kingdom roads. The ii-th of them consists of three integers uiui, vivi, and lili representing a road of length lili between towns uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n; ui\xe2\x89\xa0viui\xe2\x89\xa0vi; 1\xe2\x89\xa4li\xe2\x89\xa41091\xe2\x89\xa4li\xe2\x89\xa4109).'
b'Each pair of towns is connected with at most one road.'
b'Output'
b"In the first line output a single integer\xc2\xa0\xe2\x80\x94 the minimum total cost of roads' repair for Adrian and Beatrice."
b"In the second line output a string consisting of nn characters 'A', 'B', and 'C', ii-th of the characters representing the district that the ii-th town should belong to."
b'If several cheapest ways to partition the Kingdom exist, print any of them.'
Tags
flows, *3200
