b'You are given a tree consisting of nn vertices. A number is written on each vertex; the number on vertex ii is equal to aiai.'
b"Let's denote the function g(x,y)g(x,y) as the greatest common divisor of the numbers written on the vertices belonging to the simple path from vertex xx to vertex yy (including these two vertices). Also let's denote dist(x,y)dist(x,y) as the number of vertices on the simple path between vertices xx and yy, including the endpoints. dist(x,x)=1dist(x,x)=1 for every vertex xx."
b'Your task is calculate the maximum value of dist(x,y)dist(x,y) among such pairs of vertices that g(x,y)>1g(x,y)>1.'
b'Input'
b'The first line contains one integer nn \xe2\x80\x94 the number of vertices (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105)(1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105).'
b'The second line contains nn integers a1a1, a2a2, ..., anan (1\xe2\x89\xa4ai\xe2\x89\xa42\xe2\x8b\x85105)(1\xe2\x89\xa4ai\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the numbers written on vertices.'
b'Then n\xe2\x88\x921n\xe2\x88\x921 lines follow, each containing two integers xx and yy (1\xe2\x89\xa4x,y\xe2\x89\xa4n,x\xe2\x89\xa0y)(1\xe2\x89\xa4x,y\xe2\x89\xa4n,x\xe2\x89\xa0y) denoting an edge connecting vertex xx with vertex yy. It is guaranteed that these edges form a tree.'
b'Output'
b'If there is no pair of vertices x,yx,y such that g(x,y)>1g(x,y)>1, print 00. Otherwise print the maximum value of dist(x,y)dist(x,y) among such pairs.'
Tags
data structures, dfs and similar, dp, number theory, trees, *2000
