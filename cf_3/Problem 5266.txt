b'Wilbur the pig now wants to play with strings. He has found an n by m table consisting only of the digits from 0 to 9 where the rows are numbered 1 to n and the columns are numbered 1 to m. Wilbur starts at some square and makes certain moves. If he is at square (x, y) and the digit d (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899) is written at position (x, y), then he must move to the square (x\xe2\x80\x89+\xe2\x80\x89ad, y\xe2\x80\x89+\xe2\x80\x89bd), if that square lies within the table, and he stays in the square (x, y) otherwise. Before Wilbur makes a move, he can choose whether or not to write the digit written in this square on the white board. All digits written on the whiteboard form some string. Every time a new digit is written, it goes to the end of the current string.'
b'Wilbur has q strings that he is worried about. For each string si, Wilbur wants to know whether there exists a starting position (x, y) so that by making finitely many moves, Wilbur can end up with the string si written on the white board.'
b'Input'
b'The first line of the input consists of three integers n, m, and q (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89m,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89200)\xc2\xa0\xe2\x80\x94 the dimensions of the table and the number of strings to process, respectively.'
b'Each of the next n lines contains m digits from 0 and 9 giving the table itself.'
b'Then follow 10 lines. The i-th of them contains the values ai\xe2\x80\x89-\xe2\x80\x891 and bi\xe2\x80\x89-\xe2\x80\x891 (\xe2\x80\x89-\xe2\x80\x89200\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89200), i.e. the vector that Wilbur uses to make a move from the square with a digit i\xe2\x80\x89-\xe2\x80\x891 in it.'
b"There are q lines that follow. The i-th of them will contain a string si consisting only of digits from 0 to 9. It is guaranteed that the total length of these q strings won't exceed 1\xe2\x80\x89000\xe2\x80\x89000."
b'Output'
b'For each of the q strings, print "YES" if Wilbur can choose x and y in order to finish with this string after some finite number of moves. If it\'s impossible, than print "NO" for the corresponding string.'
Tags
dfs and similar, dp, graphs, strings, *2500
