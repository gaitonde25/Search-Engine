b'In the galaxy far far away is the ancient interplanetary republic of Bubbleland, consisting of NN planets. Between them, there are MM bidirectional wormholes, each connecting a pair of planets. Bubbleland is a very centralized republic, having a capital planet Whiteplanet, from which any another planet can be reached using these wormholes. It is also guaranteed that no wormhole connects planet to itself and that no two different wormholes connect same pair of planets. '
b'We call a path that begins at one planet, visits other planets and each of them at most once and returns to starting point a tour. Interplanetary Safety Regulations guarantee that each planet belongs to at most one tour and that there are at most 4242 tours.'
b'After many eons of usage, wormholes need to be repaired and each wormhole has the cost WiWi which needs to be payed for reparation. Unfortunately, the Senate of Bubbleland is short on budget. Therefore, they have decided only to fix as many wormholes as they need in order to have all planets reachable from capital and to pay as little money as they have to for this repair. However the way in which the Senate calculates the cost is different. Cost of the set of reparations is binary xor of costs of each individual reparation, that is if reparations to be made have costs A1,A2,...,AkA1,A2,...,Ak, the cost of entire set is A1\xe2\x8a\x95A2\xe2\x8a\x95...\xe2\x8a\x95AkA1\xe2\x8a\x95A2\xe2\x8a\x95...\xe2\x8a\x95Ak.'
b'Now the Senate would like to know how much money do they have to pay and also the number of different ways to achieve that cost modulo 10000000071000000007.'
b'Input'
b'First line of input contains two numbers N(1\xe2\x89\xa4N\xe2\x89\xa4100.000)N(1\xe2\x89\xa4N\xe2\x89\xa4100.000), the number of planets and M(1\xe2\x89\xa4M\xe2\x89\xa4100.041)M(1\xe2\x89\xa4M\xe2\x89\xa4100.041), the number of wormholes. Following MM lines contain three numbers U,V(1\xe2\x89\xa4U\xe2\x89\xa0V\xe2\x89\xa4N)U,V(1\xe2\x89\xa4U\xe2\x89\xa0V\xe2\x89\xa4N) and W(1\xe2\x89\xa4W\xe2\x89\xa4100.000)W(1\xe2\x89\xa4W\xe2\x89\xa4100.000), meaning that there exists a wormhole connecting planets UU and VV, with repair cost of WW.'
b'Output'
b'Output two numbers, the smallest possible cost of entire reparation and the number of different valid reparations with that cost modulo 10000000071000000007.'
Tags
divide and conquer, fft, graphs, *2400
