b"In Homer's school, there are nn students who love clubs. "
b'Initially, there are mm clubs, and each of the nn students is in exactly one club. In other words, there are aiai students in the ii-th club for 1\xe2\x89\xa4i\xe2\x89\xa4m1\xe2\x89\xa4i\xe2\x89\xa4m and a1+a2+\xe2\x8b\xaf+am=na1+a2+\xe2\x8b\xaf+am=n.'
b'The nn students are so unfriendly that every day one of them (chosen uniformly at random from all of the nn students) gets angry. The student who gets angry will do one of the following things. '
b'  With probability 1212, he leaves his current club, then creates a new club himself and joins it. There is only one student (himself) in the new club he creates.  With probability 1212, he does not create new clubs. In this case, he changes his club to a new one (possibly the same club he is in currently) with probability proportional to the number of students in it. Formally, suppose there are kk clubs and there are bibi students in the ii-th club for 1\xe2\x89\xa4i\xe2\x89\xa4k1\xe2\x89\xa4i\xe2\x89\xa4k (before the student gets angry). He leaves his current club, and then joins the ii-th club with probability binbin. '
b' We note that when a club becomes empty, students will never join it because any student who gets angry will join an empty club with probability '
b''
b'00'
b'0'
b' according to the above statement.'
b'Homer wonders the expected number of days until every student is in the same club for the first time.'
b'We can prove that the answer can be represented as a rational number pqpq with gcd(p,q)=1gcd(p,q)=1. Therefore, you are asked to find the value of pq\xe2\x88\x921mod998244353pq\xe2\x88\x921mod998244353. It can be shown that qmod998244353\xe2\x89\xa00qmod998244353\xe2\x89\xa00 under the given constraints of the problem.'
b'Input'
b'The first line contains an integer mm (1\xe2\x89\xa4m\xe2\x89\xa410001\xe2\x89\xa4m\xe2\x89\xa41000) \xe2\x80\x94 the number of clubs initially.'
b'The second line contains mm integers a1,a2,\xe2\x80\xa6,ama1,a2,\xe2\x80\xa6,am (1\xe2\x89\xa4ai\xe2\x89\xa44\xe2\x8b\x851081\xe2\x89\xa4ai\xe2\x89\xa44\xe2\x8b\x85108) with 1\xe2\x89\xa4a1+a2+\xe2\x8b\xaf+am\xe2\x89\xa44\xe2\x8b\x851081\xe2\x89\xa4a1+a2+\xe2\x8b\xaf+am\xe2\x89\xa44\xe2\x8b\x85108, where aiai denotes the number of students in the ii-th club initially.'
b'Output'
b'Print one integer \xe2\x80\x94 the expected number of days until every student is in the same club for the first time, modulo 998244353998244353.'
Tags
dp, fft, math, number theory, probabilities, *3500
