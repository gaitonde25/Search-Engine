b'Phoenix wonders what it is like to rob diamonds from a jewelry store!'
b'There are nn types of diamonds. The ii-th type has weight wiwi and value vivi. The store initially has aiai diamonds of the ii-th type.'
b'Each day, for qq days, one of the following will happen: '
b'  A new shipment of kiki diamonds of type didi arrive.  The store sells kiki diamonds of type didi.  Phoenix wonders what will happen if he robs the store using a bag that can fit diamonds with total weight not exceeding cici. If he greedily takes diamonds of the largest value that fit, how much value would be taken? If there are multiple diamonds with the largest value, he will take the one with minimum weight. If, of the diamonds with the largest value, there are multiple with the same minimum weight, he will take any of them. '
b'Of course, since Phoenix is a law-abiding citizen, this is all a thought experiment and he never actually robs any diamonds from the store. This means that queries of type 33 do not affect the diamonds in the store.'
b'Input'
b'The first line contains two integers nn and qq (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105; 1\xe2\x89\xa4q\xe2\x89\xa41051\xe2\x89\xa4q\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of types of diamonds and number of days, respectively.'
b'The next nn lines describe each type of diamond. The ii-th line will contain three integers aiai, wiwi, and vivi (0\xe2\x89\xa4ai\xe2\x89\xa41050\xe2\x89\xa4ai\xe2\x89\xa4105; 1\xe2\x89\xa4wi,vi\xe2\x89\xa41051\xe2\x89\xa4wi,vi\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the initial number of diamonds of the ii-th type, the weight of diamonds of the ii-th type, and the value of diamonds of the ii-th type, respectively.'
b'The next qq lines contain the queries. For each query, the first integer of each line is tt (1\xe2\x89\xa4t\xe2\x89\xa431\xe2\x89\xa4t\xe2\x89\xa43)\xc2\xa0\xe2\x80\x94 the type of query.'
b'If t=1t=1, then two integers kiki, didi follow (1\xe2\x89\xa4ki\xe2\x89\xa41051\xe2\x89\xa4ki\xe2\x89\xa4105; 1\xe2\x89\xa4di\xe2\x89\xa4n1\xe2\x89\xa4di\xe2\x89\xa4n). This means that a new shipment of kiki diamonds arrived, each of type didi.'
b'If t=2t=2, then two integers kiki, didi follow (1\xe2\x89\xa4ki\xe2\x89\xa41051\xe2\x89\xa4ki\xe2\x89\xa4105; 1\xe2\x89\xa4di\xe2\x89\xa4n1\xe2\x89\xa4di\xe2\x89\xa4n). This means that the store has sold kiki diamonds, each of type didi. It is guaranteed that the store had the diamonds before they sold them.'
b"If t=3t=3, an integer cici will follow (1\xe2\x89\xa4ci\xe2\x89\xa410181\xe2\x89\xa4ci\xe2\x89\xa41018)\xc2\xa0\xe2\x80\x94 the weight capacity of Phoenix's bag."
b'It is guaranteed that there is at least one query where t=3t=3.'
b'Output'
b'Print the answer for each query of the third type (t=3t=3).'
Tags
binary search, data structures, sortings, *3400
