b'Ashish has a tree consisting of nn nodes numbered 11 to nn rooted at node 11. The ii-th node in the tree has a cost aiai, and binary digit bibi is written in it. He wants to have binary digit cici written in the ii-th node in the end.'
b'To achieve this, he can perform the following operation any number of times: '
b'  Select any kk nodes from the subtree of any node uu, and shuffle the digits in these nodes as he wishes, incurring a cost of k\xe2\x8b\x85auk\xe2\x8b\x85au. Here, he can choose kk ranging from 11 to the size of the subtree of uu. '
b'He wants to perform the operations in such a way that every node finally has the digit corresponding to its target.'
b'Help him find the minimum total cost he needs to spend so that after all the operations, every node uu has digit cucu written in it, or determine that it is impossible.'
b'Input'
b'First line contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105)(1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) denoting the number of nodes in the tree.'
b'ii-th line of the next nn lines contains 3 space-separated integers aiai, bibi, cici (1\xe2\x89\xa4ai\xe2\x89\xa4109,0\xe2\x89\xa4bi,ci\xe2\x89\xa41)(1\xe2\x89\xa4ai\xe2\x89\xa4109,0\xe2\x89\xa4bi,ci\xe2\x89\xa41) \xc2\xa0\xe2\x80\x94 the cost of the ii-th node, its initial digit and its goal digit.'
b'Each of the next n\xe2\x88\x921n\xe2\x88\x921 lines contain two integers uu, vv (1\xe2\x89\xa4u,v\xe2\x89\xa4n,\xc2\xa0u\xe2\x89\xa0v)(1\xe2\x89\xa4u,v\xe2\x89\xa4n,\xc2\xa0u\xe2\x89\xa0v), meaning that there is an edge between nodes uu and vv in the tree.'
b'Output'
b'Print the minimum total cost to make every node reach its target digit, and \xe2\x88\x921\xe2\x88\x921 if it is impossible.'
Tags
dfs and similar, dp, greedy, trees, *2000
