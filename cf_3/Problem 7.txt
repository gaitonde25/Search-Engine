b'Yura is a mathematician, and his cognition of the world is so absolute as if he have been solving formal problems a hundred of trillions of billions of years. This problem is just that!'
b'Consider all non-negative integers from the interval [0,10n)[0,10n). For convenience we complement all numbers with leading zeros in such way that each number from the given interval consists of exactly nn decimal digits.'
b'You are given a set of pairs (ui,vi)(ui,vi), where uiui and vivi are distinct decimal digits from 00 to 99.'
b'Consider a number xx consisting of nn digits. We will enumerate all digits from left to right and denote them as d1,d2,\xe2\x80\xa6,dnd1,d2,\xe2\x80\xa6,dn. In one operation you can swap digits didi and di+1di+1 if and only if there is a pair (uj,vj)(uj,vj) in the set such that at least one of the following conditions is satisfied:'
b'  di=ujdi=uj and di+1=vjdi+1=vj,  di=vjdi=vj and di+1=ujdi+1=uj. '
b'We will call the numbers xx and yy, consisting of nn digits, equivalent if the number xx can be transformed into the number yy using some number of operations described above. In particular, every number is considered equivalent to itself.'
b'You are given an integer nn and a set of mm pairs of digits (ui,vi)(ui,vi). You have to find the maximum integer kk such that there exists a set of integers x1,x2,\xe2\x80\xa6,xkx1,x2,\xe2\x80\xa6,xk (0\xe2\x89\xa4xi<10n0\xe2\x89\xa4xi<10n) such that for each 1\xe2\x89\xa4i<j\xe2\x89\xa4k1\xe2\x89\xa4i<j\xe2\x89\xa4k the number xixi is not equivalent to the number xjxj.'
b'Input'
b'The first line contains an integer nn (1\xe2\x89\xa4n\xe2\x89\xa4500001\xe2\x89\xa4n\xe2\x89\xa450000)\xc2\xa0\xe2\x80\x94 the number of digits in considered numbers.'
b'The second line contains an integer mm (0\xe2\x89\xa4m\xe2\x89\xa4450\xe2\x89\xa4m\xe2\x89\xa445)\xc2\xa0\xe2\x80\x94 the number of pairs of digits in the set.'
b'Each of the following mm lines contains two digits uiui and vivi, separated with a space (0\xe2\x89\xa4ui<vi\xe2\x89\xa490\xe2\x89\xa4ui<vi\xe2\x89\xa49).'
b"It's guaranteed that all described pairs are pairwise distinct."
b'Output'
b'Print one integer\xc2\xa0\xe2\x80\x94 the maximum value kk such that there exists a set of integers x1,x2,\xe2\x80\xa6,xkx1,x2,\xe2\x80\xa6,xk (0\xe2\x89\xa4xi<10n0\xe2\x89\xa4xi<10n) such that for each 1\xe2\x89\xa4i<j\xe2\x89\xa4k1\xe2\x89\xa4i<j\xe2\x89\xa4k the number xixi is not equivalent to the number xjxj.'
b'As the answer can be big enough, print the number kk modulo 998244353998244353.'
Tags
bitmasks, dp, math, *2600
