b'You are given a set of strings SS. Each string consists of lowercase Latin letters.'
b'For each string in this set, you want to calculate the minimum number of seconds required to type this string. To type a string, you have to start with an empty string and transform it into the string you want to type using the following actions:'
b'  if the current string is tt, choose some lowercase Latin letter cc and append it to the back of tt, so the current string becomes t+ct+c. This action takes 11 second;  use autocompletion. When you try to autocomplete the current string tt, a list of all strings s\xe2\x88\x88Ss\xe2\x88\x88S such that tt is a prefix of ss is shown to you. This list includes tt itself, if tt is a string from SS, and the strings are ordered lexicographically. You can transform tt into the ii-th string from this list in ii seconds. Note that you may choose any string from this list you want, it is not necessarily the string you are trying to type. '
b'What is the minimum number of seconds that you have to spend to type each string from SS?'
b'Note that the strings from SS are given in an unusual way.'
b'Input'
b'The first line contains one integer nn (1\xe2\x89\xa4n\xe2\x89\xa41061\xe2\x89\xa4n\xe2\x89\xa4106).'
b'Then nn lines follow, the ii-th line contains one integer pipi (0\xe2\x89\xa4pi<i0\xe2\x89\xa4pi<i) and one lowercase Latin character cici. These lines form some set of strings such that SS is its subset as follows: there are n+1n+1 strings, numbered from 00 to nn; the 00-th string is an empty string, and the ii-th string (i\xe2\x89\xa51i\xe2\x89\xa51) is the result of appending the character cici to the string pipi. It is guaranteed that all these strings are distinct.'
b'The next line contains one integer kk (1\xe2\x89\xa4k\xe2\x89\xa4n1\xe2\x89\xa4k\xe2\x89\xa4n) \xe2\x80\x94 the number of strings in SS.'
b'The last line contains kk integers a1a1, a2a2, ..., akak (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n, all aiai are pairwise distinct) denoting the indices of the strings generated by above-mentioned process that form the set SS \xe2\x80\x94 formally, if we denote the ii-th generated string as sisi, then S=sa1,sa2,\xe2\x80\xa6,sakS=sa1,sa2,\xe2\x80\xa6,sak.'
b'Output'
b'Print kk integers, the ii-th of them should be equal to the minimum number of seconds required to type the string saisai.'
Tags
data structures, dfs and similar, dp, *2600
