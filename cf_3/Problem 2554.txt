b'You have been hired to supervise the project of a new amusement park. The park will have a special gimmick: directed slides that can get customers from one attraction to another quickly and in an entertaining way.'
b"The park owner has given you the current project: a list of planned attractions and a list of slides that should be built between them. However, him being a businessman, he casually envisioned the impossible: among other things, he projected a slide coming from the Haunted Castle to the Roller Coaster, another from the Roller Coaster to the Drop Tower, and a third from the Drop Tower to the Haunted Castle. As the slides can only go downhill, it is evident why this is a problem. You don't have the luxury of ignoring the laws of physics when building the park, so you have to request changes in the project. Maybe he would accept reversing the slide between the Drop Tower and the Haunted Castle?"
b'Formally: '
b'  The project is a list of attractions and a list of directed slides. Each slide starts at one attraction and ends at another attraction.  A proposal is obtained from the project by reversing the directions of some slides (possibly none or all of them).  A proposal is legal if there is a way to assign an elevation to each attraction in such a way that every slide goes downhill.  The cost of a proposal is the number of slides whose directions were reversed. '
b'For a given project, find and report the sum of costs all legal proposals. Since this number may be large, output it modulo 998,244,353998,244,353.'
b'Input'
b'The first line contains two space-separated integers nn, mm (1\xe2\x89\xa4n\xe2\x89\xa4181\xe2\x89\xa4n\xe2\x89\xa418, 0\xe2\x89\xa4m\xe2\x89\xa4n(n\xe2\x88\x921)/20\xe2\x89\xa4m\xe2\x89\xa4n(n\xe2\x88\x921)/2) \xe2\x80\x93 the number of attractions and the number of slides, respectively. The attractions are numbered 11 through nn.'
b'Then, mm lines follow. The ii-th of these lines contains two space-separated integers aiai, bibi (1\xe2\x89\xa4ai,bi\xe2\x89\xa4n1\xe2\x89\xa4ai,bi\xe2\x89\xa4n) denoting a slide from aiai to bibi. '
b'You may assume that: '
b'  There are no self-loops. (For each ii: ai\xe2\x89\xa0biai\xe2\x89\xa0bi.)  No slide appears twice. (For all i\xe2\x89\xa0ji\xe2\x89\xa0j: ai\xe2\x89\xa0ajai\xe2\x89\xa0aj or bi\xe2\x89\xa0bjbi\xe2\x89\xa0bj.)  No pair of attractions is connected in both directions. (The unordered pairs {ai,bi}{ai,bi} are distinct.) '
b'Output'
b'Output one line with a single integer, the sum of costs of all legal proposals modulo 998,244,353998,244,353.'
Tags
*special problem, dp, math
