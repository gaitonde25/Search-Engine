b'Let nn be an integer. Consider all permutations on integers 11 to nn in lexicographic order, and concatenate them into one big sequence PP. For example, if n=3n=3, then P=[1,2,3,1,3,2,2,1,3,2,3,1,3,1,2,3,2,1]P=[1,2,3,1,3,2,2,1,3,2,3,1,3,1,2,3,2,1]. The length of this sequence is n\xe2\x8b\x85n!n\xe2\x8b\x85n!.'
b'Let 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x8b\x85n!1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x8b\x85n! be a pair of indices. We call the sequence (Pi,Pi+1,\xe2\x80\xa6,Pj\xe2\x88\x921,Pj)(Pi,Pi+1,\xe2\x80\xa6,Pj\xe2\x88\x921,Pj) a subarray of PP. '
b'You are given nn. Find the number of distinct subarrays of PP. Since this number may be large, output it modulo 998244353998244353 (a prime number). '
b'Input'
b'The only line contains one integer nn\xc2\xa0(1\xe2\x89\xa4n\xe2\x89\xa41061\xe2\x89\xa4n\xe2\x89\xa4106), as described in the problem statement.'
b'Output'
b'Output a single integer\xc2\xa0\xe2\x80\x94 the number of distinct subarrays, modulo 998244353998244353.'
Tags
string suffix structures, *3300
