b'Alice recently found some cactuses growing near her house! After several months, more and more cactuses appeared and soon they blocked the road. So Alice wants to clear them.'
b"A cactus is a connected undirected graph. No edge of this graph lies on more than one simple cycle. Let's call a sequence of different nodes of the graph x1,x2,\xe2\x80\xa6,xkx1,x2,\xe2\x80\xa6,xk a simple cycle, if k\xe2\x89\xa53k\xe2\x89\xa53 and all pairs of nodes x1x1 and x2x2, x2x2 and x3x3, \xe2\x80\xa6\xe2\x80\xa6, xk\xe2\x88\x921xk\xe2\x88\x921 and xkxk, xkxk and x1x1 are connected with edges. Edges (x1,x2)(x1,x2), (x2,x3)(x2,x3), \xe2\x80\xa6\xe2\x80\xa6, (xk\xe2\x88\x921,xk)(xk\xe2\x88\x921,xk), (xk,x1)(xk,x1) lies on this simple cycle."
b'There are so many cactuses, so it seems hard to destroy them. But Alice has magic. When she uses the magic, every node of the cactus will be removed independently with the probability 1212. When a node is removed, the edges connected to it are also removed.'
b'Now Alice wants to test her magic. She has picked a cactus with nn nodes and mm edges. Let X[S]X[S] (where SS is a subset of the removed nodes) be the number of connected components in the remaining graph after removing nodes of set SS. Before she uses magic, she wants to know the variance of random variable XX, if all nodes of the graph have probability 1212 to be removed and all nn of these events are independent. By the definition the variance is equal to E[(X\xe2\x88\x92E[X])2]E[(X\xe2\x88\x92E[X])2], where E[X]E[X] is the expected value of XX. Help her and calculate this value by modulo 109+7109+7.'
b'Formally, let M=109+7M=109+7 (a prime number). It can be shown that the answer can be expressed as an irreducible fraction pqpq, where pp and qq are integers and q\xe2\x89\xa1\xcc\xb80(modM)q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modMp\xe2\x8b\x85q\xe2\x88\x921modM. In other words, find such an integer xx that 0\xe2\x89\xa4x<M0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)x\xe2\x8b\x85q\xe2\x89\xa1p(modM).'
b'Input'
b'The first line contains two integers nn and mm, separated by space (1\xe2\x89\xa4n\xe2\x89\xa45\xe2\x8b\x85105,n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa45\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa45\xe2\x8b\x85105,n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa45\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of nodes and edges in the cactus.'
b'The following mm lines contain two numbers uu and vv each, separated by space (1\xe2\x89\xa4u,v\xe2\x89\xa4n,u\xe2\x89\xa0v1\xe2\x89\xa4u,v\xe2\x89\xa4n,u\xe2\x89\xa0v) meaning that there is an edge between the nodes uu and vv.'
b'It is guaranteed that there are no loops and multiple edges in the graph and the given graph is cactus.'
b'Output'
b'Print one integer\xc2\xa0\xe2\x80\x94 the variance of the number of connected components in the remaining graph, after removing a set of nodes such that each node has probability 1212 to be removed and all these events are independent. This value should be found by modulo 109+7109+7.'
Tags
dfs and similar, graphs, math, probabilities, *3000
