b'Every December, VK traditionally holds an event for its employees named "Secret Santa". Here\'s how it happens.'
b'nn employees numbered from 11 to nn take part in the event. Each employee ii is assigned a different employee bibi, to which employee ii has to make a new year gift. Each employee is assigned to exactly one other employee, and nobody is assigned to themselves (but two employees may be assigned to each other). Formally, all bibi must be distinct integers between 11 and nn, and for any ii, bi\xe2\x89\xa0ibi\xe2\x89\xa0i must hold.'
b'The assignment is usually generated randomly. This year, as an experiment, all event participants have been asked who they wish to make a gift to. Each employee ii has said that they wish to make a gift to employee aiai.'
b'Find a valid assignment bb that maximizes the number of fulfilled wishes of the employees.'
b'Input'
b'Each test contains multiple test cases. The first line contains the number of test cases tt (1\xe2\x89\xa4t\xe2\x89\xa41051\xe2\x89\xa4t\xe2\x89\xa4105). Description of the test cases follows.'
b'Each test case consists of two lines. The first line contains a single integer nn\xc2\xa0(2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of participants of the event.'
b'The second line contains nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an\xc2\xa0(1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n; ai\xe2\x89\xa0iai\xe2\x89\xa0i)\xc2\xa0\xe2\x80\x94 wishes of the employees in order from 11 to nn.'
b'It is guaranteed that the sum of nn over all test cases does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each test case, print two lines.'
b'In the first line, print a single integer kk\xc2\xa0(0\xe2\x89\xa4k\xe2\x89\xa4n0\xe2\x89\xa4k\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the number of fulfilled wishes in your assignment.'
b'In the second line, print nn distinct integers b1,b2,\xe2\x80\xa6,bnb1,b2,\xe2\x80\xa6,bn (1\xe2\x89\xa4bi\xe2\x89\xa4n1\xe2\x89\xa4bi\xe2\x89\xa4n; bi\xe2\x89\xa0ibi\xe2\x89\xa0i)\xc2\xa0\xe2\x80\x94 the numbers of employees assigned to employees 1,2,\xe2\x80\xa6,n1,2,\xe2\x80\xa6,n.'
b'kk must be equal to the number of values of ii such that ai=biai=bi, and must be as large as possible. If there are multiple answers, print any.'
Tags
constructive algorithms, flows, graphs, greedy, math, *1600
