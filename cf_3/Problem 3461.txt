b'There is a tree with nn vertices. There are also mm ants living on it. Each ant has its own color. The ii-th ant has two favorite pairs of vertices: (ai,biai,bi) and (ci,dici,di). You need to tell if it is possible to paint the edges of the tree in mm colors so that every ant will be able to walk between vertices from one of its favorite pairs using only edges of his color; if it is possible, you need to print which pair every ant should use.'
b'Input'
b'The first line contains a single integer nn (2\xe2\x89\xa4n\xe2\x89\xa41052\xe2\x89\xa4n\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of vertices.'
b'Each of the next n\xe2\x88\x921n\xe2\x88\x921 lines contains two integers uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n), meaning that there is an edge between vertices uiui and vivi.'
b'The next line contains a single integer mm (1\xe2\x89\xa4m\xe2\x89\xa41041\xe2\x89\xa4m\xe2\x89\xa4104)\xc2\xa0\xe2\x80\x94 the number of ants.'
b'Each of the next mm lines contains four integers aiai, bibi, cici, and didi (1\xe2\x89\xa4ai,bi,ci,di\xe2\x89\xa4n1\xe2\x89\xa4ai,bi,ci,di\xe2\x89\xa4n, ai\xe2\x89\xa0bi,ci\xe2\x89\xa0diai\xe2\x89\xa0bi,ci\xe2\x89\xa0di), meaning that pairs (aiai, bibi) and (cici, didi) are favorite for the ii-th ant.'
b'Output'
b'Print "NO" (without quotes) if the wanted painting is impossible.'
b'Otherwise, print "YES" (without quotes). Print mm lines. On the ii-th line, print 11 if the ii-th ant will use the first pair and 22 otherwise. If there are multiple answers, print any.'
Tags
2-sat, data structures, trees, *3200
