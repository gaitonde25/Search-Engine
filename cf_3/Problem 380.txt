b"Divan's new cottage is finally complete! However, after a thorough inspection, it turned out that the workers had installed the insulation incorrectly, and now the temperature in the house directly depends on the temperature outside. More precisely, if the temperature in the house is PP in the morning, and the street temperature is TT, then by the next morning the temperature in the house changes according to the following rule: "
b'  Pnew=P+1Pnew=P+1, if P<TP<T,  Pnew=P\xe2\x88\x921Pnew=P\xe2\x88\x921, if P>TP>T,  Pnew=PPnew=P, if P=TP=T. '
b' Here '
b''
b'PnewPnew'
b'P_{new}'
b' is the temperature in the house next morning.'
b'Divan is a very busy businessman, so sometimes he is not at home for long periods and does not know what the temperature is there now, so he hired you to find it. You will work for nn days. In the beginning of the ii-th day, the temperature outside TiTi is first given to you. After that, on the ii-th day, you will receive kiki queries. Each query asks the following: "if the temperature in the house was xixi at the morning of the first day, what would be the temperature in the house next morning (after day ii)?"'
b"Please answer all the businessman's queries."
b'Input'
b'The first line of the input contains the number nn (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of days.'
b'The following is a description of nn days in the following format.'
b'The first line of the description contains an integer TiTi (0\xe2\x89\xa4Ti\xe2\x89\xa41090\xe2\x89\xa4Ti\xe2\x89\xa4109) \xe2\x80\x94 the temperature on that day.'
b'The second line contains a non-negative integer kiki (0\xe2\x89\xa4ki\xe2\x89\xa42\xe2\x8b\x851050\xe2\x89\xa4ki\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of queries that day.'
b"The third line contains kk integers x\xe2\x80\xb2ixi\xe2\x80\xb2 (0\xe2\x89\xa4x\xe2\x80\xb2i\xe2\x89\xa41090\xe2\x89\xa4xi\xe2\x80\xb2\xe2\x89\xa4109) \xe2\x80\x94 the encrypted version of Divan's queries."
b"Let lastans=0lastans=0 initially. Divan's actual queries are given by xi=(x\xe2\x80\xb2i+lastans)mod(109+1)xi=(xi\xe2\x80\xb2+lastans)mod(109+1), where amodbamodb is the reminder when aa is divided by bb. After answering the query, set lastanslastans to the answer."
b'It is guaranteed that the total number of queries (the sum of all kiki) does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each query, output a single integer \xe2\x80\x94 the temperature in the house after day ii.'
Tags
binary search, data structures, *2600
