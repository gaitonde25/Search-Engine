b'There are nn cities in the country. '
b'Two candidates are fighting for the post of the President. The elections are set in the future, and both candidates have already planned how they are going to connect the cities with roads. Both plans will connect all cities using n\xe2\x88\x921n\xe2\x88\x921 roads only. That is, each plan can be viewed as a tree. Both of the candidates had also specified their choice of the capital among nn cities (xx for the first candidate and yy for the second candidate), which may or may not be same.'
b'Each city has a potential of building a port (one city can have at most one port). Building a port in ii-th city brings aiai amount of money. However, each candidate has his specific demands. The demands are of the form: '
b'  kk xx, which means that the candidate wants to build exactly xx ports in the subtree of the kk-th city of his tree (the tree is rooted at the capital of his choice). '
b'Find out the maximum revenue that can be gained while fulfilling all demands of both candidates, or print -1 if it is not possible to do.'
b'It is additionally guaranteed, that each candidate has specified the port demands for the capital of his choice.'
b'Input'
b'The first line contains integers nn, xx and yy (1\xe2\x89\xa4n\xe2\x89\xa45001\xe2\x89\xa4n\xe2\x89\xa4500, 1\xe2\x89\xa4x,y\xe2\x89\xa4n1\xe2\x89\xa4x,y\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the number of cities, the capital of the first candidate and the capital of the second candidate respectively.'
b'Next line contains integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa41000001\xe2\x89\xa4ai\xe2\x89\xa4100000)\xc2\xa0\xe2\x80\x94 the revenue gained if the port is constructed in the corresponding city.'
b'Each of the next n\xe2\x88\x921n\xe2\x88\x921 lines contains integers uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n, ui\xe2\x89\xa0viui\xe2\x89\xa0vi), denoting edges between cities in the tree of the first candidate.'
b'Each of the next n\xe2\x88\x921n\xe2\x88\x921 lines contains integers u\xe2\x80\xb2iui\xe2\x80\xb2 and v\xe2\x80\xb2ivi\xe2\x80\xb2 (1\xe2\x89\xa4u\xe2\x80\xb2i,v\xe2\x80\xb2i\xe2\x89\xa4n1\xe2\x89\xa4ui\xe2\x80\xb2,vi\xe2\x80\xb2\xe2\x89\xa4n, u\xe2\x80\xb2i\xe2\x89\xa0v\xe2\x80\xb2iui\xe2\x80\xb2\xe2\x89\xa0vi\xe2\x80\xb2), denoting edges between cities in the tree of the second candidate.'
b'Next line contains an integer q1q1 (1\xe2\x89\xa4q1\xe2\x89\xa4n1\xe2\x89\xa4q1\xe2\x89\xa4n), denoting the number of demands of the first candidate.'
b'Each of the next q1q1 lines contains two integers kk and xx (1\xe2\x89\xa4k\xe2\x89\xa4n1\xe2\x89\xa4k\xe2\x89\xa4n, 1\xe2\x89\xa4x\xe2\x89\xa4n1\xe2\x89\xa4x\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the city number and the number of ports in its subtree.'
b'Next line contains an integer q2q2 (1\xe2\x89\xa4q2\xe2\x89\xa4n1\xe2\x89\xa4q2\xe2\x89\xa4n), denoting the number of demands of the second candidate.'
b'Each of the next q2q2 lines contain two integers kk and xx (1\xe2\x89\xa4k\xe2\x89\xa4n1\xe2\x89\xa4k\xe2\x89\xa4n, 1\xe2\x89\xa4x\xe2\x89\xa4n1\xe2\x89\xa4x\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the city number and the number of ports in its subtree.'
b'It is guaranteed, that given edges correspond to valid trees, each candidate has given demand about each city at most once and that each candidate has specified the port demands for the capital of his choice. That is, the city xx is always given in demands of the first candidate and city yy is always given in the demands of the second candidate.'
b'Output'
b'Print exactly one integer\xc2\xa0\xe2\x80\x94 the maximum possible revenue that can be gained, while satisfying demands of both candidates, or -1 if it is not possible to satisfy all of the demands.'
Tags
flows, graphs, *2600
