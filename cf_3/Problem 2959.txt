b"Let's define the Eulerian traversal of a tree (a connected undirected graph without cycles) as follows: consider a depth-first search algorithm which traverses vertices of the tree and enumerates them in the order of visiting (only the first visit of each vertex counts). This function starts from the vertex number 11 and then recursively runs from all vertices which are connected with an edge with the current vertex and are not yet visited in increasing numbers order. Formally, you can describe this function using the following pseudocode:"
b'next_id = 1id = array of length n filled with -1visited = array of length n filled with falsefunction dfs(v):    visited[v] = true    id[v] = next_id    next_id += 1    for to in neighbors of v in increasing order:        if not visited[to]:            dfs(to)'
b'You are given a weighted tree, the vertices of which were enumerated with integers from 11 to nn using the algorithm described above.'
b'A leaf is a vertex of the tree which is connected with only one other vertex. In the tree given to you, the vertex 11 is not a leaf. The distance between two vertices in the tree is the sum of weights of the edges on the simple path between them.'
b'You have to answer qq queries of the following type: given integers vv, ll and rr, find the shortest distance from vertex vv to one of the leaves with indices from ll to rr inclusive. '
b'Input'
b'The first line contains two integers nn and qq (3\xe2\x89\xa4n\xe2\x89\xa4500000,1\xe2\x89\xa4q\xe2\x89\xa45000003\xe2\x89\xa4n\xe2\x89\xa4500000,1\xe2\x89\xa4q\xe2\x89\xa4500000)\xc2\xa0\xe2\x80\x94 the number of vertices in the tree and the number of queries, respectively.'
b'The (i\xe2\x88\x921)(i\xe2\x88\x921)-th of the following n\xe2\x88\x921n\xe2\x88\x921 lines contains two integers pipi and wiwi (1\xe2\x89\xa4pi<i,1\xe2\x89\xa4wi\xe2\x89\xa41091\xe2\x89\xa4pi<i,1\xe2\x89\xa4wi\xe2\x89\xa4109), denoting an edge between vertices pipi and ii with the weight wiwi.'
b"It's guaranteed that the given edges form a tree and the vertices are enumerated in the Eulerian traversal order and that the vertex with index 11 is not a leaf."
b'The next qq lines describe the queries. Each of them contains three integers vivi, lili, riri (1\xe2\x89\xa4vi\xe2\x89\xa4n,1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n1\xe2\x89\xa4vi\xe2\x89\xa4n,1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n), describing the parameters of the query. It is guaranteed that there is at least one leaf with index xx such that li\xe2\x89\xa4x\xe2\x89\xa4rili\xe2\x89\xa4x\xe2\x89\xa4ri.'
b'Output'
b'Output qq integers\xc2\xa0\xe2\x80\x94 the answers for the queries in the order they are given in the input.'
Tags
data structures, trees, *2600
