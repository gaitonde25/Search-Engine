b'Due to the success of TWICE, JYP Entertainment has earned countless money and emerged as the biggest entertainment firm by market capitalization. Therefore, the boss, JYP, has decided to create a new nation and has appointed you to provide a design diagram.'
b'The new nation consists of nn cities and some roads between them. JYP has given some restrictions:'
b'  To guarantee efficiency while avoiding chaos, for any 22 different cities AA and BB, there is exactly one road between them, and it is one-directional. There are no roads connecting a city to itself.  The logo of rivaling companies should not appear in the plan, that is, there does not exist 44 distinct cities AA,BB,CC,DD , such that the following configuration occurs. '
b'  '
b'JYP has given criteria for your diagram. For two cities AA,BB, let dis(A,B)dis(A,B) be the smallest number of roads you have to go through to get from AA to BB. If it is not possible to walk from AA to BB, dis(A,B)=614ndis(A,B)=614n. Then, the efficiency value is defined to be the sum of dis(A,B)dis(A,B) for all ordered pairs of distinct cities (A,B)(A,B).'
b"Note that dis(A,B)dis(A,B) doesn't have to be equal to dis(B,A)dis(B,A)."
b"You have drawn a design diagram that satisfies JYP's restrictions. Find the sum of dis(A,B)dis(A,B) over all ordered pairs of cities (A,B)(A,B) with A\xe2\x89\xa0BA\xe2\x89\xa0B."
b"Note that the input is given in compressed form. But even though it is compressed, you'd better use fast input."
b'Input'
b'The first line contains a single integer nn (4\xe2\x89\xa4n\xe2\x89\xa480004\xe2\x89\xa4n\xe2\x89\xa48000, n\xe2\x89\xa10(mod4)n\xe2\x89\xa10(mod4))\xc2\xa0\xe2\x80\x94 the number of cities.'
b'A binary matrix is encrypted in the following format. Each of nn next lines contains n4n4 one-digit hexadecimal numbers (that is, these numbers can be represented either as digits from 00 to 99 or as uppercase Latin letters from AA to FF). Binary representation of each of these numbers denotes next 44 elements of the matrix in the corresponding row. For example, if the number BB is given, then the corresponding elements are 10111011, and if the number is 55, then the corresponding elements are 01010101.'
b'After you obtain the decrypted binary matrix, the jj-th character of the ii-th row is 11 if the one-directional road between cities ii and jj is directed from ii to jj, and 00 otherwise. It is guaranteed that the graph satisfies the restrictions mentioned above.'
b'Output'
b'Output one integer, representing the sum of dis(A,B)dis(A,B) over all ordered pairs of cities (A,B)(A,B) with A\xe2\x89\xa0BA\xe2\x89\xa0B.'
Tags
graphs, *3500
