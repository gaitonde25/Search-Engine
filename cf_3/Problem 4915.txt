b"Sasha lives in a big happy family. At the Man's Day all the men of the family gather to celebrate it following their own traditions. There are n men in Sasha's family, so let's number them with integers from 1 to n."
b'Each man has at most one father but may have arbitrary number of sons.'
b'Man number A is considered to be the ancestor of the man number B if at least one of the following conditions is satisfied: '
b'  A\xe2\x80\x89=\xe2\x80\x89B;  the man number A is the father of the man number B;  there is a man number C, such that the man number A is his ancestor and the man number C is the father of the man number B. '
b'Of course, if the man number A is an ancestor of the man number B and A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B, then the man number B is not an ancestor of the man number A.'
b"The tradition of the Sasha's family is to give gifts at the Man's Day. Because giving gifts in a normal way is boring, each year the following happens."
b'  A list of candidates is prepared, containing some (possibly all) of the n men in some order.  Each of the n men decides to give a gift.  In order to choose a person to give a gift to, man A looks through the list and picks the first man B in the list, such that B is an ancestor of A and gives him a gift. Note that according to definition it may happen that a person gives a gift to himself.  If there is no ancestor of a person in the list, he becomes sad and leaves the celebration without giving a gift to anyone. '
b'This year you have decided to help in organizing celebration and asked each of the n men, who do they want to give presents to (this person is chosen only among ancestors). Are you able to make a list of candidates, such that all the wishes will be satisfied if they give gifts according to the process described above?'
b'Input'
b"In the first line of the input two integers n and m (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89<\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89100\xe2\x80\x89000) are given\xc2\xa0\xe2\x80\x94 the number of the men in the Sasha's family and the number of family relations in it respectively."
b'The next m lines describe family relations: the (i\xe2\x80\x89+\xe2\x80\x891)th line consists of pair of integers pi and qi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi,\xe2\x80\x89qi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89qi) meaning that the man numbered pi is the father of the man numbered qi. It is guaranteed that every pair of numbers appears at most once, that among every pair of two different men at least one of them is not an ancestor of another and that every man has at most one father.'
b'The next line contains n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), ith of which means that the man numbered i wants to give a gift to the man numbered ai. It is guaranteed that for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n the man numbered ai is an ancestor of the man numbered i.'
b'Output'
b'Print an integer k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)\xc2\xa0\xe2\x80\x94 the number of the men in the list of candidates, in the first line.'
b"Print then k pairwise different positive integers not exceeding n \xe2\x80\x94 the numbers of the men in the list in an order satisfying every of the men's wishes, one per line."
b'If there are more than one appropriate lists, print any of them. If there is no appropriate list print \xe2\x80\x89-\xe2\x80\x891 in the only line.'
Tags
constructive algorithms, dfs and similar, graphs, trees, *2000
