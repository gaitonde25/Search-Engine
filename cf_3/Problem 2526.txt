b"There are famous Russian nesting dolls named matryoshkas sold in one of the souvenir stores nearby, and you'd like to buy several of them. The store has nn different matryoshkas. Any matryoshka is a figure of volume outiouti with an empty space inside of volume iniini (of course, outi>iniouti>ini)."
b"You don't have much free space inside your bag, but, fortunately, you know that matryoshkas can be nested one inside another. Formally, let's call a set of matryoshkas nested if we can rearrange dolls in such a way, that the first doll can be nested inside the second one, the second doll \xe2\x80\x94 inside the third one and so on. Matryoshka ii can be nested inside matryoshka jj if outi\xe2\x89\xa4injouti\xe2\x89\xa4inj. So only the last doll will take space inside your bag."
b"Let's call extra space of a nested set of dolls as a total volume of empty space inside this structure. Obviously, it's equal to ini1+(ini2\xe2\x88\x92outi1)+(ini3\xe2\x88\x92outi2)+\xe2\x8b\xaf+(inik\xe2\x88\x92outik\xe2\x88\x921)ini1+(ini2\xe2\x88\x92outi1)+(ini3\xe2\x88\x92outi2)+\xe2\x8b\xaf+(inik\xe2\x88\x92outik\xe2\x88\x921), where i1i1, i2i2, ..., ikik are the indices of the chosen dolls in the order they are nested in each other."
b"Finally, let's call a nested subset of the given sequence as big enough if there isn't any doll from the sequence that can be added to the nested subset without breaking its nested property."
b"You want to buy many matryoshkas, so you should choose a big enough nested subset to buy it. But you will be disappointed if too much space in your bag will be wasted, so you want to choose a big enough subset so that its extra space is minimum possible among all big enough subsets. Now you wonder, how many different nested subsets meet these conditions (they are big enough, and there is no big enough subset such that its extra space is less than the extra space of the chosen subset). Two subsets are considered different if there exists at least one index ii such that one of the subsets contains the ii-th doll, and another subset doesn't."
b'Since the answer can be large, print it modulo 109+7109+7.'
b'Input'
b'The first line contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of matryoshkas.'
b'The next nn lines contain a description of each doll: two integers outiouti and iniini (1\xe2\x89\xa4ini<outi\xe2\x89\xa41091\xe2\x89\xa4ini<outi\xe2\x89\xa4109) \xe2\x80\x94 the outer and inners volumes of the ii-th matryoshka.'
b'Output'
b'Print one integer \xe2\x80\x94 the number of big enough nested subsets such that extra space of each of these subsets is minimum possible. Since the answer can be large, print it modulo 109+7109+7.'
Tags
binary search, combinatorics, data structures, dp, shortest paths, sortings, *2300
