b'The only difference between easy and hard versions is the length of the string. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.'
b'Kirk has a binary string ss (a string which consists of zeroes and ones) of length nn and he is asking you to find a binary string tt of the same length which satisfies the following conditions:'
b' For any ll and rr (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) the length of the longest non-decreasing subsequence of the substring slsl+1\xe2\x80\xa6srslsl+1\xe2\x80\xa6sr is equal to the length of the longest non-decreasing subsequence of the substring tltl+1\xe2\x80\xa6trtltl+1\xe2\x80\xa6tr; The number of zeroes in tt is the maximum possible.'
b'A non-decreasing subsequence of a string pp is a sequence of indices i1,i2,\xe2\x80\xa6,iki1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<iki1<i2<\xe2\x80\xa6<ik and pi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pikpi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pik. The length of the subsequence is kk.'
b'If there are multiple substrings which satisfy the conditions, output any.'
b'Input'
b'The first line contains a binary string of length not more than 105105.'
b'Output'
b'Output a binary string which satisfied the above conditions. If there are many such strings, output any of them.'
Tags
data structures, greedy, math, strings, *2100
