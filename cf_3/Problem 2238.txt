b'There are NN cities in the country of Numbata, numbered from 11 to NN. Currently, there is no road connecting them. Therefore, each of these NN cities proposes a road candidate to be constructed.'
b'City ii likes to connect with city AiAi, so city ii proposes to add a direct bidirectional road connecting city ii and city AiAi. It is guaranteed that no two cities like to connect with each other. In other words, there is no pair of integers ii and jj where Ai=jAi=j and Aj=iAj=i. It is also guaranteed that any pair of cities are connected by a sequence of road proposals. In other words, if all proposed roads are constructed, then any pair of cities are connected by a sequence of constructed road.'
b'City ii also prefers the road to be constructed using a specific material. Each material can be represented by an integer (for example, 00 for asphalt, 11 for wood, etc.). The material that can be used for the road connecting city ii and city AiAi is represented by an array BiBi containing MiMi integers: [(Bi)1,(Bi)2,\xe2\x80\xa6,(Bi)Mi][(Bi)1,(Bi)2,\xe2\x80\xa6,(Bi)Mi]. This means that the road connecting city ii and city AiAi can be constructed with either of the material in BiBi.'
b'There are KK workers to construct the roads. Each worker is only familiar with one material, thus can only construct a road with a specific material. In particular, the ithith worker can only construct a road with material CiCi. Each worker can only construct at most one road. You want to assign each worker to construct a road such that any pair of cities are connected by a sequence of constructed road.'
b'Input'
b'Input begins with a line containing two integers: NN KK (3\xe2\x89\xa4N\xe2\x89\xa420003\xe2\x89\xa4N\xe2\x89\xa42000; 1\xe2\x89\xa4K\xe2\x89\xa420001\xe2\x89\xa4K\xe2\x89\xa42000) representing the number of cities and the number of workers, respectively. The next NN lines each contains several integers: AiAi MiMi (Bi)1(Bi)1, (Bi)2(Bi)2, \xe2\x8b\xaf\xe2\x8b\xaf, (Bi)Mi(Bi)Mi (1\xe2\x89\xa4Ai\xe2\x89\xa4N1\xe2\x89\xa4Ai\xe2\x89\xa4N; Ai\xe2\x89\xa0iAi\xe2\x89\xa0i; 1\xe2\x89\xa4Mi\xe2\x89\xa4100001\xe2\x89\xa4Mi\xe2\x89\xa410000; 0\xe2\x89\xa4(Bi)1<(Bi)2<\xe2\x8b\xaf<(Bi)Mi\xe2\x89\xa41090\xe2\x89\xa4(Bi)1<(Bi)2<\xe2\x8b\xaf<(Bi)Mi\xe2\x89\xa4109) representing the bidirectional road that city ii likes to construct. It is guaranteed that the sum of MiMi does not exceed 1000010000. It is also guaranteed that no two cities like to connect with each other and any pair of cities are connected by a sequence of road proposals. The next line contains KK integers: CiCi (0\xe2\x89\xa4Ci\xe2\x89\xa41090\xe2\x89\xa4Ci\xe2\x89\xa4109) representing the material that is familiarized by the workers.'
b'Output'
b'If it is not possible to assign each worker to construct a road such that any pair of cities are connected by a sequence of constructed road, simply output -1 in a line. Otherwise, for each worker in the same order as input, output in a line two integers (separated by a single space): uu and vv in any order. This means that the worker constructs a direct bidirectional road connecting city uu and vv. If the worker does not construct any road, output "0 0" (without quotes) instead. Each pair of cities can only be assigned to at most one worker. You may output any assignment as long as any pair of cities are connected by a sequence of constructed road.'
Tags
flows, graphs, *2300
