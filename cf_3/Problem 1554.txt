b'Serge, the chef of the famous restaurant "Salt, Pepper & Garlic" is trying to obtain his first Michelin star. He has been informed that a secret expert plans to visit his restaurant this evening.'
b"Even though the expert's name hasn't been disclosed, Serge is certain he knows which dish from the menu will be ordered as well as what the taste preferences of the expert are. Namely, the expert requires an extremely precise proportion of salt, pepper and garlic powder in his dish."
b'Serge keeps a set of bottles with mixtures of salt, pepper and garlic powder on a special shelf in the kitchen. For each bottle, he knows the exact amount of each of the ingredients in kilograms. Serge can combine any number of bottled mixtures (or just use one of them directly) to get a mixture of particular proportions needed for a certain dish.'
b'Luckily, the absolute amount of a mixture that needs to be added to a dish is so small that you can assume that the amounts in the bottles will always be sufficient. However, the numeric values describing the proportions may be quite large.'
b"Serge would like to know whether it is possible to obtain the expert's favourite mixture from the available bottles, and if so\xe2\x80\x94what is the smallest possible number of bottles needed to achieve that."
b'Furthermore, the set of bottles on the shelf may change over time as Serge receives new ones or lends his to other chefs. So he would like to answer this question after each such change.'
b"For example, assume that expert's favorite mixture is 1:1:11:1:1 and there are three bottles of mixtures on the shelf:"
b' Mixture123Salt1030012Pepper2020015Garlic powder3010027MixtureSaltPepperGarlic powder110203023002001003121527 Amount of ingredient in the bottle, kg '
b'To obtain the desired mixture it is enough to use an equivalent amount of mixtures from bottles 1 and 2. If bottle 2 is removed, then it is no longer possible to obtain it.'
b'Write a program that helps Serge to solve this task!'
b'Input'
b"The first row contains three non-negative integers SfSf, PfPf and GfGf (0\xe2\x89\xa4Sf,Pf,Gf0\xe2\x89\xa4Sf,Pf,Gf; 0<Sf+Pf+Gf\xe2\x89\xa41060<Sf+Pf+Gf\xe2\x89\xa4106) describing the amount of salt, pepper and garlic powder in the expert's favourite mixture. For any real \xce\xb1>0\xce\xb1>0, (\xce\xb1Sf,\xce\xb1Pf,\xce\xb1Gf)(\xce\xb1Sf,\xce\xb1Pf,\xce\xb1Gf) also is an expert's favourite mixture."
b'In the second row, there is a positive integer NN (number of changes on the shelf, N\xe2\x89\xa4100000N\xe2\x89\xa4100000). You should assume that initially the shelf is empty.'
b'Each of the next NN rows describes a single change on the shelf: '
b'  If a new bottle is added, the row contains capital letter AA followed by three non-negative integers SiSi, PiPi and GiGi (0\xe2\x89\xa4Si,Pi,Gi0\xe2\x89\xa4Si,Pi,Gi; 0<Si+Pi+Gi\xe2\x89\xa41060<Si+Pi+Gi\xe2\x89\xa4106) describing the amount of salt, pepper and garlic powder in the added bottle. Added bottles are numbered consecutively by unique integers starting from 11, that is, the ii-th bottle corresponds to the ii-th added bottle in the input data.  If a particular bottle is removed from the shelf, the row contains capital letter RR followed by the integer\xe2\x80\x94the bottle number riri. All values riri in the removals are unique, riri never exceeds total number of bottles added thus far. '
b'Output'
b"Output NN rows. The jj-th row (1\xe2\x89\xa4j\xe2\x89\xa4N1\xe2\x89\xa4j\xe2\x89\xa4N) should contain the number xjxj, the smallest number of bottles needed to prepare a mixture with the expert's favourite proportions of salt, pepper and garlic powder using the bottles available after the first jj changes on the shelf, or 00 if it is not possible."
Tags
*special problem, data structures, geometry, math, sortings, *2900
