b"Let the main characters of this problem be personages from some recent movie. New Avengers seem to make a lot of buzz. I didn't watch any part of the franchise and don't know its heroes well, but it won't stop me from using them in this problem statement. So, Thanos and Dr. Strange are doing their superhero and supervillain stuff, but then suddenly they stumble across a regular competitive programming problem."
b'You are given a tree with nn vertices.'
b'In each vertex vv there is positive integer avav.'
b'You have to answer qq queries.'
b'Each query has a from uu vv xx.'
b'You have to calculate \xe2\x88\x8fw\xe2\x88\x88Pgcd(x,aw)mod(109+7)\xe2\x88\x8fw\xe2\x88\x88Pgcd(x,aw)mod(109+7), where PP is a set of vertices on path from uu to vv. In other words, you are to calculate the product of gcd(x,aw)gcd(x,aw) for all vertices ww on the path from uu to vv. As it might be large, compute it modulo 109+7109+7. Here gcd(s,t)gcd(s,t) denotes the greatest common divisor of ss and tt.'
b'Note that the numbers in vertices do not change after queries.'
b'I suppose that you are more interested in superhero business of Thanos and Dr. Strange than in them solving the problem. So you are invited to solve this problem instead of them.'
b'Input'
b'In the first line of input there is one integer nn (1\xe2\x89\xa4n\xe2\x89\xa41051\xe2\x89\xa4n\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the size of the tree.'
b'In the next n\xe2\x88\x921n\xe2\x88\x921 lines the edges of the tree are described. The ii-th edge is described with two integers uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n) and it connects the vertices uiui and vivi. It is guaranteed that graph with these edges is a tree.'
b'In the next line there are nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4av\xe2\x89\xa41071\xe2\x89\xa4av\xe2\x89\xa4107).'
b'In the next line there is one integer qq (1\xe2\x89\xa4q\xe2\x89\xa41051\xe2\x89\xa4q\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of queries.'
b'And in the next qq lines the queries are described. Each query is described with three integers uiui, vivi and xixi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n, 1\xe2\x89\xa4xi\xe2\x89\xa41071\xe2\x89\xa4xi\xe2\x89\xa4107).'
b'Output'
b'Print qq numbers\xc2\xa0\xe2\x80\x94 the answers to the queries in the order they are given in the input. Print each answer modulo 109+7=1000000007109+7=1000000007. Print each number on a separate line.'
Tags
brute force, data structures, math, number theory, trees, *2800
