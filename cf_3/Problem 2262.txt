b'The director of the famous dance show plans a tour. It is already decided that the tour will consist of up to mm concerts.'
b'There are nn dancers in the troupe. Each dancer is characterized by her awkwardness: the awkwardness of the ii-th dancer is equal to aiai.'
b'The director likes diversity. For this reason, each concert will be performed by a different set of dancers. A dancer may perform in multiple concerts. For example, it is possible that a set of dancers performs in one concert and a subset of this set of dancers performs in another concert. The only constraint is that the same set of dancers cannot perform twice.'
b'The director prefers the set with larger number of dancers over the set with smaller number of dancers. If two sets consist of the same number of dancers, then the director prefers the one which has smaller sum of awkwardness of dancers. If two sets of dancers are equal in size and total awkwardness, then the director does not have a preference which one is better.'
b'A marketing study shows that viewers are not ready to come to a concert if the total awkwardness of all the dancers performing in the concert is greater than kk.'
b'The director wants to find the best plan for mm concerts. He thinks to write down all possible sets of dancers; then get rid of the sets with total awkwardness greater than kk. The remaining sets of dancers will be sorted according to his preference. The most preferred set of dancers will give the first concert, the second preferred set \xe2\x80\x94 the second concert and so on until the mm-th concert. If it turns out that the total number of valid sets is less than mm, then the total number of concerts will be equal to the number of valid sets.'
b'It turns out that the director delegated finding the plan to you! Please, notice that there might be several acceptable plans due to the fact that the director does not have a preference over sets of dancers with the same size and total awkwardness. In this case any of these plans is good enough. For each concert find the number of dancers and the total awkwardness of the set performing. Also, for the last concert find its set of dancers.'
b'Input'
b'The first line contains one integer tt (1\xe2\x89\xa4t\xe2\x89\xa41051\xe2\x89\xa4t\xe2\x89\xa4105) \xe2\x80\x94 the number of test cases in the input. Then the test cases follow.'
b'Each test case begins with a line containing three integers nn, kk and mm (1\xe2\x89\xa4n\xe2\x89\xa41061\xe2\x89\xa4n\xe2\x89\xa4106, 1\xe2\x89\xa4k\xe2\x89\xa410181\xe2\x89\xa4k\xe2\x89\xa41018, 1\xe2\x89\xa4m\xe2\x89\xa41061\xe2\x89\xa4m\xe2\x89\xa4106) \xe2\x80\x94 the total number of dancers, the maximum acceptable awkwardness of a set of dancers and the maximum number of concerts, respectively.'
b'The following line contains nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa410121\xe2\x89\xa4ai\xe2\x89\xa41012), where aiai is the awkwardness of the ii-th dancer.'
b'The sum of the values of nn over all test cases in the input does not exceed 106106. Similarly, the sum of the values of mm over all test cases in the input does not exceed 106106.'
b'Output'
b'Print the answers to all test cases in the input.'
b'If the troupe cannot give concerts at all, then simply print one line "0". In this case, you should not print anything else.'
b'If the troupe gives a positive number of concerts rr (rr is equal to the minimum of mm and the total number of valid sets), then first print the value of rr, then rr lines: the jj-th line should contain two integers sjsj and tjtj \xe2\x80\x94 the number of dancers in the jj-th concert and the total awkwardness of the dancers performing in the jj-th concert. Complete the output to a test case with a line that describes the last set: print exactly srsr distinct integers from 11 to nn \xe2\x80\x94 the numbers of the dancers who will perform at the rr-th (last) concert, in any order. If there are several answers, print any of them.'
Tags
binary search, brute force, greedy, shortest paths, *3100
