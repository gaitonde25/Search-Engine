b"Today is tuesday, that means there is a dispute in JOHNNY SOLVING team again: they try to understand who is Johnny and who is Solving. That's why guys asked Umnik to help them. Umnik gave guys a connected graph with nn vertices without loops and multiedges, such that a degree of any vertex is at least 33, and also he gave a number 1\xe2\x89\xa4k\xe2\x89\xa4n1\xe2\x89\xa4k\xe2\x89\xa4n. Because Johnny is not too smart, he promised to find a simple path with length at least nknk in the graph. In reply, Solving promised to find kk simple by vertices cycles with representatives, such that: "
b'  Length of each cycle is at least 33.  Length of each cycle is not divisible by 33.  In each cycle must be a representative - vertex, which belongs only to this cycle among all printed cycles. '
b'You need to help guys resolve the dispute, for that you need to find a solution for Johnny: a simple path with length at least nknk (nn is not necessarily divided by kk), or solution for Solving: kk cycles that satisfy all the conditions above. If there is no any solution - print \xe2\x88\x921\xe2\x88\x921. '
b'Input'
b'The first line contains three integers nn, mm and kk (1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x89\xa42.5\xe2\x8b\x85105,1\xe2\x89\xa4m\xe2\x89\xa45\xe2\x8b\x851051\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x89\xa42.5\xe2\x8b\x85105,1\xe2\x89\xa4m\xe2\x89\xa45\xe2\x8b\x85105)'
b"Next mm lines describe edges of the graph in format vv, uu (1\xe2\x89\xa4v,u\xe2\x89\xa4n1\xe2\x89\xa4v,u\xe2\x89\xa4n). It's guaranteed that v\xe2\x89\xa0uv\xe2\x89\xa0u and all mm pairs are distinct."
b"It's guaranteed that a degree of each vertex is at least 33."
b'Output'
b'Print PATH in the first line, if you solve problem for Johnny. In the second line print the number of vertices in the path cc (c\xe2\x89\xa5nkc\xe2\x89\xa5nk). And in the third line print vertices describing the path in route order.'
b'Print CYCLES in the first line, if you solve problem for Solving. In the following lines describe exactly kk cycles in the following format: in the first line print the size of the cycle cc (c\xe2\x89\xa53c\xe2\x89\xa53). In the second line print the cycle in route order. Also, the first vertex in the cycle must be a representative.'
b"Print \xe2\x88\x921\xe2\x88\x921 if there is no any solution. The total amount of printed numbers in the output must be at most 106106. It's guaranteed, that if exists any solution then there is a correct output satisfies this restriction."
Tags
constructive algorithms, dfs and similar, graphs, math, *2700
