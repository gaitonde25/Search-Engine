b'You are a mayor of Berlyatov. There are nn districts and mm two-way roads between them. The ii-th road connects districts xixi and yiyi. The cost of travelling along this road is wiwi. There is some path between each pair of districts, so the city is connected.'
b'There are kk delivery routes in Berlyatov. The ii-th route is going from the district aiai to the district bibi. There is one courier on each route and the courier will always choose the cheapest (minimum by total cost) path from the district aiai to the district bibi to deliver products.'
b'The route can go from the district to itself, some couriers routes can coincide (and you have to count them independently).'
b'You can make at most one road to have cost zero (i.e. you choose at most one road and change its cost with 00).'
b'Let d(x,y)d(x,y) be the cheapest cost of travel between districts xx and yy.'
b'Your task is to find the minimum total courier routes cost you can achieve, if you optimally select the some road and change its cost with 00. In other words, you have to find the minimum possible value of \xe2\x88\x91i=1kd(ai,bi)\xe2\x88\x91i=1kd(ai,bi) after applying the operation described above optimally.'
b'Input'
b'The first line of the input contains three integers nn, mm and kk (2\xe2\x89\xa4n\xe2\x89\xa410002\xe2\x89\xa4n\xe2\x89\xa41000; n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa4min(1000,n(n\xe2\x88\x921)2)n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa4min(1000,n(n\xe2\x88\x921)2); 1\xe2\x89\xa4k\xe2\x89\xa410001\xe2\x89\xa4k\xe2\x89\xa41000) \xe2\x80\x94 the number of districts, the number of roads and the number of courier routes.'
b'The next mm lines describe roads. The ii-th road is given as three integers xixi, yiyi and wiwi (1\xe2\x89\xa4xi,yi\xe2\x89\xa4n1\xe2\x89\xa4xi,yi\xe2\x89\xa4n; xi\xe2\x89\xa0yixi\xe2\x89\xa0yi; 1\xe2\x89\xa4wi\xe2\x89\xa410001\xe2\x89\xa4wi\xe2\x89\xa41000), where xixi and yiyi are districts the ii-th road connects and wiwi is its cost. It is guaranteed that there is some path between each pair of districts, so the city is connected. It is also guaranteed that there is at most one road between each pair of districts.'
b'The next kk lines describe courier routes. The ii-th route is given as two integers aiai and bibi (1\xe2\x89\xa4ai,bi\xe2\x89\xa4n1\xe2\x89\xa4ai,bi\xe2\x89\xa4n) \xe2\x80\x94 the districts of the ii-th route. The route can go from the district to itself, some couriers routes can coincide (and you have to count them independently).'
b'Output'
b'Print one integer \xe2\x80\x94 the minimum total courier routes cost you can achieve (i.e. the minimum value \xe2\x88\x91i=1kd(ai,bi)\xe2\x88\x91i=1kd(ai,bi), where d(x,y)d(x,y) is the cheapest cost of travel between districts xx and yy) if you can make some (at most one) road cost zero.'
Tags
brute force, graphs, shortest paths, *2100
