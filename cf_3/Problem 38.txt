b'You are given a directed acyclic graph, consisting of nn vertices and mm edges. The vertices are numbered from 11 to nn. There are no multiple edges and self-loops.'
b'Let invinv be the number of incoming edges (indegree) and outvoutv be the number of outgoing edges (outdegree) of vertex vv.'
b'You are asked to remove some edges from the graph. Let the new degrees be in\xe2\x80\xb2vin\xe2\x80\xb2v and out\xe2\x80\xb2vout\xe2\x80\xb2v.'
b'You are only allowed to remove the edges if the following conditions hold for every vertex vv: '
b'  in\xe2\x80\xb2v<invin\xe2\x80\xb2v<inv or in\xe2\x80\xb2v=inv=0in\xe2\x80\xb2v=inv=0;  out\xe2\x80\xb2v<outvout\xe2\x80\xb2v<outv or out\xe2\x80\xb2v=outv=0out\xe2\x80\xb2v=outv=0. '
b"Let's call a set of vertices SS cute if for each pair of vertices vv and uu (v\xe2\x89\xa0uv\xe2\x89\xa0u) such that v\xe2\x88\x88Sv\xe2\x88\x88S and u\xe2\x88\x88Su\xe2\x88\x88S, there exists a path either from vv to uu or from uu to vv over the non-removed edges."
b'What is the maximum possible size of a cute set SS after you remove some edges from the graph and both indegrees and outdegrees of all vertices either decrease or remain equal to 00?'
b'Input'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105; 0\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x851050\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of vertices and the number of edges of the graph.'
b'Each of the next mm lines contains two integers vv and uu (1\xe2\x89\xa4v,u\xe2\x89\xa4n1\xe2\x89\xa4v,u\xe2\x89\xa4n; v\xe2\x89\xa0uv\xe2\x89\xa0u)\xc2\xa0\xe2\x80\x94 the description of an edge.'
b'The given edges form a valid directed acyclic graph. There are no multiple edges.'
b'Output'
b'Print a single integer\xc2\xa0\xe2\x80\x94 the maximum possible size of a cute set SS after you remove some edges from the graph and both indegrees and outdegrees of all vertices either decrease or remain equal to 00.'
Tags
dfs and similar, dp, graphs, *2000
