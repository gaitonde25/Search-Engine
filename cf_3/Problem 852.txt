b'Monocarp plays a computer game called "Goblins and Gnomes". In this game, he manages a large underground city of gnomes and defends it from hordes of goblins.'
b'The city consists of nn halls and mm one-directional tunnels connecting them. The structure of tunnels has the following property: if a goblin leaves any hall, he cannot return to that hall. '
b"The city will be attacked by kk waves of goblins; during the ii-th wave, ii goblins attack the city. Monocarp's goal is to pass all kk waves."
b'The ii-th wave goes as follows: firstly, ii goblins appear in some halls of the city and pillage them; at most one goblin appears in each hall. Then, goblins start moving along the tunnels, pillaging all the halls in their path. '
b'Goblins are very greedy and cunning, so they choose their paths so that no two goblins pass through the same hall. Among all possible attack plans, they choose a plan which allows them to pillage the maximum number of halls. After goblins are done pillaging, they leave the city.'
b'If all halls are pillaged during the wave \xe2\x80\x94 Monocarp loses the game. Otherwise, the city is restored. If some hall is pillaged during a wave, goblins are still interested in pillaging it during the next waves.'
b"Before each wave, Monocarp can spend some time preparing to it. Monocarp doesn't have any strict time limits on his preparations (he decides when to call each wave by himself), but the longer he prepares for a wave, the fewer points he gets for passing it. If Monocarp prepares for the ii-th wave for titi minutes, then he gets max(0,xi\xe2\x88\x92ti\xe2\x8b\x85yi)max(0,xi\xe2\x88\x92ti\xe2\x8b\x85yi) points for passing it (obviously, if he doesn't lose in the process)."
b'While preparing for a wave, Monocarp can block tunnels. He can spend one minute to either block all tunnels leading from some hall or block all tunnels leading to some hall. If Monocarp blocks a tunnel while preparing for a wave, it stays blocked during the next waves as well.'
b'Help Monocarp to defend against all kk waves of goblins and get the maximum possible amount of points!'
b'Input'
b'The first line contains three integers nn, mm and kk (2\xe2\x89\xa4n\xe2\x89\xa4502\xe2\x89\xa4n\xe2\x89\xa450; 0\xe2\x89\xa4m\xe2\x89\xa4n(n\xe2\x88\x921)20\xe2\x89\xa4m\xe2\x89\xa4n(n\xe2\x88\x921)2; 1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921)\xc2\xa0\xe2\x80\x94 the number of halls in the city, the number of tunnels and the number of goblin waves, correspondely.'
b'Next mm lines describe tunnels. The ii-th line contains two integers uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n; ui\xe2\x89\xa0viui\xe2\x89\xa0vi). It means that the tunnel goes from hall uiui to hall vivi. The structure of tunnels has the following property: if a goblin leaves any hall, he cannot return to that hall. There is at most one tunnel between each pair of halls.'
b'Next kk lines describe the scoring system. The ii-th line contains two integers xixi and yiyi (1\xe2\x89\xa4xi\xe2\x89\xa41091\xe2\x89\xa4xi\xe2\x89\xa4109; 1\xe2\x89\xa4yi\xe2\x89\xa41091\xe2\x89\xa4yi\xe2\x89\xa4109). If Monocarp prepares for the ii-th wave for titi minutes, then he gets max(0,xi\xe2\x88\x92ti\xe2\x8b\x85yi)max(0,xi\xe2\x88\x92ti\xe2\x8b\x85yi) points for passing it.'
b'Output'
b"Print the optimal Monocarp's strategy in the following format:"
b'At first, print one integer aa (k\xe2\x89\xa4a\xe2\x89\xa42n+kk\xe2\x89\xa4a\xe2\x89\xa42n+k)\xc2\xa0\xe2\x80\x94 the number of actions Monocarp will perform. Next, print actions themselves in the order Monocarp performs them. The ii-th action is described by a single integer bibi (\xe2\x88\x92n\xe2\x89\xa4bi\xe2\x89\xa4n\xe2\x88\x92n\xe2\x89\xa4bi\xe2\x89\xa4n) using the following format:'
b'  if bi>0bi>0 then Monocarp blocks all tunnels going out from the hall bibi;  if bi<0bi<0 then Monocarp blocks all tunnels going into the hall |bi||bi|;  if bi=0bi=0 then Monocarp calls the next goblin wave. '
b"You can't repeat the same block action bibi several times. Monocarp must survive all waves he calls (goblins shouldn't be able to pillage all halls). Monocarp should call exactly kk waves and earn the maximum possible number of points in total."
b'If there are several optimal strategies\xc2\xa0\xe2\x80\x94 print any of them.'
Tags
brute force, dp, flows, graph matchings, *2800
