b'Alice had a permutation p1,p2,\xe2\x80\xa6,pnp1,p2,\xe2\x80\xa6,pn. Unfortunately, the permutation looked very boring, so she decided to change it and choose some non-overlapping subranges of this permutation and reverse them. The cost of reversing a single subrange [l,r][l,r] (elements from position ll to position rr, inclusive) is equal to r\xe2\x88\x92lr\xe2\x88\x92l, and the cost of the operation is the sum of costs of reversing individual subranges. Alice had an integer cc in mind, so she only considered operations that cost no more than cc.'
b'Then she got really bored, and decided to write down all the permutations that she could possibly obtain by performing exactly one operation on the initial permutation. Of course, Alice is very smart, so she wrote down each obtainable permutation exactly once (no matter in how many ways it can be obtained), and of course the list was sorted lexicographically.'
b'Now Bob would like to ask Alice some questions about her list. Each question is in the following form: what is the ii-th number in the jj-th permutation that Alice wrote down? Since Alice is too bored to answer these questions, she asked you to help her out.'
b'Input'
b'The first line contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa4301\xe2\x89\xa4t\xe2\x89\xa430)\xc2\xa0\xe2\x80\x94 the number of test cases.'
b'The first line of each test case contains three integers nn, cc, qq (1\xe2\x89\xa4n\xe2\x89\xa43\xe2\x8b\x851041\xe2\x89\xa4n\xe2\x89\xa43\xe2\x8b\x85104, 1\xe2\x89\xa4c\xe2\x89\xa441\xe2\x89\xa4c\xe2\x89\xa44, 1\xe2\x89\xa4q\xe2\x89\xa43\xe2\x8b\x851051\xe2\x89\xa4q\xe2\x89\xa43\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the length of the permutation, the maximum cost of the operation, and the number of queries.'
b'The next line of each test case contains nn integers p1,p2,\xe2\x80\xa6,pnp1,p2,\xe2\x80\xa6,pn (1\xe2\x89\xa4pi\xe2\x89\xa4n1\xe2\x89\xa4pi\xe2\x89\xa4n, pi\xe2\x89\xa0pjpi\xe2\x89\xa0pj if i\xe2\x89\xa0ji\xe2\x89\xa0j), describing the initial permutation.'
b'The following qq lines describe the queries. Each of them contains two integers ii and jj (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa410181\xe2\x89\xa4j\xe2\x89\xa41018), denoting parameters of this query.'
b'It is guaranteed that the sum of values nn over all test cases does not exceed 3\xe2\x8b\x851053\xe2\x8b\x85105, and the sum of values qq over all test cases does not exceed 3\xe2\x8b\x851053\xe2\x8b\x85105.'
b'Output'
b'For each query output the answer for this query, or \xe2\x88\x921\xe2\x88\x921 if jj-th permutation does not exist in her list.'
Tags
binary search, combinatorics, data structures, dp, graphs, implementation, two pointers, *3200
