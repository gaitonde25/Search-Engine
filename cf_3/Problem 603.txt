b'A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters "1" and "+" between the original characters of the sequence. For example:'
b'  bracket sequences "()()" and "(())" are regular (the resulting expressions are: "(1)+(1)" and "((1+1)+1)");  bracket sequences ")(", "(" and ")" are not. '
b'You are given two strings ss and aa, the string ss has length nn, the string aa has length n\xe2\x88\x923n\xe2\x88\x923. The string ss is a bracket sequence (i.\xe2\x80\x89e. each element of this string is either an opening bracket character or a closing bracket character). The string aa is a binary string (i.\xe2\x80\x89e. each element of this string is either 1 or 0).'
b"The string aa imposes some constraints on the string ss: for every ii such that aiai is 1, the string sisi+1si+2si+3sisi+1si+2si+3 should be a regular bracket sequence. Characters of aa equal to 0 don't impose any constraints."
b'Initially, the string ss may or may not meet these constraints. You can perform the following operation any number of times: replace some character of ss with its inverse (i.\xe2\x80\x89e. you can replace an opening bracket with a closing bracket, or vice versa).'
b'Determine if it is possible to change some characters in ss so that it meets all of the constraints, and if it is possible, calculate the minimum number of characters to be changed.'
b'Input'
b'The first line contains one integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104) \xe2\x80\x94 the number of test cases.'
b"Each test case consists of three lines. The first line contains one integer nn (4\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851054\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105). The second line contains the string ss, consisting of exactly nn characters; each character of ss is either '(' or ')'. The third line contains the string aa, consisting of exactly n\xe2\x88\x923n\xe2\x88\x923 characters; each character of aa is either '1' or '0'."
b'Additional constraint on the input: the sum of nn over all test cases does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each test case, print one integer: the minimum number of characters that need to be changed in ss, or \xe2\x88\x921\xe2\x88\x921 if it is impossible.'
Tags
*special problem, bitmasks, dp, greedy, *1700
