b'You are given mm strings and a tree on nn nodes. Each edge has some letter written on it.'
b'You have to answer qq queries. Each query is described by 44 integers uu, vv, ll and rr. The answer to the query is the total number of occurrences of str(u,v)str(u,v) in strings with indices from ll to rr. str(u,v)str(u,v) is defined as the string that is made by concatenating letters written on the edges on the shortest path from uu to vv (in order that they are traversed).'
b'Input'
b'The first line of the input contains three integers nn, mm and qq (2\xe2\x89\xa4n\xe2\x89\xa41052\xe2\x89\xa4n\xe2\x89\xa4105, 1\xe2\x89\xa4m,q\xe2\x89\xa41051\xe2\x89\xa4m,q\xe2\x89\xa4105).'
b'The ii-th of the following n\xe2\x88\x921n\xe2\x88\x921 lines contains two integers ui,viui,vi and a lowercase Latin letter cici (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n, ui\xe2\x89\xa0viui\xe2\x89\xa0vi), denoting the edge between nodes ui,viui,vi with a character cici on it. '
b"It's guaranteed that these edges form a tree."
b'The following mm lines contain the strings consisting of lowercase Latin letters. The total length of those strings does not exceed 105105.'
b'Then qq lines follow, each containing four integers uu, vv, ll and rr (1\xe2\x89\xa4u,v\xe2\x89\xa4n1\xe2\x89\xa4u,v\xe2\x89\xa4n, u\xe2\x89\xa0vu\xe2\x89\xa0v, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m), denoting the queries. '
b'Output'
b'For each query print a single integer \xe2\x80\x94 the answer to the query.'
Tags
binary search, data structures, dfs and similar, hashing, string suffix structures, strings, trees, *3500
