b'You have two strings aa and bb of equal length nn consisting of characters 0 and 1, and an integer kk.'
b'You need to make strings aa and bb equal.'
b'In one step, you can choose any substring of aa containing exactly kk characters 1 (and arbitrary number of characters 0) and reverse it. Formally, if a=a1a2\xe2\x80\xa6ana=a1a2\xe2\x80\xa6an, you can choose any integers ll and rr (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that there are exactly kk ones among characters al,al+1,\xe2\x80\xa6,aral,al+1,\xe2\x80\xa6,ar, and set aa to a1a2\xe2\x80\xa6al\xe2\x88\x921arar\xe2\x88\x921\xe2\x80\xa6alar+1ar+2\xe2\x80\xa6ana1a2\xe2\x80\xa6al\xe2\x88\x921arar\xe2\x88\x921\xe2\x80\xa6alar+1ar+2\xe2\x80\xa6an.'
b"Find a way to make aa equal to bb using at most 4n4n reversals of the above kind, or determine that such a way doesn't exist. The number of reversals doesn't have to be minimized."
b'Input'
b'Each test contains multiple test cases. The first line contains the number of test cases tt (1\xe2\x89\xa4t\xe2\x89\xa420001\xe2\x89\xa4t\xe2\x89\xa42000). Description of the test cases follows.'
b'Each test case consists of three lines. The first line of each test case contains two integers nn and kk (1\xe2\x89\xa4n\xe2\x89\xa420001\xe2\x89\xa4n\xe2\x89\xa42000; 0\xe2\x89\xa4k\xe2\x89\xa4n0\xe2\x89\xa4k\xe2\x89\xa4n).'
b'The second line contains string aa of length nn.'
b'The third line contains string bb of the same length. Both strings consist of characters 0 and 1.'
b'It is guaranteed that the sum of nn over all test cases does not exceed 20002000.'
b'Output'
b"For each test case, if it's impossible to make aa equal to bb in at most 4n4n reversals, print a single integer \xe2\x88\x921\xe2\x88\x921."
b'Otherwise, print an integer mm (0\xe2\x89\xa4m\xe2\x89\xa44n0\xe2\x89\xa4m\xe2\x89\xa44n), denoting the number of reversals in your sequence of steps, followed by mm pairs of integers li,rili,ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n), denoting the boundaries of the substrings of aa to be reversed, in chronological order. Each substring must contain exactly kk ones at the moment of reversal.'
b"Note that mm doesn't have to be minimized. If there are multiple answers, print any."
Tags
constructive algorithms, *3300
