b'Once Divan analyzed a sequence a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an consisting of nn non-negative integers as follows. He considered each non-empty subsequence of the sequence aa, computed the bitwise XOR of its elements and added up all the XORs, obtaining the coziness of the sequence aa.'
b'A sequence cc is a subsequence of a sequence dd if cc can be obtained from dd by deletion of several (possibly, zero or all) elements. For example, [1,2,3,4][1,2,3,4], [2,4][2,4], and [2][2] are subsequences of [1,2,3,4][1,2,3,4], but [4,3][4,3] and [0][0] are not.'
b'Divan was very proud of his analysis, but now he lost the sequence aa, and also the coziness value! However, Divan remembers the value of bitwise OR on mm contiguous subsegments of the sequence aa. It turns out that each element of the original sequence is contained in at least one of these mm segments.'
b'Divan asks you to help find the coziness of the sequence aa using the information he remembers. If several coziness values are possible, print any.'
b'As the result can be very large, print the value modulo 109+7109+7.'
b'Input'
b'The first line contains one integer number tt (1\xe2\x89\xa4t\xe2\x89\xa41031\xe2\x89\xa4t\xe2\x89\xa4103) \xe2\x80\x94 the number of test cases.'
b'The first line of each test case contains two integer numbers nn and mm (1\xe2\x89\xa4n,m\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n,m\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the length of the sequence and the number of contiguous segments whose bitwise OR values Divan remembers, respectively.'
b'The following mm lines describe the segments, one per line.'
b'Each segment is described with three integers ll, rr, and xx (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 0\xe2\x89\xa4x\xe2\x89\xa4230\xe2\x88\x9210\xe2\x89\xa4x\xe2\x89\xa4230\xe2\x88\x921) \xe2\x80\x94 the first and last elements of the segment and the bitwise OR of al,al+1,\xe2\x80\xa6,aral,al+1,\xe2\x80\xa6,ar, respectively.'
b'It is guaranteed that each element of the sequence is contained in at least one of the segments. It is guaranteed that there exists a sequence that satisfies all constraints.'
b'It is guaranteed that the sum of nn and the sum of mm over all test cases do not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105. '
b'Output'
b'For each test case print the coziness any suitable sequence aa modulo 109+7109+7.'
Tags
bitmasks, combinatorics, constructive algorithms, dp, math, *1500
