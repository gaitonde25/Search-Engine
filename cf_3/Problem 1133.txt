b'There are nn cities in Berland. The city numbered 11 is the capital. Some pairs of cities are connected by a one-way road of length 1.'
b'Before the trip, Polycarp for each city found out the value of didi\xc2\xa0\xe2\x80\x94 the shortest distance from the capital (the 11-st city) to the ii-th city.'
b'Polycarp begins his journey in the city with number ss and, being in the ii-th city, chooses one of the following actions: '
b'  Travel from the ii-th city to the jj-th city if there is a road from the ii-th city to the jj-th and di<djdi<dj;  Travel from the ii-th city to the jj-th city if there is a road from the ii-th city to the jj-th and di\xe2\x89\xa5djdi\xe2\x89\xa5dj;  Stop traveling. '
b'Since the government of Berland does not want all people to come to the capital, so Polycarp no more than once can take the second action from the list. in other words, he can perform the second action 00 or 11 time during his journey. Polycarp, on the other hand, wants to be as close to the capital as possible.'
b'  '
b'For example, if n=6n=6 and the cities are connected, as in the picture above, then Polycarp could have made the following travels (not all possible options): '
b'  2\xe2\x86\x925\xe2\x86\x921\xe2\x86\x922\xe2\x86\x9252\xe2\x86\x925\xe2\x86\x921\xe2\x86\x922\xe2\x86\x925;  3\xe2\x86\x926\xe2\x86\x9223\xe2\x86\x926\xe2\x86\x922;  1\xe2\x86\x923\xe2\x86\x926\xe2\x86\x922\xe2\x86\x9251\xe2\x86\x923\xe2\x86\x926\xe2\x86\x922\xe2\x86\x925. '
b'Polycarp wants for each starting city ii to find out how close he can get to the capital. More formally: he wants to find the minimal value of djdj that Polycarp can get from the city ii to the city jj according to the rules described above.'
b'Input'
b'The first line contains one integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104)\xc2\xa0\xe2\x80\x94 the number of test cases. Then tt test cases follow.'
b'Each test case is preceded by an empty line.'
b'The first line of each test case contains two integers nn (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) and mm (1\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 number of cities and roads, respectively.'
b'This is followed by mm lines describing the roads. Each road is characterized by two integers uu and vv (1\xe2\x89\xa4u,v\xe2\x89\xa4n,u\xe2\x89\xa0v1\xe2\x89\xa4u,v\xe2\x89\xa4n,u\xe2\x89\xa0v)\xc2\xa0\xe2\x80\x94 the numbers of cities connected by a one-way road.'
b'It is guaranteed that the sums of nn and mm over all test cases do not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'It is guaranteed that for each pair of different cities (u,v)(u,v) there is at most one road from uu to vv (but a pair of roads from uu to vv and from vv to uu\xc2\xa0\xe2\x80\x94 is valid).'
b'It is guaranteed that there is a path from the capital to all cities.'
b'Output'
b'For each test case, on a separate line output nn numbers, the ii-th of which is equal to the minimum possible distance from the capital to the city where Polycarp ended his journey.'
Tags
dfs and similar, dp, graphs, shortest paths, *2100
