b'By the year 3018, Summer Informatics School has greatly grown. Hotel \xc2\xabBerendeetronik\xc2\xbb has been chosen as a location of the school. The camp consists of nn houses with n\xe2\x88\x921n\xe2\x88\x921 pathways between them. It is possible to reach every house from each other using the pathways.'
b'Everything had been perfect until the rains started. The weather forecast promises that rains will continue for mm days. A special squad of teachers was able to measure that the ii-th pathway, connecting houses uiui and vivi, before the rain could be passed in bibi seconds. Unfortunately, the rain erodes the roads, so with every day the time to pass the road will increase by aiai seconds. In other words, on the tt-th (from zero) day after the start of the rain, it will take ai\xe2\x8b\x85t+biai\xe2\x8b\x85t+bi seconds to pass through this road.'
b'Unfortunately, despite all the efforts of teachers, even in the year 3018 not all the students are in their houses by midnight. As by midnight all students have to go to bed, it is important to find the maximal time between all the pairs of houses for each day, so every student would know the time when he has to run to his house.'
b'Find all the maximal times of paths between every pairs of houses after t=0t=0, t=1t=1, ..., t=m\xe2\x88\x921t=m\xe2\x88\x921 days.'
b'Input'
b'In the first line you are given two integers nn and mm\xc2\xa0\xe2\x80\x94 the number of houses in the camp and the number of raining days (1\xe2\x89\xa4n\xe2\x89\xa41000001\xe2\x89\xa4n\xe2\x89\xa4100000; 1\xe2\x89\xa4m\xe2\x89\xa410000001\xe2\x89\xa4m\xe2\x89\xa41000000).'
b'In the next n\xe2\x88\x921n\xe2\x88\x921 lines you are given the integers uiui, vivi, aiai, bibi\xc2\xa0\xe2\x80\x94 description of pathways (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n; 0\xe2\x89\xa4ai\xe2\x89\xa41050\xe2\x89\xa4ai\xe2\x89\xa4105; 0\xe2\x89\xa4bi\xe2\x89\xa41090\xe2\x89\xa4bi\xe2\x89\xa4109). ii-th pathway connects houses uiui and vivi, and in day tt requires ai\xe2\x8b\x85t+biai\xe2\x8b\x85t+bi seconds to pass through.'
b'It is guaranteed that every two houses are connected by a sequence of pathways.'
b'Output'
b'Print mm integers\xc2\xa0\xe2\x80\x94 the lengths of the longest path in the camp after a t=0,t=1,\xe2\x80\xa6,t=m\xe2\x88\x921t=0,t=1,\xe2\x80\xa6,t=m\xe2\x88\x921 days after the start of the rain.'
Tags
data structures, divide and conquer, trees, *3200
