b"Kamil likes streaming the competitive programming videos. His MeTube channel has recently reached 100100 million subscribers. In order to celebrate this, he posted a video with an interesting problem he couldn't solve yet. Can you help him?"
b"You're given a tree \xe2\x80\x94 a connected undirected graph consisting of nn vertices connected by n\xe2\x88\x921n\xe2\x88\x921 edges. The tree is rooted at vertex 11. A vertex uu is called an ancestor of vv if it lies on the shortest path between the root and vv. In particular, a vertex is an ancestor of itself."
b'Each vertex vv is assigned its beauty xvxv \xe2\x80\x94 a non-negative integer not larger than 10121012. This allows us to define the beauty of a path. Let uu be an ancestor of vv. Then we define the beauty f(u,v)f(u,v) as the greatest common divisor of the beauties of all vertices on the shortest path between uu and vv. Formally, if u=t1,t2,t3,\xe2\x80\xa6,tk=vu=t1,t2,t3,\xe2\x80\xa6,tk=v are the vertices on the shortest path between uu and vv, then f(u,v)=gcd(xt1,xt2,\xe2\x80\xa6,xtk)f(u,v)=gcd(xt1,xt2,\xe2\x80\xa6,xtk). Here, gcdgcd denotes the greatest common divisor of a set of numbers. In particular, f(u,u)=gcd(xu)=xuf(u,u)=gcd(xu)=xu.'
b'Your task is to find the sum'
b'\xe2\x88\x91u\xc2\xa0is an ancestor of\xc2\xa0vf(u,v).\xe2\x88\x91u\xc2\xa0is an ancestor of\xc2\xa0vf(u,v).'
b'As the result might be too large, please output it modulo 109+7109+7.'
b'Note that for each yy, gcd(0,y)=gcd(y,0)=ygcd(0,y)=gcd(y,0)=y. In particular, gcd(0,0)=0gcd(0,0)=0.'
b'Input'
b'The first line contains a single integer nn (2\xe2\x89\xa4n\xe2\x89\xa41000002\xe2\x89\xa4n\xe2\x89\xa4100000) \xe2\x80\x94 the number of vertices in the tree.'
b'The following line contains nn integers x1,x2,\xe2\x80\xa6,xnx1,x2,\xe2\x80\xa6,xn (0\xe2\x89\xa4xi\xe2\x89\xa410120\xe2\x89\xa4xi\xe2\x89\xa41012). The value xvxv denotes the beauty of vertex vv.'
b'The following n\xe2\x88\x921n\xe2\x88\x921 lines describe the edges of the tree. Each of them contains two integers a,ba,b (1\xe2\x89\xa4a,b\xe2\x89\xa4n1\xe2\x89\xa4a,b\xe2\x89\xa4n, a\xe2\x89\xa0ba\xe2\x89\xa0b) \xe2\x80\x94 the vertices connected by a single edge.'
b'Output'
b'Output the sum of the beauties on all paths (u,v)(u,v) such that uu is ancestor of vv. This sum should be printed modulo 109+7109+7.'
Tags
math, number theory, trees, *2000
