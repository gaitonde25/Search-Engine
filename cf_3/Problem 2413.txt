b'In addition to complaints about lighting, a lot of complaints about insufficient radio signal covering has been received by Bertown city hall recently. nn complaints were sent to the mayor, all of which are suspiciosly similar to each other: in the ii-th complaint, one of the radio fans has mentioned that the signals of two radio stations xixi and yiyi are not covering some parts of the city, and demanded that the signal of at least one of these stations can be received in the whole city.'
b"Of cousre, the mayor of Bertown is currently working to satisfy these complaints. A new radio tower has been installed in Bertown, it can transmit a signal with any integer power from 11 to MM (let's denote the signal power as ff). The mayor has decided that he will choose a set of radio stations and establish a contract with every chosen station. To establish a contract with the ii-th station, the following conditions should be met:"
b"  the signal power ff should be not less than lili, otherwise the signal of the ii-th station won't cover the whole city;  the signal power ff should be not greater than riri, otherwise the signal will be received by the residents of other towns which haven't established a contract with the ii-th station. "
b'All this information was already enough for the mayor to realise that choosing the stations is hard. But after consulting with specialists, he learned that some stations the signals of some stations may interfere with each other: there are mm pairs of stations (uiui, vivi) that use the same signal frequencies, and for each such pair it is impossible to establish contracts with both stations. If stations xx and yy use the same frequencies, and yy and zz use the same frequencies, it does not imply that xx and zz use the same frequencies.'
b'The mayor finds it really hard to analyze this situation, so he hired you to help him. You have to choose signal power ff and a set of stations to establish contracts with such that:'
b'  all complaints are satisfied (formally, for every i\xe2\x88\x88[1,n]i\xe2\x88\x88[1,n] the city establishes a contract either with station xixi, or with station yiyi);  no two chosen stations interfere with each other (formally, for every i\xe2\x88\x88[1,m]i\xe2\x88\x88[1,m] the city does not establish a contract either with station uiui, or with station vivi);  for each chosen station, the conditions on signal power are met (formally, for each chosen station ii the condition li\xe2\x89\xa4f\xe2\x89\xa4rili\xe2\x89\xa4f\xe2\x89\xa4ri is met). '
b'Input'
b'The first line contains 44 integers nn, pp, MM and mm (2\xe2\x89\xa4n,p,M,m\xe2\x89\xa44\xe2\x8b\x851052\xe2\x89\xa4n,p,M,m\xe2\x89\xa44\xe2\x8b\x85105) \xe2\x80\x94 the number of complaints, the number of radio stations, maximum signal power and the number of interfering pairs, respectively.'
b'Then nn lines follow, which describe the complains. Each line contains two integers xixi and yiyi (1\xe2\x89\xa4xi<yi\xe2\x89\xa4p1\xe2\x89\xa4xi<yi\xe2\x89\xa4p) \xe2\x80\x94 the indices of the radio stations mentioned in the ii-th complaint). All complaints are distinct.'
b'Then pp lines follow, which describe the radio stations. Each line contains two integers lili and riri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4M1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4M) \xe2\x80\x94 the constrains on signal power that should be satisfied if the city establishes a contract with the ii-th station.'
b'Then mm lines follow, which describe the pairs of interfering radio stations. Each line contains two integers uiui and vivi (1\xe2\x89\xa4ui<vi\xe2\x89\xa4p1\xe2\x89\xa4ui<vi\xe2\x89\xa4p) \xe2\x80\x94 the indices of interfering radio stations. All these pairs are distinct.'
b'Output'
b'If it is impossible to choose signal power and a set of stations to meet all conditions, print \xe2\x88\x921\xe2\x88\x921.'
b"Otherwise print two integers kk and ff in the first line \xe2\x80\x94 the number of stations in the chosen set and the chosen signal power, respectively. In the second line print kk distinct integers from 11 to pp \xe2\x80\x94 the indices of stations to establish contracts with (in any order). If there are multiple answers, print any of them; you don't have to minimize/maximize the number of chosen stations, and the same applies to signal power."
Tags
2-sat, *2700
