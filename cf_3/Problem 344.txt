b'Polycarp is very fond of playing the game Minesweeper. Recently he found a similar game and there are such rules.'
b'There are mines on the field, for each the coordinates of its location are known (xi,yixi,yi). Each mine has a lifetime in seconds, after which it will explode. After the explosion, the mine also detonates all mines vertically and horizontally at a distance of kk (two perpendicular lines). As a result, we get an explosion on the field in the form of a "plus" symbol (\'+\'). Thus, one explosion can cause new explosions, and so on.'
b'Also, Polycarp can detonate anyone mine every second, starting from zero seconds. After that, a chain reaction of explosions also takes place. Mines explode instantly and also instantly detonate other mines according to the rules described above.'
b'Polycarp wants to set a new record and asks you to help him calculate in what minimum number of seconds all mines can be detonated.'
b'Input'
b'The first line of the input contains an integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104) \xe2\x80\x94 the number of test cases in the test.'
b'An empty line is written in front of each test suite.'
b'Next comes a line that contains integers nn and kk (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105, 0\xe2\x89\xa4k\xe2\x89\xa41090\xe2\x89\xa4k\xe2\x89\xa4109) \xe2\x80\x94 the number of mines and the distance that hit by mines during the explosion, respectively.'
b'Then nn lines follow, the ii-th of which describes the xx and yy coordinates of the ii-th mine and the time until its explosion (\xe2\x88\x92109\xe2\x89\xa4x,y\xe2\x89\xa4109\xe2\x88\x92109\xe2\x89\xa4x,y\xe2\x89\xa4109, 0\xe2\x89\xa4timer\xe2\x89\xa41090\xe2\x89\xa4timer\xe2\x89\xa4109). It is guaranteed that all mines have different coordinates.'
b'It is guaranteed that the sum of the values nn over all test cases in the test does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'Print tt lines, each of the lines must contain the answer to the corresponding set of input data \xc2\xa0\xe2\x80\x94 the minimum number of seconds it takes to explode all the mines.'
Tags
binary search, dfs and similar, dsu, greedy, sortings, *2000
