b'Kilani is playing a game with his friends. This game can be represented as a grid of size n\xc3\x97mn\xc3\x97m, where each cell is either empty or blocked, and every player has one or more castles in some cells (there are no two castles in one cell).'
b"The game is played in rounds. In each round players expand turn by turn: firstly, the first player expands, then the second player expands and so on. The expansion happens as follows: for each castle the player owns now, he tries to expand into the empty cells nearby. The player ii can expand from a cell with his castle to the empty cell if it's possible to reach it in at most sisi (where sisi is player's expansion speed) moves to the left, up, right or down without going through blocked cells or cells occupied by some other player's castle. The player examines the set of cells he can expand to and builds a castle in each of them at once. The turned is passed to the next player after that. "
b'The game ends when no player can make a move. You are given the game field and speed of the expansion for each player. Kilani wants to know for each player how many cells he will control (have a castle their) after the game ends.'
b'Input'
b'The first line contains three integers nn, mm and pp (1\xe2\x89\xa4n,m\xe2\x89\xa410001\xe2\x89\xa4n,m\xe2\x89\xa41000, 1\xe2\x89\xa4p\xe2\x89\xa491\xe2\x89\xa4p\xe2\x89\xa49)\xc2\xa0\xe2\x80\x94 the size of the grid and the number of players.'
b'The second line contains pp integers sisi (1\xe2\x89\xa4s\xe2\x89\xa41091\xe2\x89\xa4s\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the speed of the expansion for every player.'
b"The following nn lines describe the game grid. Each of them consists of mm symbols, where '.' denotes an empty cell, '#' denotes a blocked cell and digit xx (1\xe2\x89\xa4x\xe2\x89\xa4p1\xe2\x89\xa4x\xe2\x89\xa4p) denotes the castle owned by player xx."
b'It is guaranteed, that each player has at least one castle on the grid.'
b'Output'
b'Print pp integers\xc2\xa0\xe2\x80\x94 the number of cells controlled by each player after the game ends.'
Tags
dfs and similar, graphs, implementation, shortest paths, *1900
