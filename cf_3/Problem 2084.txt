b"Donghyun's new social network service (SNS) contains nn users numbered 1,2,\xe2\x80\xa6,n1,2,\xe2\x80\xa6,n. Internally, their network is a tree graph, so there are n\xe2\x88\x921n\xe2\x88\x921 direct connections between each user. Each user can reach every other users by using some sequence of direct connections. From now on, we will denote this primary network as T1T1."
b'To prevent a possible server breakdown, Donghyun created a backup network T2T2, which also connects the same nn users via a tree graph. If a system breaks down, exactly one edge e\xe2\x88\x88T1e\xe2\x88\x88T1 becomes unusable. In this case, Donghyun will protect the edge ee by picking another edge f\xe2\x88\x88T2f\xe2\x88\x88T2, and add it to the existing network. This new edge should make the network be connected again. '
b'Donghyun wants to assign a replacement edge f\xe2\x88\x88T2f\xe2\x88\x88T2 for as many edges e\xe2\x88\x88T1e\xe2\x88\x88T1 as possible. However, since the backup network T2T2 is fragile, f\xe2\x88\x88T2f\xe2\x88\x88T2 can be assigned as the replacement edge for at most one edge in T1T1. With this restriction, Donghyun wants to protect as many edges in T1T1 as possible.'
b'Formally, let E(T)E(T) be an edge set of the tree TT. We consider a bipartite graph with two parts E(T1)E(T1) and E(T2)E(T2). For e\xe2\x88\x88E(T1),f\xe2\x88\x88E(T2)e\xe2\x88\x88E(T1),f\xe2\x88\x88E(T2), there is an edge connecting {e,f}{e,f} if and only if graph T1\xe2\x88\x92{e}+{f}T1\xe2\x88\x92{e}+{f} is a tree. You should find a maximum matching in this bipartite graph.'
b'Input'
b'The first line contains an integer nn (2\xe2\x89\xa4n\xe2\x89\xa42500002\xe2\x89\xa4n\xe2\x89\xa4250000), the number of users. '
b'In the next n\xe2\x88\x921n\xe2\x88\x921 lines, two integers aiai, bibi (1\xe2\x89\xa4ai,bi\xe2\x89\xa4n1\xe2\x89\xa4ai,bi\xe2\x89\xa4n) are given. Those two numbers denote the indices of the vertices connected by the corresponding edge in T1T1.'
b'In the next n\xe2\x88\x921n\xe2\x88\x921 lines, two integers cici, didi (1\xe2\x89\xa4ci,di\xe2\x89\xa4n1\xe2\x89\xa4ci,di\xe2\x89\xa4n) are given. Those two numbers denote the indices of the vertices connected by the corresponding edge in T2T2. '
b'It is guaranteed that both edge sets form a tree of size nn.'
b'Output'
b'In the first line, print the number mm (0\xe2\x89\xa4m<n0\xe2\x89\xa4m<n), the maximum number of edges that can be protected.'
b'In the next mm lines, print four integers ai,bi,ci,diai,bi,ci,di. Those four numbers denote that the edge (ai,bi)(ai,bi) in T1T1 is will be replaced with an edge (ci,di)(ci,di) in T2T2.'
b'All printed edges should belong to their respective network, and they should link to distinct edges in their respective network. If one removes an edge (ai,bi)(ai,bi) from T1T1 and adds edge (ci,di)(ci,di) from T2T2, the network should remain connected. The order of printing the edges or the order of vertices in each edge does not matter.'
b'If there are several solutions, you can print any.'
Tags
data structures, graph matchings, graphs, math, trees, *3200
