b'A forestation is an act of planting a bunch of trees to grow a forest, usually to replace a forest that had been cut down. Strangely enough, graph theorists have another idea on how to make a forest, i.e. by cutting down a tree!'
b'A tree is a graph of NN nodes connected by N\xe2\x88\x921N\xe2\x88\x921 edges. Let uu be a node in a tree UU which degree is at least 22 (i.e. directly connected to at least 22 other nodes in UU). If we remove uu from UU, then we will get two or more disconnected (smaller) trees, or also known as forest by graph theorists. In this problem, we are going to investigate a special forestation of a tree done by graph theorists.'
b'Let V(S)V(S) be the set of nodes in a tree SS and V(T)V(T) be the set of nodes in a tree TT. Tree SS and tree TT are identical if there exists a bijection f:V(S)\xe2\x86\x92V(T)f:V(S)\xe2\x86\x92V(T) such that for all pairs of nodes (si,sj)(si,sj) in V(S)V(S), sisi and sjsj is connected by an edge in SS if and only if node f(si)f(si) and f(sj)f(sj) is connected by an edge in TT. Note that f(s)=tf(s)=t implies node ss in SS corresponds to node tt in TT.'
b'We call a node uu in a tree UU as a good cutting point if and only if the removal of uu from UU causes two or more disconnected trees, and all those disconnected trees are pairwise identical.'
b'Given a tree UU, your task is to determine whether there exists a good cutting point in UU. If there is such a node, then you should output the maximum number of disconnected trees that can be obtained by removing exactly one good cutting point.'
b'For example, consider the following tree of 1313 nodes.'
b''
b'There is exactly one good cutting point in this tree, i.e. node 44. Observe that by removing node 44, we will get three identical trees (in this case, line graphs), i.e. {5,1,7,13}{5,1,7,13}, {8,2,11,6}{8,2,11,6}, and {3,12,9,10}{3,12,9,10}, which are denoted by AA, BB, and CC respectively in the figure. '
b'  The bijection function between AA and BB: f(5)=8f(5)=8, f(1)=2f(1)=2, f(7)=11f(7)=11, and f(13)=6f(13)=6.  The bijection function between AA and CC: f(5)=3f(5)=3, f(1)=12f(1)=12, f(7)=9f(7)=9, and f(13)=10f(13)=10.  The bijection function between BB and CC: f(8)=3f(8)=3, f(2)=12f(2)=12, f(11)=9f(11)=9, and f(6)=10f(6)=10. '
b' Of course, there exists other bijection functions for those trees.'
b'Input'
b'Input begins with a line containting an integer: NN (3\xe2\x89\xa4N\xe2\x89\xa440003\xe2\x89\xa4N\xe2\x89\xa44000) representing the number of nodes in the given tree. The next N\xe2\x88\x921N\xe2\x88\x921 lines each contains two integers: aiai bibi (1\xe2\x89\xa4ai<bi\xe2\x89\xa4N1\xe2\x89\xa4ai<bi\xe2\x89\xa4N) representing an edge (ai,bi)(ai,bi) in the given tree. It is guaranteed that any two nodes in the given tree are connected to each other by a sequence of edges.'
b'Output'
b'Output in a line an integer representing the maximum number of disconnected trees that can be obtained by removing exactly one good cutting point, or output -1 if there is no such good cutting point.'
Tags
hashing, trees, *2400
