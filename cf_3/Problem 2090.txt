b'Polycarp has decided to decorate his room because the New Year is soon. One of the main decorations that Polycarp will install is the garland he is going to solder himself.'
b'Simple garlands consisting of several lamps connected by one wire are too boring for Polycarp. He is going to solder a garland consisting of nn lamps and n\xe2\x88\x921n\xe2\x88\x921 wires. Exactly one lamp will be connected to power grid, and power will be transmitted from it to other lamps by the wires. Each wire connectes exactly two lamps; one lamp is called the main lamp for this wire (the one that gets power from some other wire and transmits it to this wire), the other one is called the auxiliary lamp (the one that gets power from this wire). Obviously, each lamp has at most one wire that brings power to it (and this lamp is the auxiliary lamp for this wire, and the main lamp for all other wires connected directly to it).'
b'Each lamp has a brightness value associated with it, the ii-th lamp has brightness 2i2i. We define the importance of the wire as the sum of brightness values over all lamps that become disconnected from the grid if the wire is cut (and all other wires are still working).'
b'Polycarp has drawn the scheme of the garland he wants to make (the scheme depicts all nn lamp and n\xe2\x88\x921n\xe2\x88\x921 wires, and the lamp that will be connected directly to the grid is marked; the wires are placed in such a way that the power can be transmitted to each lamp). After that, Polycarp calculated the importance of each wire, enumerated them from 11 to n\xe2\x88\x921n\xe2\x88\x921 in descending order of their importance, and then wrote the index of the main lamp for each wire (in the order from the first wire to the last one).'
b'The following day Polycarp bought all required components of the garland and decided to solder it \xe2\x80\x94 but he could not find the scheme. Fortunately, Polycarp found the list of indices of main lamps for all wires. Can you help him restore the original scheme?'
b'Input'
b'The first line contains one integer nn (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of lamps.'
b'The second line contains n\xe2\x88\x921n\xe2\x88\x921 integers a1a1, a2a2, ..., an\xe2\x88\x921an\xe2\x88\x921 (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n), where aiai is the index of the main lamp for the ii-th wire (wires are numbered in descending order of importance).'
b'Output'
b'If it is impossible to restore the original scheme, print one integer \xe2\x88\x921\xe2\x88\x921.'
b'Otherwise print the scheme as follows. In the first line, print one integer kk (1\xe2\x89\xa4k\xe2\x89\xa4n1\xe2\x89\xa4k\xe2\x89\xa4n) \xe2\x80\x94 the index of the lamp that is connected to the power grid. Then print n\xe2\x88\x921n\xe2\x88\x921 lines, each containing two integers xixi and yiyi (1\xe2\x89\xa4xi,yi\xe2\x89\xa4n1\xe2\x89\xa4xi,yi\xe2\x89\xa4n, xi\xe2\x89\xa0yixi\xe2\x89\xa0yi) \xe2\x80\x94 the indices of the lamps connected by some wire. The descriptions of the wires (and the lamps connected by a wire) can be printed in any order. The printed description must correspond to a scheme of a garland such that Polycarp could have written the list a1a1, a2a2, ..., an\xe2\x88\x921an\xe2\x88\x921 from it. If there are multiple such schemes, output any of them.'
Tags
constructive algorithms, greedy, trees, *2200
