b"Heidi is terrified by your estimate and she found it unrealistic that her friends would collaborate to drive her into debt. She expects that, actually, each person will just pick a random friend to send Heidi to. (This randomness assumption implies, however, that she can now visit the same friend an arbitrary number of times...) Moreover, if a person only has one friend in common with Heidi (i.e., if that person is in a leaf of the tree), then that person will not send Heidi back (so that Heidi's travel will end at some point)."
b'Heidi also found unrealistic the assumption that she can make all the travels in one day. Therefore now she assumes that every time she travels a route between two friends, she needs to buy a new ticket. She wants to know: how much should she expect to spend on the trips?'
b"For what it's worth, Heidi knows that Jenny has at least two friends."
b'Input'
b'The first line contains the number of friends n (3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105). The next n\xe2\x80\x89-\xe2\x80\x891 lines each contain three space-separated integers u, v and c (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89104) meaning that u and v are friends and the cost for traveling between u and v is c (paid every time!).'
b'It is again guaranteed that the social network of the input forms a tree.'
b'Output'
b'Assume that the expected cost of the trips is written as an irreducible fraction a\xe2\x80\x89/\xe2\x80\x89b (that is, a and b are coprime). Then Heidi, the weird cow that she is, asks you to output . (Output a single integer between 0 and 109\xe2\x80\x89+\xe2\x80\x896.)'
Tags
dfs and similar, dp, math, trees, *2400
