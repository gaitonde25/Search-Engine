b'It is the year 2969. 1000 years have passed from the moon landing. Meanwhile, the humanity colonized the Hyperspace\xe2\x84\xa2 and lived in harmony.'
b'Until we realized that we were not alone.'
b"Not too far away from the Earth, the massive fleet of aliens' spaceships is preparing to attack the Earth. For the first time in a while, the humanity is in real danger. Crisis and panic are everywhere. The scientists from all around the solar system have met and discussed the possible solutions. However, no progress has been made."
b"The Earth's last hope is YOU!"
b"Fortunately, the Earth is equipped with very powerful defense systems made by MDCS. There are NN aliens' spaceships which form the line. The defense system consists of three types of weapons: "
b'  SQL rockets \xe2\x80\x93 every SQL rocket can destroy at most one spaceship in the given set. Cognition beams \xe2\x80\x93 every Cognition beam has an interval [l,r][l,r] and can destroy at most one spaceship in that interval. OMG bazooka \xe2\x80\x93 every OMG bazooka has three possible targets, however, each bazooka can destroy either zero or exactly two spaceships. In addition, due to the smart targeting system, the sets of the three possible targets of any two different OMG bazookas are disjoint (that means that every ship is targeted with at most one OMG bazooka). '
b'Your task is to make a plan of the attack which will destroy the largest possible number of spaceships. Every destroyed spaceship should be destroyed with exactly one weapon.'
b'Input'
b'The first line contains two integers: the number of your weapons NN (1\xe2\x89\xa4N\xe2\x89\xa45000)(1\xe2\x89\xa4N\xe2\x89\xa45000) and the number of spaceships MM (1\xe2\x89\xa4M\xe2\x89\xa45000)(1\xe2\x89\xa4M\xe2\x89\xa45000).'
b'In the next NN lines, each line starts with one integer that represents type (either 0, 1 or 2). If the type is 0, then the weapon is SQL rocket, the rest of the line contains strictly positive number KK (\xe2\x88\x91K\xe2\x89\xa4100000)(\xe2\x88\x91K\xe2\x89\xa4100000) and array kiki (1\xe2\x89\xa4ki\xe2\x89\xa4M)(1\xe2\x89\xa4ki\xe2\x89\xa4M) of KK integers. If the type is 1, then the weapon is Cognition beam, the rest of the line contains integers ll and rr (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4M)(1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4M). If the type is 2 then the weapon is OMG bazooka, the rest of the line contains distinct numbers aa, bb and cc (1\xe2\x89\xa4a,b,c\xe2\x89\xa4M)(1\xe2\x89\xa4a,b,c\xe2\x89\xa4M).'
b'Output'
b'The first line should contain the maximum number of destroyed spaceships \xe2\x80\x94 XX.'
b'In the next XX lines, every line should contain two numbers AA and BB, where AA is an index of the weapon and BB is an index of the spaceship which was destroyed by the weapon AA.'
Tags
data structures, flows, graph matchings, graphs, trees, *2500
