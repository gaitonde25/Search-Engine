b'Indiana Jones found ancient Aztec catacombs containing a golden idol. The catacombs consists of nn caves. Each pair of caves is connected with a two-way corridor that can be opened or closed. The entrance to the catacombs is in the cave 11, the idol and the exit are in the cave nn.'
b'When Indiana goes from a cave xx to a cave yy using an open corridor, all corridors connected to the cave xx change their state: all open corridors become closed, all closed corridors become open. Indiana wants to go from cave 11 to cave nn going through as small number of corridors as possible. Help him find the optimal path, or determine that it is impossible to get out of catacombs.'
b'Input'
b'The first line contains two integers nn and mm (2\xe2\x89\xa4n\xe2\x89\xa43\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa43\xe2\x8b\x85105, 0\xe2\x89\xa4m\xe2\x89\xa43\xe2\x8b\x851050\xe2\x89\xa4m\xe2\x89\xa43\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of caves and the number of open corridors at the initial moment.'
b'The next mm lines describe the open corridors. The ii-th of these lines contains two integers uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n, ui\xe2\x89\xa0viui\xe2\x89\xa0vi)\xc2\xa0\xe2\x80\x94 the caves connected by the ii-th open corridor. It is guaranteed that each unordered pair of caves is presented at most once.'
b'Output'
b'If there is a path to exit, in the first line print a single integer kk\xc2\xa0\xe2\x80\x94 the minimum number of corridors Indians should pass through (1\xe2\x89\xa4k\xe2\x89\xa41061\xe2\x89\xa4k\xe2\x89\xa4106). In the second line print k+1k+1 integers x0,\xe2\x80\xa6,xkx0,\xe2\x80\xa6,xk\xc2\xa0\xe2\x80\x94 the number of caves in the order Indiana should visit them. The sequence x0,\xe2\x80\xa6,xkx0,\xe2\x80\xa6,xk should satisfy the following:'
b' x0=1x0=1, xk=nxk=n; for each ii from 11 to kk the corridor from xi\xe2\x88\x921xi\xe2\x88\x921 to xixi should be open at the moment Indiana walks along this corridor.'
b'If there is no path, print a single integer \xe2\x88\x921\xe2\x88\x921.'
b'We can show that if there is a path, there is a path consisting of no more than 106106 corridors.'
Tags
constructive algorithms, *2600
