b'Petya collects beautiful matrix.'
b'A matrix of size n\xc3\x97nn\xc3\x97n is beautiful if: '
b'  All elements of the matrix are integers between 11 and nn;  For every row of the matrix, all elements of this row are different;  For every pair of vertically adjacent elements, these elements are different. '
b'Today Petya bought a beautiful matrix aa of size n\xc3\x97nn\xc3\x97n, and now he wants to determine its rarity.'
b'The rarity of the matrix is its index in the list of beautiful matrices of size n\xc3\x97nn\xc3\x97n, sorted in lexicographical order. Matrix comparison is done row by row. (The index of lexicographically smallest matrix is zero).'
b'Since the number of beautiful matrices may be huge, Petya wants you to calculate the rarity of the matrix aa modulo 998244353998244353.'
b'Input'
b'The first line contains one integer nn (1\xe2\x89\xa4n\xe2\x89\xa420001\xe2\x89\xa4n\xe2\x89\xa42000) \xe2\x80\x94 the number of rows and columns in aa.'
b'Each of the next nn lines contains nn integers ai,jai,j (1\xe2\x89\xa4ai,j\xe2\x89\xa4n1\xe2\x89\xa4ai,j\xe2\x89\xa4n) \xe2\x80\x94 the elements of aa.'
b'It is guaranteed that aa is a beautiful matrix.'
b'Output'
b'Print one integer \xe2\x80\x94 the rarity of matrix aa, taken modulo 998244353998244353.'
Tags
combinatorics, data structures, dp, *2900
