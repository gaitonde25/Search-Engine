b'This is the first subtask of problem F. The only differences between this and the second subtask are the constraints on the value of mm and the time limit. You need to solve both subtasks in order to hack this one.'
b'There are n+1n+1 distinct colours in the universe, numbered 00 through nn. There is a strip of paper mm centimetres long initially painted with colour 00. '
b'Alice took a brush and painted the strip using the following process. For each ii from 11 to nn, in this order, she picks two integers 0\xe2\x89\xa4ai<bi\xe2\x89\xa4m0\xe2\x89\xa4ai<bi\xe2\x89\xa4m, such that the segment [ai,bi][ai,bi] is currently painted with a single colour, and repaints it with colour ii. '
b'Alice chose the segments in such a way that each centimetre is now painted in some colour other than 00. Formally, the segment [i\xe2\x88\x921,i][i\xe2\x88\x921,i] is painted with colour cici (ci\xe2\x89\xa00ci\xe2\x89\xa00). Every colour other than 00 is visible on the strip.'
b'Count the number of different pairs of sequences {ai}ni=1{ai}i=1n, {bi}ni=1{bi}i=1n that result in this configuration. '
b'Since this number may be large, output it modulo 998244353998244353.'
b'Input'
b'The first line contains a two integers nn, mm (1\xe2\x89\xa4n\xe2\x89\xa45001\xe2\x89\xa4n\xe2\x89\xa4500, n=mn=m)\xc2\xa0\xe2\x80\x94 the number of colours excluding the colour 00 and the length of the paper, respectively.'
b'The second line contains mm space separated integers c1,c2,\xe2\x80\xa6,cmc1,c2,\xe2\x80\xa6,cm (1\xe2\x89\xa4ci\xe2\x89\xa4n1\xe2\x89\xa4ci\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the colour visible on the segment [i\xe2\x88\x921,i][i\xe2\x88\x921,i] after the process ends. It is guaranteed that for all jj between 11 and nn there is an index kk such that ck=jck=j.'
b'Note that since in this subtask n=mn=m, this means that cc is a permutation of integers 11 through nn.'
b'Output'
b'Output a single integer\xc2\xa0\xe2\x80\x94 the number of ways Alice can perform the painting, modulo 998244353998244353.'
Tags
combinatorics, dfs and similar, dp, *2200
