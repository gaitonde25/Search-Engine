b'You are given n\xe2\x88\x921n\xe2\x88\x921 integers a2,\xe2\x80\xa6,ana2,\xe2\x80\xa6,an and a tree with nn vertices rooted at vertex 11. The leaves are all at the same distance dd from the root. '
b'Recall that a tree is a connected undirected graph without cycles. The distance between two vertices is the number of edges on the simple path between them. All non-root vertices with degree 11 are leaves. If vertices ss and ff are connected by an edge and the distance of ff from the root is greater than the distance of ss from the root, then ff is called a child of ss.'
b'Initially, there are a red coin and a blue coin on the vertex 11. Let rr be the vertex where the red coin is and let bb be the vertex where the blue coin is. You should make dd moves. A move consists of three steps: '
b'  Move the red coin to any child of rr.  Move the blue coin to any vertex b\xe2\x80\xb2b\xe2\x80\xb2 such that dist(1,b\xe2\x80\xb2)=dist(1,b)+1dist(1,b\xe2\x80\xb2)=dist(1,b)+1. Here dist(x,y)dist(x,y) indicates the length of the simple path between xx and yy. Note that bb and b\xe2\x80\xb2b\xe2\x80\xb2 are not necessarily connected by an edge.  You can optionally swap the two coins (or skip this step). '
b'Note that rr and bb can be equal at any time, and there is no number written on the root.'
b"After each move, you gain |ar\xe2\x88\x92ab||ar\xe2\x88\x92ab| points. What's the maximum number of points you can gain after dd moves?"
b'Input'
b'The first line contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104) \xe2\x80\x94 the number of test cases.'
b'The first line of each test case contains a single integer nn (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of vertices in the tree.'
b'The second line of each test case contains n\xe2\x88\x921n\xe2\x88\x921 integers v2,v3,\xe2\x80\xa6,vnv2,v3,\xe2\x80\xa6,vn (1\xe2\x89\xa4vi\xe2\x89\xa4n1\xe2\x89\xa4vi\xe2\x89\xa4n, vi\xe2\x89\xa0ivi\xe2\x89\xa0i) \xc2\xa0\xe2\x80\x94 the ii-th of them indicates that there is an edge between vertices ii and vivi. It is guaranteed, that these edges form a tree.'
b'The third line of each test case contains n\xe2\x88\x921n\xe2\x88\x921 integers a2,\xe2\x80\xa6,ana2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa41091\xe2\x89\xa4ai\xe2\x89\xa4109) \xe2\x80\x94 the numbers written on the vertices.'
b'It is guaranteed that the sum of nn for all test cases does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each test case, print a single integer: the maximum number of points you can gain after dd moves.'
Tags
dfs and similar, dp, greedy, trees, *2500
