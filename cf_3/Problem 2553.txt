b'We have a magic tree: a rooted tree on nn vertices. The vertices are numbered 11 through nn. Vertex 11 is the root.'
b'The magic tree gives us magic fruit. The fruit only grows in vertices of the tree other than the root. Each vertex contains at most one piece of fruit.'
b'It is now day 0 and no fruit is ripe yet. Each fruit will only be ripe for a single day. For each fruit, we are given the vertex vjvj where it grows, the day djdj on which it will be ripe, and the amount wjwj of magic juice we can extract from it if we harvest it when it is ripe.'
b'The fruits have to be harvested by cutting some branches of the tree. On each day, you may cut as many branches of the tree as you like. The parts of the tree you cut off will fall to the ground and you can collect all the ripe fruits they contain. All fruits that fall to the ground when they are not ripe are discarded and no magic juice is collected from them.'
b'Formally, on each day, you may erase some edges of the tree. Whenever you do so, the tree will split into multiple connected components. You then erase all components that do not contain the root and you harvest all ripe fruits those components contained.'
b'Given is a description of the tree together with the locations, ripening days and juiciness of all mm fruits. Calculate the maximum total amount of magic juice we can harvest from the tree.'
b'Input'
b'The first line contains three space-separated integers nn (2\xe2\x89\xa4n\xe2\x89\xa4100,0002\xe2\x89\xa4n\xe2\x89\xa4100,000), mm (1\xe2\x89\xa4m\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4m\xe2\x89\xa4n\xe2\x88\x921) and kk (1\xe2\x89\xa4k\xe2\x89\xa4100,0001\xe2\x89\xa4k\xe2\x89\xa4100,000) \xe2\x80\x93 the number of vertices, the number of fruits, and the maximum day on which a fruit may become ripe.'
b'The following n\xe2\x88\x921n\xe2\x88\x921 lines contain the integers p2,\xe2\x80\xa6,pnp2,\xe2\x80\xa6,pn, one per line. For each ii (from 22 to nn, inclusive), vertex pipi (1\xe2\x89\xa4pi\xe2\x89\xa4i\xe2\x88\x9211\xe2\x89\xa4pi\xe2\x89\xa4i\xe2\x88\x921) is the parent of vertex ii.'
b'Each of the last mm lines describes one fruit. The jj-th of these lines has the form "vj\xc2\xa0dj\xc2\xa0wjvj\xc2\xa0dj\xc2\xa0wj" (2\xe2\x89\xa4vj\xe2\x89\xa4n2\xe2\x89\xa4vj\xe2\x89\xa4n, 1\xe2\x89\xa4dj\xe2\x89\xa4k1\xe2\x89\xa4dj\xe2\x89\xa4k, 1\xe2\x89\xa4wj\xe2\x89\xa41091\xe2\x89\xa4wj\xe2\x89\xa4109).'
b'It is guaranteed that no vertex contains more than one fruit (i.e., the values vjvj are distinct).'
b'Output'
b'Output a single line with a single integer, the maximum amount of magic juice we can harvest from the tree.'
Tags
*special problem, data structures, dp, trees
