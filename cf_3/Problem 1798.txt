b"That's right. I'm a Purdue student, and I shamelessly wrote a problem about trains."
b'There are nn stations and mm trains. The stations are connected by n\xe2\x88\x921n\xe2\x88\x921 one-directional railroads that form a tree rooted at station 11. All railroads are pointed in the direction from the root station 11 to the leaves. A railroad connects a station uu to a station vv, and has a distance dd, meaning it takes dd time to travel from uu to vv. Each station with at least one outgoing railroad has a switch that determines the child station an incoming train will be directed toward. For example, it might look like this:'
b'  Here, stations 11 and 33 have switches directed toward stations 22 and 44, respectively. '
b'Initially, no trains are at any station. Train ii will enter station 11 at time titi. Every unit of time, starting at time 11, the following two steps happen:'
b"  You can switch at most one station to point to a different child station. A switch change takes effect before step 22.  For every train that is on a station uu, it is directed toward the station vv indicated by uu's switch. So, if the railroad from uu to vv has distance dd, the train will enter station vv in dd units of time from now. "
b'Every train has a destination station sisi. When it enters sisi, it will stop there permanently. If at some point the train is going in the wrong direction, so that it will never be able to reach sisi no matter where the switches point, it will immediately explode.'
b'Find the latest possible time of the first explosion if you change switches optimally, or determine that you can direct every train to its destination so that no explosion occurs. Also, find the minimum number of times you need to change a switch to achieve this.'
b'Input'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n,m\xe2\x89\xa41051\xe2\x89\xa4n,m\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of stations and trains, respectively.'
b'The next n\xe2\x88\x921n\xe2\x88\x921 lines describe the railroads. The ii-th line contains three integers u,v,du,v,d (1\xe2\x89\xa4u,v\xe2\x89\xa4n1\xe2\x89\xa4u,v\xe2\x89\xa4n, 1\xe2\x89\xa4d\xe2\x89\xa41091\xe2\x89\xa4d\xe2\x89\xa4109), denoting a railroad from station uu to station vv with distance dd. It is guaranteed that the railroads form a tree rooted at station 11. The switch of a station uu is initially directed towards the last outgoing railroad from uu that appears in the input.'
b'The next mm lines describe the trains. The ii-th line contains two integers si,tisi,ti (1\xe2\x89\xa4si\xe2\x89\xa4n1\xe2\x89\xa4si\xe2\x89\xa4n, 1\xe2\x89\xa4t1<t2<\xe2\x8b\xaf<tm\xe2\x89\xa41091\xe2\x89\xa4t1<t2<\xe2\x8b\xaf<tm\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the destination station and the time the ii-th train enters station 11, respectively.'
b'Output'
b'Output two integers: the latest possible time of the first explosion (or \xe2\x88\x921\xe2\x88\x921 if it is possible to never have an explosion) and the minimum number of switch changes to achieve it.'
Tags
data structures, trees, *3100
