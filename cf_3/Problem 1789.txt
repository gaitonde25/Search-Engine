b"You're at the last mission in one very old and very popular strategy game Dune II: Battle For Arrakis. The map of the mission can be represented as a rectangular matrix of size n\xc3\x97mn\xc3\x97m. Initially, there are ai,jai,j units of your army in the cell (i,j)(i,j)."
b'You want to prepare for the final battle, so you want to move all your army into exactly one cell of the map (i.e. nm\xe2\x88\x921nm\xe2\x88\x921 cells should contain 00 units of the army and the remaining cell should contain the entire army).'
b'To do this, you can do some (possibly, zero) number of moves. During one move, you can select exactly one unit from some cell and move it to one of the adjacent by side cells. I.e. from the cell (i,j)(i,j) you can move the unit to cells:'
b'  (i\xe2\x88\x921,j)(i\xe2\x88\x921,j);  (i,j\xe2\x88\x921)(i,j\xe2\x88\x921);  (i+1,j)(i+1,j);  (i,j+1)(i,j+1). '
b'Of course, you want to move all your army into exactly one cell as fast as possible. So, you want to know the minimum number of moves you need to do that.'
b'And, of course, life goes on, so the situation on the map changes. There are qq updates, the ii-th update is denoted by three integers x,y,zx,y,z. This update affects the army in the cell (x,y)(x,y): after this update, the number of units in the cell (x,y)(x,y) becomes zz (i.e. you replace ax,yax,y with zz).'
b'Also, you want to determine, for each ii, the minimum number of moves needed to move your entire army into exactly one cell with the first ii updates applied to the initial map. In other words, the map after the ii-th update equals the initial map with the first ii updates applied to it.'
b'Input'
b'The first line of the input contains three integers n,mn,m and qq (1\xe2\x89\xa4n,m\xe2\x89\xa41000;1\xe2\x89\xa4q\xe2\x89\xa450001\xe2\x89\xa4n,m\xe2\x89\xa41000;1\xe2\x89\xa4q\xe2\x89\xa45000)\xc2\xa0\xe2\x80\x94 the size of the matrix and the number of updates correspondingly.'
b'The next nn lines contain mm integers each, where the jj-th integer in the ii-th line is ai,jai,j (1\xe2\x89\xa4ai,j\xe2\x89\xa41091\xe2\x89\xa4ai,j\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the number of units in the cell (i,j)(i,j).'
b'The next qq lines contain three integers each, where the ii-th line contains three integers xi,yixi,yi and zizi (1\xe2\x89\xa4xi\xe2\x89\xa4n;1\xe2\x89\xa4yi\xe2\x89\xa4m;1\xe2\x89\xa4zi\xe2\x89\xa41091\xe2\x89\xa4xi\xe2\x89\xa4n;1\xe2\x89\xa4yi\xe2\x89\xa4m;1\xe2\x89\xa4zi\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the cell in which the number of units updates and the new number of units in this cell correspondingly.'
b'Output'
b'Print q+1q+1 integers r0,r1,r2,\xe2\x80\xa6,rnr0,r1,r2,\xe2\x80\xa6,rn, where r0r0 is the minimum number of moves you need to move all your army into exactly one cell, and riri for all ii from 11 to qq is the minimum number of moves you need to move all your army into exactly one cell after the first ii updates.'
Tags
*special problem, data structures, greedy, math, *2000
