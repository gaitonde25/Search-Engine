b'You have a grid GG containing RR rows (numbered from 11 to RR, top to bottom) and CC columns (numbered from 11 to CC, left to right) of uppercase characters. The character in the rthrth row and the cthcth column is denoted by Gr,cGr,c. You also have QQ strings containing uppercase characters. For each of the string, you want to find the number of occurrences of the string in the grid.'
b'An occurrence of string SS in the grid is counted if SS can be constructed by starting at one of the cells in the grid, going right 00 or more times, and then going down 00 or more times. Two occurrences are different if the set of cells used to construct the string is different. Formally, for each string SS, you would like to count the number of tuples \xe2\x9f\xa8r,c,\xce\x94r,\xce\x94c\xe2\x9f\xa9\xe2\x9f\xa8r,c,\xce\x94r,\xce\x94c\xe2\x9f\xa9 such that: '
b'  1\xe2\x89\xa4r\xe2\x89\xa4R1\xe2\x89\xa4r\xe2\x89\xa4R and r\xe2\x89\xa4r+\xce\x94r\xe2\x89\xa4Rr\xe2\x89\xa4r+\xce\x94r\xe2\x89\xa4R  1\xe2\x89\xa4c\xe2\x89\xa4C1\xe2\x89\xa4c\xe2\x89\xa4C and c\xe2\x89\xa4c+\xce\x94c\xe2\x89\xa4Cc\xe2\x89\xa4c+\xce\x94c\xe2\x89\xa4C  S=Gr,cGr,c+1\xe2\x80\xa6Gr,c+\xce\x94cGr+1,c+\xce\x94c\xe2\x80\xa6Gr+\xce\x94r,c+\xce\x94cS=Gr,cGr,c+1\xe2\x80\xa6Gr,c+\xce\x94cGr+1,c+\xce\x94c\xe2\x80\xa6Gr+\xce\x94r,c+\xce\x94c '
b'Input'
b'Input begins with a line containing three integers: RR CC QQ (1\xe2\x89\xa4R,C\xe2\x89\xa45001\xe2\x89\xa4R,C\xe2\x89\xa4500; 1\xe2\x89\xa4Q\xe2\x89\xa42000001\xe2\x89\xa4Q\xe2\x89\xa4200000) representing the size of the grid and the number of strings, respectively. The next RR lines each contains CC uppercase characters representing the grid. The cthcth character on the rthrth line is Gr,cGr,c. The next QQ lines each contains a string SS containing uppercase characters. The length of this string is a positive integer not more than 200000200000. The sum of the length of all QQ strings combined is not more than 200000200000.'
b'Output'
b'For each query in the same order as input, output in a line an integer representing the number of occurrences of the string in the grid.'
Tags
data structures, dp, strings, trees, *3000
