b'On a chessboard with a width of 109109 and a height of 109109, the rows are numbered from bottom to top from 11 to 109109, and the columns are numbered from left to right from 11 to 109109. Therefore, for each cell of the chessboard you can assign the coordinates (x,y)(x,y), where xx is the column number and yy is the row number.'
b"Every day there are fights between black and white pieces on this board. Today, the black ones won, but at what price? Only the rook survived, and it was driven into the lower left corner\xc2\xa0\xe2\x80\x94 a cell with coordinates (1,1)(1,1). But it is still happy, because the victory has been won and it's time to celebrate it! In order to do this, the rook needs to go home, namely\xc2\xa0\xe2\x80\x94 on the upper side of the field (that is, in any cell that is in the row with number 109109)."
b'Everything would have been fine, but the treacherous white figures put spells on some places of the field before the end of the game. There are two types of spells: '
b'  Vertical. Each of these is defined by one number xx. Such spells create an infinite blocking line between the columns xx and x+1x+1.  Horizontal. Each of these is defined by three numbers x1x1, x2x2, yy. Such spells create a blocking segment that passes through the top side of the cells, which are in the row yy and in columns from x1x1 to x2x2 inclusive. The peculiarity of these spells is that it is impossible for a certain pair of such spells to have a common point. Note that horizontal spells can have common points with vertical spells. '
b'  '
b' An example of a chessboard. '
b"Let's recall that the rook is a chess piece that in one move can move to any point that is in the same row or column with its initial position. In our task, the rook can move from the cell (r0,c0)(r0,c0) into the cell (r1,c1)(r1,c1) only under the condition that r1=r0r1=r0 or c1=c0c1=c0 and there is no blocking lines or blocking segments between these cells (For better understanding, look at the samples)."
b'Fortunately, the rook can remove spells, but for this it has to put tremendous efforts, therefore, it wants to remove the minimum possible number of spells in such way, that after this it can return home. Find this number!'
b'Input'
b'The first line contains two integers nn and mm (0\xe2\x89\xa4n,m\xe2\x89\xa41050\xe2\x89\xa4n,m\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of vertical and horizontal spells.'
b'Each of the following nn lines contains one integer xx (1\xe2\x89\xa4x<1091\xe2\x89\xa4x<109)\xc2\xa0\xe2\x80\x94 the description of the vertical spell. It will create a blocking line between the columns of xx and x+1x+1.'
b'Each of the following mm lines contains three integers x1x1, x2x2 and yy (1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa41091\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4109, 1\xe2\x89\xa4y<1091\xe2\x89\xa4y<109)\xc2\xa0\xe2\x80\x94 the numbers that describe the horizontal spell. It will create a blocking segment that passes through the top sides of the cells that are in the row with the number yy, in columns from x1x1 to x2x2 inclusive.'
b'It is guaranteed that all spells are different, as well as the fact that for each pair of horizontal spells it is true that the segments that describe them do not have common points.'
b'Output'
b'In a single line print one integer\xc2\xa0\xe2\x80\x94 the minimum number of spells the rook needs to remove so it can get from the cell (1,1)(1,1) to at least one cell in the row with the number 109109'
Tags
binary search, two pointers, *1700
