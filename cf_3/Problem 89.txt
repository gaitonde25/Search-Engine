b'Leslie and Leon entered a labyrinth. The labyrinth consists of nn halls and mm one-way passages between\xc2\xa0them. The halls are numbered from 11 to nn.'
b'Leslie and Leon start their journey in the hall ss. Right away, they quarrel and decide to explore the\xc2\xa0labyrinth separately. However, they want to meet again at the end of their journey.'
b"To help Leslie and Leon, your task is to find two different paths from the given hall ss to some other hall tt, such that these two paths do not share halls other than the staring hall ss and the ending hall tt. The\xc2\xa0hall\xc2\xa0tt has not been determined yet, so you can choose any of the labyrinth's halls as tt except ss."
b"Leslie's and Leon's paths do not have to be the shortest ones, but their paths must be simple, visiting any hall at most once. Also, they cannot visit any common halls except ss and tt during their journey, even at different times."
b'Input'
b'The first line contains three integers nn, mm, and ss, where nn\xc2\xa0(2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) is the number of vertices, mm\xc2\xa0(0\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x851050\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x85105) is the number of edges in the labyrinth, and ss\xc2\xa0(1\xe2\x89\xa4s\xe2\x89\xa4n1\xe2\x89\xa4s\xe2\x89\xa4n) is the starting hall.'
b'Then mm lines with descriptions of passages follow. Each description contains two integers uiui,\xc2\xa0vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n; ui\xe2\x89\xa0viui\xe2\x89\xa0vi), denoting a passage from the hall uiui to the hall vivi. The passages are one-way. Each tuple (ui,vi)(ui,vi) is present in the input at most once. The labyrinth can contain cycles and is not necessarily connected in any way.'
b'Output'
b'If it is possible to find the desired two paths, output "Possible", otherwise output "Impossible".'
b'If the answer exists, output two path descriptions. Each description occupies two lines. The first line of the description contains an integer hh (2\xe2\x89\xa4h\xe2\x89\xa4n2\xe2\x89\xa4h\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the number of halls in a path, and the second line contains distinct integers w1,w2,\xe2\x80\xa6,whw1,w2,\xe2\x80\xa6,wh (w1=sw1=s; 1\xe2\x89\xa4wj\xe2\x89\xa4n1\xe2\x89\xa4wj\xe2\x89\xa4n; wh=twh=t)\xc2\xa0\xe2\x80\x94 the halls in the path in the order of passing. Both paths must end at the same vertex tt. The paths must be different, and all intermediate halls in these paths must be distinct.'
Tags
dfs and similar, graphs, *1800
