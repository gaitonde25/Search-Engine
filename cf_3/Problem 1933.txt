b'Nash designed an interesting yet simple board game where a player is simply required to follow instructions written on the cell where the player currently stands. '
b'This board game is played on the n\xc3\x97nn\xc3\x97n board. Rows and columns of this board are numbered from 11 to nn. The cell on the intersection of the rr-th row and cc-th column is denoted by (r,c)(r,c).'
b"Some cells on the board are called blocked zones. On each cell of the board, there is written one of the following 55 characters \xc2\xa0\xe2\x80\x94 UU, DD, LL, RR or XX \xc2\xa0\xe2\x80\x94 instructions for the player. Suppose that the current cell is (r,c)(r,c). If the character is RR, the player should move to the right cell (r,c+1)(r,c+1), for LL the player should move to the left cell (r,c\xe2\x88\x921)(r,c\xe2\x88\x921), for UU the player should move to the top cell (r\xe2\x88\x921,c)(r\xe2\x88\x921,c), for DD the player should move to the bottom cell (r+1,c)(r+1,c). Finally, if the character in the cell is XX, then this cell is the blocked zone. The player should remain in this cell (the game for him isn't very interesting from now on)."
b'It is guaranteed that the characters are written in a way that the player will never have to step outside of the board, no matter at which cell he starts.'
b'As a player starts from a cell, he moves according to the character in the current cell. The player keeps moving until he lands in a blocked zone. It is also possible that the player will keep moving infinitely long.'
b'For every of the n2n2 cells of the board Alice, your friend, wants to know, how will the game go, if the player starts in this cell. For each starting cell of the board, she writes down the cell that the player stops at, or that the player never stops at all. She gives you the information she has written: for each cell (r,c)(r,c) she wrote: '
b'  a pair (xx,yy), meaning if a player had started at (r,c)(r,c), he would end up at cell (xx,yy).  or a pair (\xe2\x88\x921\xe2\x88\x921,\xe2\x88\x921\xe2\x88\x921), meaning if a player had started at (r,c)(r,c), he would keep moving infinitely long and would never enter the blocked zone. '
b"It might be possible that Alice is trying to fool you and there's no possible grid that satisfies all the constraints Alice gave you. For the given information Alice provided you, you are required to decipher a possible board, or to determine that such a board doesn't exist. If there exist several different boards that satisfy the provided information, you can find any of them."
b'Input'
b'The first line of the input contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa41031\xe2\x89\xa4n\xe2\x89\xa4103) \xc2\xa0\xe2\x80\x94 the side of the board.'
b'The ii-th of the next nn lines of the input contains 2n2n integers x1,y1,x2,y2,\xe2\x80\xa6,xn,ynx1,y1,x2,y2,\xe2\x80\xa6,xn,yn, where (xj,yj)(xj,yj) (1\xe2\x89\xa4xj\xe2\x89\xa4n,1\xe2\x89\xa4yj\xe2\x89\xa4n1\xe2\x89\xa4xj\xe2\x89\xa4n,1\xe2\x89\xa4yj\xe2\x89\xa4n, or (xj,yj)=(\xe2\x88\x921,\xe2\x88\x921)(xj,yj)=(\xe2\x88\x921,\xe2\x88\x921)) is the pair written by Alice for the cell (i,j)(i,j). '
b'Output'
b"If there doesn't exist a board satisfying the information that Alice gave you, print a single line containing INVALID. "
b'Otherwise, in the first line print VALID. In the ii-th of the next nn lines, print the string of nn characters, corresponding to the characters in the ii-th row of the suitable board you found. Each character of a string can either be UU, DD, LL, RR or XX. If there exist several different boards that satisfy the provided information, you can find any of them.'
Tags
constructive algorithms, dfs and similar, graphs, implementation, *2000
