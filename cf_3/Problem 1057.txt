b'Ivan wants to have a good dinner. A good dinner should consist of a first course, a second course, a drink, and a dessert.'
b'There are n1n1 different types of first courses Ivan can buy (the ii-th of them costs aiai coins), n2n2 different types of second courses (the ii-th of them costs bibi coins), n3n3 different types of drinks (the ii-th of them costs cici coins) and n4n4 different types of desserts (the ii-th of them costs didi coins).'
b"Some dishes don't go well with each other. There are m1m1 pairs of first courses and second courses that don't go well with each other, m2m2 pairs of second courses and drinks, and m3m3 pairs of drinks and desserts that don't go well with each other."
b'Ivan wants to buy exactly one first course, one second course, one drink, and one dessert so that they go well with each other, and the total cost of the dinner is the minimum possible. Help him to find the cheapest dinner option!'
b'Input'
b'The first line contains four integers n1n1, n2n2, n3n3 and n4n4 (1\xe2\x89\xa4ni\xe2\x89\xa41500001\xe2\x89\xa4ni\xe2\x89\xa4150000) \xe2\x80\x94 the number of types of first courses, second courses, drinks and desserts, respectively.'
b'Then four lines follow. The first line contains n1n1 integers a1,a2,\xe2\x80\xa6,an1a1,a2,\xe2\x80\xa6,an1 (1\xe2\x89\xa4ai\xe2\x89\xa41081\xe2\x89\xa4ai\xe2\x89\xa4108), where aiai is the cost of the ii-th type of first course. Three next lines denote the costs of second courses, drinks, and desserts in the same way (1\xe2\x89\xa4bi,ci,di\xe2\x89\xa41081\xe2\x89\xa4bi,ci,di\xe2\x89\xa4108).'
b"The next line contains one integer m1m1 (0\xe2\x89\xa4m1\xe2\x89\xa42000000\xe2\x89\xa4m1\xe2\x89\xa4200000)\xc2\xa0\xe2\x80\x94 the number of pairs of first and second courses that don't go well with each other. Each of the next m1m1 lines contains two integers xixi and yiyi (1\xe2\x89\xa4xi\xe2\x89\xa4n11\xe2\x89\xa4xi\xe2\x89\xa4n1; 1\xe2\x89\xa4yi\xe2\x89\xa4n21\xe2\x89\xa4yi\xe2\x89\xa4n2) denoting that the first course number xixi doesn't go well with the second course number yiyi. All these pairs are different."
b"The block of pairs of second dishes and drinks that don't go well with each other is given in the same format. The same for pairs of drinks and desserts that don't go well with each other (0\xe2\x89\xa4m2,m3\xe2\x89\xa42000000\xe2\x89\xa4m2,m3\xe2\x89\xa4200000)."
b'Output'
b"If it's impossible to choose a first course, a second course, a drink, and a dessert so that they go well with each other, print \xe2\x88\x921\xe2\x88\x921. Otherwise, print one integer\xc2\xa0\xe2\x80\x94 the minimum total cost of the dinner."
Tags
brute force, data structures, graphs, greedy, implementation, sortings, two pointers, *2000
