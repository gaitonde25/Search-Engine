b'There are nn cities and mm bidirectional roads in Berland. The ii-th road connects the cities xixi and yiyi, and has the speed limit sisi. The road network allows everyone to get from any city to any other city. '
b'The Berland Transport Ministry is planning a road reform.'
b'First of all, maintaining all mm roads is too costly, so m\xe2\x88\x92(n\xe2\x88\x921)m\xe2\x88\x92(n\xe2\x88\x921) roads will be demolished in such a way that the remaining (n\xe2\x88\x921)(n\xe2\x88\x921) roads still allow to get to any city from any other city. Formally, the remaining roads should represent an undirected tree.'
b'Secondly, the speed limits on the remaining roads might be changed. The changes will be done sequentially, each change is either increasing the speed limit on some road by 11, or decreasing it by 11. Since changing the speed limit requires a lot of work, the Ministry wants to minimize the number of changes.'
b'The goal of the Ministry is to have a road network of (n\xe2\x88\x921)(n\xe2\x88\x921) roads with the maximum speed limit over all roads equal to exactly kk. They assigned you the task of calculating the minimum number of speed limit changes they have to perform so the road network meets their requirements.'
b'For example, suppose the initial map of Berland looks like that, and k=7k=7:'
b'  '
b'Then one of the optimal courses of action is to demolish the roads 11\xe2\x80\x9344 and 33\xe2\x80\x9344, and then decrease the speed limit on the road 22\xe2\x80\x9333 by 11, so the resulting road network looks like that:'
b'  '
b'Input'
b'The first line contains one integer tt (1\xe2\x89\xa4t\xe2\x89\xa410001\xe2\x89\xa4t\xe2\x89\xa41000) \xe2\x80\x94 the number of test cases.'
b'The first line of each test case contains three integers nn, mm and kk (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105; n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa4min(2\xe2\x8b\x85105,n(n\xe2\x88\x921)2)n\xe2\x88\x921\xe2\x89\xa4m\xe2\x89\xa4min(2\xe2\x8b\x85105,n(n\xe2\x88\x921)2); 1\xe2\x89\xa4k\xe2\x89\xa41091\xe2\x89\xa4k\xe2\x89\xa4109) \xe2\x80\x94 the number of cities, the number of roads and the required maximum speed limit, respectively.'
b'Then mm lines follow. The ii-th line contains three integers xixi, yiyi and sisi (1\xe2\x89\xa4xi,yi\xe2\x89\xa4n1\xe2\x89\xa4xi,yi\xe2\x89\xa4n; xi\xe2\x89\xa0yixi\xe2\x89\xa0yi; 1\xe2\x89\xa4si\xe2\x89\xa41091\xe2\x89\xa4si\xe2\x89\xa4109) \xe2\x80\x94 the cities connected by the ii-th road and the speed limit on it, respectively. All roads are bidirectional.'
b'The road network in each test case is connected (that is, it is possible to reach any city from any other city by traveling along the road), and each pair of cities is connected by at most one road.'
b'The sum of nn over all test cases does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105. Similarly, the sum of mm over all test cases does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each test case, print one integer \xe2\x80\x94 the minimum number of changes the Ministry has to perform so that the maximum speed limit among the remaining (n\xe2\x88\x921)(n\xe2\x88\x921) roads is exactly kk.'
Tags
dsu, graphs, greedy, *1800
