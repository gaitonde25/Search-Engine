b'The second semester starts at the University of Pavlopolis. After vacation in Vi\xc4\x8dkopolis Noora needs to return to Pavlopolis and continue her study.'
b"Sometimes (or quite often) there are teachers who do not like you. Incidentally Noora also has one such teacher. His name is Yury Dmitrievich and he teaches graph theory. Yury Dmitrievich doesn't like Noora, so he always gives the girl the most difficult tasks. So it happened this time."
b"The teacher gives Noora a tree with n vertices. Vertices are numbered with integers from 1 to n. The length of all the edges of this tree is 1. Noora chooses a set of simple paths that pairwise don't intersect in edges. However each vertex should belong to at least one of the selected path."
b'For each of the selected paths, the following is done:'
b'  We choose exactly one edge (u,\xe2\x80\x89v) that belongs to the path.  On the selected edge (u,\xe2\x80\x89v) there is a point at some selected distance x from the vertex u and at distance 1\xe2\x80\x89-\xe2\x80\x89x from vertex v. But the distance x chosen by Noora arbitrarily, i. e. it can be different for different edges.  One of the vertices u or v is selected. The point will start moving to the selected vertex. '
b'Let us explain how the point moves by example. Suppose that the path consists of two edges (v1,\xe2\x80\x89v2) and (v2,\xe2\x80\x89v3), the point initially stands on the edge (v1,\xe2\x80\x89v2) and begins its movement to the vertex v1. Then the point will reach v1, then "turn around", because the end of the path was reached, further it will move in another direction to vertex v2, then to vertex v3, then "turn around" again, then move to v2 and so on. The speed of the points is 1 edge per second. For example, for 0.5 second the point moves to the length of the half of an edge.'
b'A stopwatch is placed at each vertex of the tree. The time that the stopwatches indicate at start time is 0 seconds. Then at the starting moment of time, all points simultaneously start moving from the selected positions to selected directions along the selected paths, and stopwatches are simultaneously started. When one of the points reaches the vertex v, the stopwatch at the vertex v is automatically reset, i.e. it starts counting the time from zero.'
b'Denote by resv the maximal time that the stopwatch at the vertex v will show if the point movement continues infinitely. Noora is asked to select paths and points on them so that res1 is as minimal as possible. If there are several solutions to do this, it is necessary to minimize res2, then res3, res4,\xe2\x80\x89...,\xe2\x80\x89resn.'
b"Help Noora complete the teacher's task."
b'For the better understanding of the statement, see the explanation for the example.'
b'Input'
b'The first line contains single integer n (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89100) \xe2\x80\x94 number of vertices in the given tree.'
b'Each of next n\xe2\x80\x89-\xe2\x80\x891 lines contains two integers u and v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v) \xe2\x80\x94 vertices connected by an edge.'
b'Guaranteed that input defines a valid tree.'
b'Output'
b'In the first line print single integer paths \xe2\x80\x94 number of paths you want to choose.'
b"In the next paths lines print path's descriptions:"
b'  Single integer len \xe2\x80\x94 number of edges in the current path.  len integers \xe2\x80\x94 indices of the edges in the path. The edges are numbered from 1 to n\xe2\x80\x89-\xe2\x80\x891 in order they are given in input.  Two integers u and v \xe2\x80\x94 means that you put point on the edge between vertices u and v (obviously the edge should belong to the path) and a point will start moving to the vertex v. Note that order of printing of the edge\'s ends is important. For example if you print "1 2" (without quotes), then point will start moving to vertex 2; but if you print "2 1" (without quotes), then point will start moving to vertex 1.  Single real number x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891) \xe2\x80\x94 distance between point and vertex u (the same vertex that you print first in the third paragraph). '
Tags
constructive algorithms, dfs and similar, trees, *2500
