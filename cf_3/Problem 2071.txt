b'Fedya has a string SS, initially empty, and an array WW, also initially empty.'
b'There are nn queries to process, one at a time. Query ii consists of a lowercase English letter cici and a nonnegative integer wiwi. First, cici must be appended to SS, and wiwi must be appended to WW. The answer to the query is the sum of suspiciousnesses for all subsegments of WW [L,\xc2\xa0R][L,\xc2\xa0R], (1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4i)(1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4i).'
b'We define the suspiciousness of a subsegment as follows: if the substring of SS corresponding to this subsegment (that is, a string of consecutive characters from LL-th to RR-th, inclusive) matches the prefix of SS of the same length (that is, a substring corresponding to the subsegment [1,\xc2\xa0R\xe2\x88\x92L+1][1,\xc2\xa0R\xe2\x88\x92L+1]), then its suspiciousness is equal to the minimum in the array WW on the [L,\xc2\xa0R][L,\xc2\xa0R] subsegment. Otherwise, in case the substring does not match the corresponding prefix, the suspiciousness is 00.'
b'Help Fedya answer all the queries before the orderlies come for him!'
b'Input'
b'The first line contains an integer nn (1\xe2\x89\xa4n\xe2\x89\xa4600000)(1\xe2\x89\xa4n\xe2\x89\xa4600000)\xc2\xa0\xe2\x80\x94 the number of queries.'
b'The ii-th of the following nn lines contains the query ii: a lowercase letter of the Latin alphabet cici and an integer wiwi (0\xe2\x89\xa4wi\xe2\x89\xa4230\xe2\x88\x921)(0\xe2\x89\xa4wi\xe2\x89\xa4230\xe2\x88\x921).'
b'All queries are given in an encrypted form. Let ansans be the answer to the previous query (for the first query we set this value equal to 00). Then, in order to get the real query, you need to do the following: perform a cyclic shift of cici in the alphabet forward by ansans, and set wiwi equal to wi\xe2\x8a\x95(ans\xc2\xa0&\xc2\xa0MASK)wi\xe2\x8a\x95(ans\xc2\xa0&\xc2\xa0MASK), where \xe2\x8a\x95\xe2\x8a\x95 is the bitwise exclusive "or", && is the bitwise "and", and MASK=230\xe2\x88\x921MASK=230\xe2\x88\x921.'
b'Output'
b'Print nn lines, ii-th line should contain a single integer \xe2\x80\x94 the answer to the ii-th query.'
Tags
data structures, strings, *3200
