b'You are managing a mobile phone network, and want to offer competitive prices to connect a network.'
b'The network has nn nodes.'
b'Your competitor has already offered some connections between some nodes, with some fixed prices. These connections are bidirectional. There are initially mm connections the competitor is offering. The ii-th connection your competitor is offering will connect nodes faifai and fbifbi and costs fwifwi. '
b'You have a list of kk connections that you want to offer. It is guaranteed that this set of connection does not form any cycle. The jj-th of these connections will connect nodes gajgaj and gbjgbj. These connections are also bidirectional. The cost of these connections have not been decided yet.'
b'You can set the prices of these connections to any arbitrary integer value. These prices are set independently for each connection. After setting the prices, the customer will choose such n\xe2\x88\x921n\xe2\x88\x921 connections that all nodes are connected in a single network and the total cost of chosen connections is minimum possible. If there are multiple ways to choose such networks, the customer will choose an arbitrary one that also maximizes the number of your connections in it.'
b'You want to set prices in such a way such that all your kk connections are chosen by the customer, and the sum of prices of your connections is maximized.'
b'Print the maximum profit you can achieve, or \xe2\x88\x921\xe2\x88\x921 if it is unbounded.'
b'Input'
b'The first line of input will contain three integers nn, kk and mm (1\xe2\x89\xa4n,k,m\xe2\x89\xa45\xe2\x8b\x85105,k\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4n,k,m\xe2\x89\xa45\xe2\x8b\x85105,k\xe2\x89\xa4n\xe2\x88\x921), the number of nodes, the number of your connections, and the number of competitor connections, respectively.'
b'The next kk lines contain two integers gaigai and gbigbi (1\xe2\x89\xa4gai,gbi\xe2\x89\xa4n1\xe2\x89\xa4gai,gbi\xe2\x89\xa4n, gai\xe2\x89\xa0gbigai\xe2\x89\xa0gbi), representing one of your connections between nodes gaigai and gbigbi. Your set of connections is guaranteed to be acyclic.'
b"The next mm lines contain three integers each, faifai, fbifbi and fwifwi (1\xe2\x89\xa4fai,fbi\xe2\x89\xa4n1\xe2\x89\xa4fai,fbi\xe2\x89\xa4n, fai\xe2\x89\xa0fbifai\xe2\x89\xa0fbi, 1\xe2\x89\xa4fwi\xe2\x89\xa41091\xe2\x89\xa4fwi\xe2\x89\xa4109), denoting one of your competitor's connections between nodes faifai and fbifbi with cost fwifwi. None of these connections connects a node to itself, and no pair of these connections connect the same pair of nodes. In addition, these connections are given by non-decreasing order of cost (that is, fwi\xe2\x88\x921\xe2\x89\xa4fwifwi\xe2\x88\x921\xe2\x89\xa4fwi for all valid ii)."
b"Note that there may be some connections that appear in both your set and your competitor's set (though no connection will appear twice in one of this sets)."
b"It is guaranteed that the union of all of your connections and your competitor's connections form a connected network."
b'Output'
b'Print a single integer, the maximum possible profit you can achieve if you set the prices on your connections appropriately. If the profit is unbounded, print \xe2\x88\x921\xe2\x88\x921.'
Tags
dfs and similar, dsu, graphs, trees, *2600
