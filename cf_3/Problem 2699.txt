b'In a magical land there are nn cities conveniently numbered 1,2,\xe2\x80\xa6,n1,2,\xe2\x80\xa6,n. Some pairs of these cities are connected by magical colored roads. Magic is unstable, so at any time, new roads may appear between two cities.'
b'Vicky the witch has been tasked with performing deliveries between some pairs of cities. However, Vicky is a beginner, so she can only complete a delivery if she can move from her starting city to her destination city through a double rainbow. A double rainbow is a sequence of cities c1,c2,\xe2\x80\xa6,ckc1,c2,\xe2\x80\xa6,ck satisfying the following properties:'
b'  For each ii with 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x9211\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x921, the cities cici and ci+1ci+1 are connected by a road.  For each ii with 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x92121\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x9212, the roads connecting c2ic2i with c2i\xe2\x88\x921c2i\xe2\x88\x921 and c2i+1c2i+1 have the same color. '
b'For example if k=5k=5, the road between c1c1 and c2c2 must be the same color as the road between c2c2 and c3c3, and the road between c3c3 and c4c4 must be the same color as the road between c4c4 and c5c5.'
b'Vicky has a list of events in chronological order, where each event is either a delivery she must perform, or appearance of a new road. Help her determine which of her deliveries she will be able to complete.'
b'Input'
b'The first line contains four integers nn, mm, cc, and qq (2\xe2\x89\xa4n\xe2\x89\xa41052\xe2\x89\xa4n\xe2\x89\xa4105, 1\xe2\x89\xa4m,c,q\xe2\x89\xa41051\xe2\x89\xa4m,c,q\xe2\x89\xa4105), denoting respectively the number of cities, the number of roads initially present, the number of different colors the roads can take, and the number of events.'
b'Each of the following mm lines contains three integers xx, yy, and zz (1\xe2\x89\xa4x,y\xe2\x89\xa4n1\xe2\x89\xa4x,y\xe2\x89\xa4n, 1\xe2\x89\xa4z\xe2\x89\xa4c1\xe2\x89\xa4z\xe2\x89\xa4c), describing that there initially exists a bidirectional road with color zz between cities xx and yy.'
b'Then qq lines follow, describing the events. Each event is one of the following two types: '
b'  + x y z (1\xe2\x89\xa4x,y\xe2\x89\xa4n1\xe2\x89\xa4x,y\xe2\x89\xa4n, 1\xe2\x89\xa4z\xe2\x89\xa4c1\xe2\x89\xa4z\xe2\x89\xa4c), meaning a road with color zz appears between cities xx and yy;  ? x y (1\xe2\x89\xa4x,y\xe2\x89\xa4n1\xe2\x89\xa4x,y\xe2\x89\xa4n), meaning you should determine whether Vicky can make a delivery starting at city xx and ending at city yy. It is guaranteed that x\xe2\x89\xa0yx\xe2\x89\xa0y. '
b'It is guaranteed that at any moment, there is at most one road connecting any pair of cities, and that no road connects a city to itself. It is guaranteed that the input contains at least one event of the second type.'
b'Output'
b'For each event of the second type, print a single line containing "Yes" (without quotes) if the delivery can be made, or a single line containing "No" (without quotes) otherwise.'
Tags
data structures, dsu, graphs, hashing, *2400
