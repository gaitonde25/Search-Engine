b'As a teacher, Riko Hakozaki often needs to help her students with problems from various subjects. Today, she is asked a programming task which goes as follows.'
b"You are given an undirected complete graph with nn nodes, where some edges are pre-assigned with a positive weight while the rest aren't. You need to assign all unassigned edges with non-negative weights so that in the resulting fully-assigned complete graph the XOR sum of all weights would be equal to 00."
b'Define the ugliness of a fully-assigned complete graph the weight of its minimum spanning tree, where the weight of a spanning tree equals the sum of weights of its edges. You need to assign the weights so that the ugliness of the resulting graph is as small as possible.'
b'As a reminder, an undirected complete graph with nn nodes contains all edges (u,v)(u,v) with 1\xe2\x89\xa4u<v\xe2\x89\xa4n1\xe2\x89\xa4u<v\xe2\x89\xa4n; such a graph has n(n\xe2\x88\x921)2n(n\xe2\x88\x921)2 edges.'
b'She is not sure how to solve this problem, so she asks you to solve it for her.'
b'Input'
b'The first line contains two integers nn and mm (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105, 0\xe2\x89\xa4m\xe2\x89\xa4min(2\xe2\x8b\x85105,n(n\xe2\x88\x921)2\xe2\x88\x921)0\xe2\x89\xa4m\xe2\x89\xa4min(2\xe2\x8b\x85105,n(n\xe2\x88\x921)2\xe2\x88\x921)) \xc2\xa0\xe2\x80\x94 the number of nodes and the number of pre-assigned edges. The inputs are given so that there is at least one unassigned edge.'
b'The ii-th of the following mm lines contains three integers uiui, vivi, and wiwi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n, u\xe2\x89\xa0vu\xe2\x89\xa0v, 1\xe2\x89\xa4wi<2301\xe2\x89\xa4wi<230), representing the edge from uiui to vivi has been pre-assigned with the weight wiwi. No edge appears in the input more than once.'
b'Output'
b'Print on one line one integer \xc2\xa0\xe2\x80\x94 the minimum ugliness among all weight assignments with XOR sum equal to 00.'
Tags
bitmasks, brute force, data structures, dfs and similar, dsu, graphs, greedy, trees, *2500
