b'There are nn cities in the Kingdom of Autumn, numbered from 11 to nn. People can travel between any two cities using n\xe2\x88\x921n\xe2\x88\x921 two-directional roads.'
b'This year, the government decides to separate the kingdom. There will be regions of different levels. The whole kingdom will be the region of level 11. Each region of ii-th level should be separated into several (at least two) regions of i+1i+1-th level, unless ii-th level is the last level. Each city should belong to exactly one region of each level and for any two cities in the same region, it should be possible to travel between them passing the cities in the same region only.'
b'According to research, for each city ii, there is a value aiai, which describes the importance of this city. All regions of the same level should have an equal sum of city importances.'
b'Your task is to find how many plans there are to determine the separation of the regions that all the conditions are satisfied. Two plans are considered different if and only if their numbers of levels are different or there exist two cities in the same region of one level in one plan but in different regions of this level in the other plan. Since the answer may be very large, output it modulo 109+7109+7.'
b'Input'
b'The first line contains one integer nn (1\xe2\x89\xa4n\xe2\x89\xa41061\xe2\x89\xa4n\xe2\x89\xa4106) \xe2\x80\x94 the number of the cities.'
b'The second line contains nn integers, the ii-th of which is aiai (1\xe2\x89\xa4ai\xe2\x89\xa41091\xe2\x89\xa4ai\xe2\x89\xa4109) \xe2\x80\x94 the value of each city.'
b'The third line contains n\xe2\x88\x921n\xe2\x88\x921 integers, p1,p2,\xe2\x80\xa6,pn\xe2\x88\x921p1,p2,\xe2\x80\xa6,pn\xe2\x88\x921; pipi (pi\xe2\x89\xa4ipi\xe2\x89\xa4i) describes a road between cities pipi and i+1i+1.'
b'Output'
b'Print one integer \xe2\x80\x94 the number of different plans modulo 109+7109+7.'
Tags
combinatorics, dp, number theory, trees, *2700
