b'Rooted tree is a connected graph without any simple cycles with one vertex selected as a root. In this problem the vertex number 1 will always serve as a root.'
b'Lowest common ancestor of two vertices u and v is the farthest from the root vertex that lies on both the path from u to the root and on path from v to the root. We will denote it as LCA(u,\xe2\x80\x89v).'
b"Sandy had a rooted tree consisting of n vertices that she used to store her nuts. Unfortunately, the underwater storm broke her tree and she doesn't remember all it's edges. She only managed to restore m edges of the initial tree and q triples ai, bi and ci, for which she supposes LCA(ai,\xe2\x80\x89bi)\xe2\x80\x89=\xe2\x80\x89ci."
b"Help Sandy count the number of trees of size n with vertex 1 as a root, that match all the information she remembered. If she made a mess and there are no such trees then print 0. Two rooted trees are considered to be distinct if there exists an edge that occur in one of them and doesn't occur in the other one."
b'Input'
b'The first line of the input contains three integers n, m and q (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8913,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89<\xe2\x80\x89n,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89100)\xc2\xa0\xe2\x80\x94 the number of vertices, the number of edges and LCA triples remembered by Sandy respectively.'
b"Each of the next m lines contains two integers ui and vi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ui,\xe2\x80\x89vi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89ui\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89vi)\xc2\xa0\xe2\x80\x94 the numbers of vertices connected by the i-th edge. It's guaranteed that this set of edges is a subset of edges of some tree."
b"The last q lines contain the triplets of numbers ai, bi, ci (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi,\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Each of these triples define LCA(ai,\xe2\x80\x89bi)\xe2\x80\x89=\xe2\x80\x89ci. It's not guaranteed that there exists a tree that satisfy all the given LCA conditions."
b'Output'
b'Print a single integer\xc2\xa0\xe2\x80\x94 the number of trees of size n that satisfy all the conditions.'
Tags
bitmasks, dp, trees, *2600
