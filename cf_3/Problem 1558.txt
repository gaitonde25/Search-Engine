b"You are given a graph consisting of nn vertices and mm edges. It is not guaranteed that the given graph is connected. Some edges are already directed and you can't change their direction. Other edges are undirected and you have to choose some direction for all these edges."
b'You have to direct undirected edges in such a way that the resulting graph is directed and acyclic (i.e. the graph with all edges directed and having no directed cycles). Note that you have to direct all undirected edges.'
b'You have to answer tt independent test cases.'
b'Input'
b'The first line of the input contains one integer tt (1\xe2\x89\xa4t\xe2\x89\xa42\xe2\x8b\x851041\xe2\x89\xa4t\xe2\x89\xa42\xe2\x8b\x85104) \xe2\x80\x94 the number of test cases. Then tt test cases follow.'
b'The first line of the test case contains two integers nn and mm (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105, 1\xe2\x89\xa4m\xe2\x89\xa4min(2\xe2\x8b\x85105,n(n\xe2\x88\x921)2)1\xe2\x89\xa4m\xe2\x89\xa4min(2\xe2\x8b\x85105,n(n\xe2\x88\x921)2)) \xe2\x80\x94 the number of vertices and the number of edges in the graph, respectively.'
b'The next mm lines describe edges of the graph. The ii-th edge is described with three integers titi, xixi and yiyi (ti\xe2\x88\x88[0;1]ti\xe2\x88\x88[0;1], 1\xe2\x89\xa4xi,yi\xe2\x89\xa4n1\xe2\x89\xa4xi,yi\xe2\x89\xa4n) \xe2\x80\x94 the type of the edge (ti=0ti=0 if the edge is undirected and ti=1ti=1 if the edge is directed) and vertices this edge connects (the undirected edge connects vertices xixi and yiyi and directed edge is going from the vertex xixi to the vertex yiyi). It is guaranteed that the graph do not contain self-loops (i.e. edges from the vertex to itself) and multiple edges (i.e. for each pair (xi,yixi,yi) there are no other pairs (xi,yixi,yi) or (yi,xiyi,xi)).'
b'It is guaranteed that both sum nn and sum mm do not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105 (\xe2\x88\x91n\xe2\x89\xa42\xe2\x8b\x85105\xe2\x88\x91n\xe2\x89\xa42\xe2\x8b\x85105; \xe2\x88\x91m\xe2\x89\xa42\xe2\x8b\x85105\xe2\x88\x91m\xe2\x89\xa42\xe2\x8b\x85105).'
b'Output'
b'For each test case print the answer \xe2\x80\x94 "NO" if it is impossible to direct undirected edges in such a way that the resulting graph is directed and acyclic, otherwise print "YES" on the first line and mm lines describing edges of the resulted directed acyclic graph (in any order). Note that you cannot change the direction of the already directed edges. If there are several answers, you can print any.'
Tags
constructive algorithms, dfs and similar, graphs, *2000
