b'You play a strategic video game (yeah, we ran out of good problem legends). In this game you control a large army, and your goal is to conquer nn castles of your opponent.'
b"Let's describe the game process in detail. Initially you control an army of kk warriors. Your enemy controls nn castles; to conquer the ii-th castle, you need at least aiai warriors (you are so good at this game that you don't lose any warriors while taking over a castle, so your army stays the same after the fight). After you take control over a castle, you recruit new warriors into your army \xe2\x80\x94 formally, after you capture the ii-th castle, bibi warriors join your army. Furthermore, after capturing a castle (or later) you can defend it: if you leave at least one warrior in a castle, this castle is considered defended. Each castle has an importance parameter cici, and your total score is the sum of importance values over all defended castles. There are two ways to defend a castle:"
b'  if you are currently in the castle ii, you may leave one warrior to defend castle ii;  there are mm one-way portals connecting the castles. Each portal is characterised by two numbers of castles uu and vv (for each portal holds u>vu>v). A portal can be used as follows: if you are currently in the castle uu, you may send one warrior to defend castle vv. '
b'Obviously, when you order your warrior to defend some castle, he leaves your army.'
b"You capture the castles in fixed order: you have to capture the first one, then the second one, and so on. After you capture the castle ii (but only before capturing castle i+1i+1) you may recruit new warriors from castle ii, leave a warrior to defend castle ii, and use any number of portals leading from castle ii to other castles having smaller numbers. As soon as you capture the next castle, these actions for castle ii won't be available to you."
b"If, during some moment in the game, you don't have enough warriors to capture the next castle, you lose. Your goal is to maximize the sum of importance values over all defended castles (note that you may hire new warriors in the last castle, defend it and use portals leading from it even after you capture it \xe2\x80\x94 your score will be calculated afterwards)."
b'Can you determine an optimal strategy of capturing and defending the castles?'
b'Input'
b'The first line contains three integers nn, mm and kk (1\xe2\x89\xa4n\xe2\x89\xa450001\xe2\x89\xa4n\xe2\x89\xa45000, 0\xe2\x89\xa4m\xe2\x89\xa4min(n(n\xe2\x88\x921)2,3\xe2\x8b\x85105)0\xe2\x89\xa4m\xe2\x89\xa4min(n(n\xe2\x88\x921)2,3\xe2\x8b\x85105), 0\xe2\x89\xa4k\xe2\x89\xa450000\xe2\x89\xa4k\xe2\x89\xa45000) \xe2\x80\x94 the number of castles, the number of portals and initial size of your army, respectively.'
b'Then nn lines follow. The ii-th line describes the ii-th castle with three integers aiai, bibi and cici (0\xe2\x89\xa4ai,bi,ci\xe2\x89\xa450000\xe2\x89\xa4ai,bi,ci\xe2\x89\xa45000) \xe2\x80\x94 the number of warriors required to capture the ii-th castle, the number of warriors available for hire in this castle and its importance value.'
b'Then mm lines follow. The ii-th line describes the ii-th portal with two integers uiui and vivi (1\xe2\x89\xa4vi<ui\xe2\x89\xa4n1\xe2\x89\xa4vi<ui\xe2\x89\xa4n), meaning that the portal leads from the castle uiui to the castle vivi. There are no two same portals listed.'
b"It is guaranteed that the size of your army won't exceed 50005000 under any circumstances (i.\xe2\x80\x89e. k+\xe2\x88\x91i=1nbi\xe2\x89\xa45000k+\xe2\x88\x91i=1nbi\xe2\x89\xa45000)."
b'Output'
b"If it's impossible to capture all the castles, print one integer \xe2\x88\x921\xe2\x88\x921."
b'Otherwise, print one integer equal to the maximum sum of importance values of defended castles.'
Tags
data structures, dp, greedy, implementation, sortings, *2100
