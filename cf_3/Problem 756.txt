b'You are given a tree consisting of nn nodes. You generate an array from the tree by marking nodes one by one.'
b'Initially, when no nodes are marked, a node is equiprobably chosen and marked from the entire tree. '
b'After that, until all nodes are marked, a node is equiprobably chosen and marked from the set of unmarked nodes with at least one edge to a marked node. '
b'It can be shown that the process marks all nodes in the tree. '
b"The final array aa is the list of the nodes' labels in order of the time each node was marked."
b'Find the expected number of inversions in the array that is generated by the tree and the aforementioned process.'
b'The number of inversions in an array aa is the number of pairs of indices (i,j)(i,j) such that i<ji<j and ai>ajai>aj. For example, the array [4,1,3,2][4,1,3,2] contains 44 inversions: (1,2)(1,2), (1,3)(1,3), (1,4)(1,4), (3,4)(3,4).'
b'Input'
b'The first line contains a single integer nn (2\xe2\x89\xa4n\xe2\x89\xa42002\xe2\x89\xa4n\xe2\x89\xa4200)\xc2\xa0\xe2\x80\x94 the number of nodes in the tree.'
b'The next n\xe2\x88\x921n\xe2\x88\x921 lines each contains two integers xx and yy (1\xe2\x89\xa4x,y\xe2\x89\xa4n1\xe2\x89\xa4x,y\xe2\x89\xa4n; x\xe2\x89\xa0yx\xe2\x89\xa0y), denoting an edge between node xx and yy.'
b"It's guaranteed that the given edges form a tree."
b'Output'
b'Output the expected number of inversions in the generated array modulo 109+7109+7.'
b'Formally, let M=109+7M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pqpq, where pp and qq are integers and q\xe2\x89\xa1\xcc\xb80(modM)q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modMp\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer xx that 0\xe2\x89\xa4x<M0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)x\xe2\x8b\x85q\xe2\x89\xa1p(modM).'
Tags
brute force, combinatorics, dp, graphs, math, probabilities, trees, *2300
