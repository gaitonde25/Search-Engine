b'Polycarpus has a complex electronic device. The core of this device is a circuit board. The board has 109109 contact points which are numbered from 11 to 109109. Also there are nn wires numbered from 11 to nn, each connecting two distinct contact points on the board. An electric signal can pass between wires AA and BB if: '
b'  either both wires share the same contact point;  or there is a sequence of wires starting with AA and ending with BB, and each pair of adjacent wires in the sequence share a contact point. '
b'  The picture shows a circuit board with 55 wires. Contact points with numbers 2,5,7,8,10,132,5,7,8,10,13 are used. Here an electrical signal can pass from wire 22 to wire 33, but not to wire 11. '
b'Currently the circuit board is broken. Polycarpus thinks that the board could be fixed if the wires were re-soldered so that a signal could pass between any pair of wires.'
b"It takes 11 minute for Polycarpus to re-solder an end of a wire. I.e. it takes one minute to change one of the two contact points for a wire. Any contact point from range [1,109][1,109] can be used as a new contact point. A wire's ends must always be soldered to distinct contact points. Both wire's ends can be re-solded, but that will require two actions and will take 22 minutes in total."
b'Find the minimum amount of time Polycarpus needs to re-solder wires so that a signal can pass between any pair of wires. Also output an optimal sequence of wire re-soldering.'
b'Input'
b'The input contains one or several test cases. The first input line contains a single integer tt \xe2\x80\x94 number of test cases. Then, tt test cases follow.'
b'The first line of each test case contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa41051\xe2\x89\xa4n\xe2\x89\xa4105) \xe2\x80\x94 the number of wires. The following nn lines describe wires, each line containing two space-separated integers xi,yixi,yi (1\xe2\x89\xa4xi,yi\xe2\x89\xa41091\xe2\x89\xa4xi,yi\xe2\x89\xa4109, xi\xe2\x89\xa0yixi\xe2\x89\xa0yi) \xe2\x80\x94 contact points connected by the ii-th wire. A couple of contact points can be connected with more than one wire.'
b'Sum of values of nn across all test cases does not exceed 105105.'
b'Output'
b'For each test case first print one line with a single integer kk \xe2\x80\x94 the minimum number of minutes needed to re-solder wires so that a signal can pass between any pair of wires. In the following kk lines print the description of re-solderings. Each re-soldering should be described by three integers wj,aj,bjwj,aj,bj (1\xe2\x89\xa4wj\xe2\x89\xa4n1\xe2\x89\xa4wj\xe2\x89\xa4n, 1\xe2\x89\xa4aj,bj\xe2\x89\xa41091\xe2\x89\xa4aj,bj\xe2\x89\xa4109). Such triple means that during the jj-th re-soldering an end of the wjwj-th wire, which was soldered to contact point ajaj, becomes soldered to contact point bjbj instead. After each re-soldering of a wire it must connect two distinct contact points. If there are multiple optimal re-solderings, print any of them.'
Tags
dfs and similar, graphs, greedy, *2000
