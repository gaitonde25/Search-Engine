b'You are playing a computer game. In this game, you have to fight nn monsters.'
b'To defend from monsters, you need a shield. Each shield has two parameters: its current durability aa and its defence rating bb. Each monster has only one parameter: its strength dd.'
b'When you fight a monster with strength dd while having a shield with current durability aa and defence bb, there are three possible outcomes:'
b'  if a=0a=0, then you receive dd damage;  if a>0a>0 and d\xe2\x89\xa5bd\xe2\x89\xa5b, you receive no damage, but the current durability of the shield decreases by 11;  if a>0a>0 and d<bd<b, nothing happens. '
b'The ii-th monster has strength didi, and you will fight each of the monsters exactly once, in some random order (all n!n! orders are equiprobable). You have to consider mm different shields, the ii-th shield has initial durability aiai and defence rating bibi. For each shield, calculate the expected amount of damage you will receive if you take this shield and fight the given nn monsters in random order.'
b'Input'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n,m\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n,m\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of monsters and the number of shields, respectively.'
b'The second line contains nn integers d1d1, d2d2, ..., dndn (1\xe2\x89\xa4di\xe2\x89\xa41091\xe2\x89\xa4di\xe2\x89\xa4109), where didi is the strength of the ii-th monster.'
b'Then mm lines follow, the ii-th of them contains two integers aiai and bibi (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n; 1\xe2\x89\xa4bi\xe2\x89\xa41091\xe2\x89\xa4bi\xe2\x89\xa4109) \xe2\x80\x94 the description of the ii-th shield.'
b'Output'
b'Print mm integers, where the ii-th integer represents the expected damage you receive with the ii-th shield as follows: it can be proven that, for each shield, the expected damage is an irreducible fraction xyxy, where yy is coprime with 998244353998244353. You have to print the value of x\xe2\x8b\x85y\xe2\x88\x921mod998244353x\xe2\x8b\x85y\xe2\x88\x921mod998244353, where y\xe2\x88\x921y\xe2\x88\x921 is the inverse element for yy (y\xe2\x8b\x85y\xe2\x88\x921mod998244353=1y\xe2\x8b\x85y\xe2\x88\x921mod998244353=1).'
Tags
binary search, combinatorics, probabilities, *2400
