b"Mishka's favourite experimental indie band has recently dropped a new album! Songs of that album share one gimmick. Each name sisi is one of the following types:"
b'  1\xc2\xa0c1\xc2\xa0c \xe2\x80\x94 a single lowercase Latin letter;  2\xc2\xa0j\xc2\xa0c2\xc2\xa0j\xc2\xa0c \xe2\x80\x94 name sjsj (1\xe2\x89\xa4j<i1\xe2\x89\xa4j<i) with a single lowercase Latin letter appended to its end. '
b"Songs are numbered from 11 to nn. It's guaranteed that the first song is always of type 11."
b"Vova is rather interested in the new album but he really doesn't have the time to listen to it entirely. Thus he asks Mishka some questions about it to determine if some song is worth listening to. Questions have the following format:"
b'  i\xc2\xa0ti\xc2\xa0t \xe2\x80\x94 count the number of occurrences of string tt in sisi (the name of the ii-th song of the album) as a continuous substring, tt consists only of lowercase Latin letters. '
b"Mishka doesn't question the purpose of that information, yet he struggles to provide it. Can you please help Mishka answer all Vova's questions?"
b'Input'
b'The first line contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa44\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa44\xe2\x8b\x85105) \xe2\x80\x94 the number of songs in the album.'
b'Each of the next nn lines contains the desciption of the ii-th song of the album in the following format:'
b'  1\xc2\xa0c1\xc2\xa0c \xe2\x80\x94 sisi is a single lowercase Latin letter;  2\xc2\xa0j\xc2\xa0c2\xc2\xa0j\xc2\xa0c \xe2\x80\x94 sisi is the name sjsj (1\xe2\x89\xa4j<i1\xe2\x89\xa4j<i) with a single lowercase Latin letter appended to its end. '
b"The next line contains a single integer mm (1\xe2\x89\xa4m\xe2\x89\xa44\xe2\x8b\x851051\xe2\x89\xa4m\xe2\x89\xa44\xe2\x8b\x85105) \xe2\x80\x94 the number of Vova's questions."
b"Each of the next mm lines contains the desciption of the jj-th Vova's question in the following format:"
b'  i\xc2\xa0ti\xc2\xa0t (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4|t|\xe2\x89\xa44\xe2\x8b\x851051\xe2\x89\xa4|t|\xe2\x89\xa44\xe2\x8b\x85105) \xe2\x80\x94 count the number of occurrences of string tt in sisi (the name of the ii-th song of the album) as a continuous substring, tt consists only of lowercase Latin letters. '
b"It's guaranteed that the total length of question strings tt doesn't exceed 4\xe2\x8b\x851054\xe2\x8b\x85105."
b'Output'
b'For each question print a single integer \xe2\x80\x94 the number of occurrences of the question string tt in the name of the ii-th song of the album as a continuous substring.'
Tags
data structures, dfs and similar, hashing, string suffix structures, strings, trees, *2700
