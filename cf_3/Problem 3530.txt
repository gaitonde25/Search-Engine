b"Consider a tree (that is, an undirected connected graph without loops) T1T1 and a tree T2T2. Let's define their cartesian product T1\xc3\x97T2T1\xc3\x97T2 in a following way."
b'Let VV be the set of vertices in T1T1 and UU be the set of vertices in T2T2.'
b'Then the set of vertices of graph T1\xc3\x97T2T1\xc3\x97T2 is V\xc3\x97UV\xc3\x97U, that is, a set of ordered pairs of vertices, where the first vertex in pair is from VV and the second\xc2\xa0\xe2\x80\x94 from UU.'
b"Let's draw the following edges:"
b' Between (v,u1)(v,u1) and (v,u2)(v,u2) there is an undirected edge, if u1u1 and u2u2 are adjacent in UU.  Similarly, between (v1,u)(v1,u) and (v2,u)(v2,u) there is an undirected edge, if v1v1 and v2v2 are adjacent in VV. '
b'Please see the notes section for the pictures of products of trees in the sample tests.'
b"Let's examine the graph T1\xc3\x97T2T1\xc3\x97T2. How much cycles (not necessarily simple) of length kk it contains? Since this number can be very large, print it modulo 998244353998244353."
b'The sequence of vertices w1w1, w2w2, ..., wkwk, where wi\xe2\x88\x88V\xc3\x97Uwi\xe2\x88\x88V\xc3\x97U called cycle, if any neighboring vertices are adjacent and w1w1 is adjacent to wkwk. Cycles that differ only by the cyclic shift or direction of traversal are still considered different.'
b'Input'
b'First line of input contains three integers\xc2\xa0\xe2\x80\x94 n1n1, n2n2 and kk (2\xe2\x89\xa4n1,n2\xe2\x89\xa440002\xe2\x89\xa4n1,n2\xe2\x89\xa44000, 2\xe2\x89\xa4k\xe2\x89\xa4752\xe2\x89\xa4k\xe2\x89\xa475)\xc2\xa0\xe2\x80\x94 number of vertices in the first tree, number of vertices in the second tree and the cycle length respectively.'
b'Then follow n1\xe2\x88\x921n1\xe2\x88\x921 lines describing the first tree. Each of this lines contains two integers\xc2\xa0\xe2\x80\x94 vi,uivi,ui (1\xe2\x89\xa4vi,ui\xe2\x89\xa4n11\xe2\x89\xa4vi,ui\xe2\x89\xa4n1), which define edges of the first tree.'
b'Then follow n2\xe2\x88\x921n2\xe2\x88\x921 lines, which describe the second tree in the same format.'
b'It is guaranteed, that given graphs are trees.'
b'Output'
b'Print one integer\xc2\xa0\xe2\x80\x94 number of cycles modulo 998244353998244353.'
Tags
combinatorics, divide and conquer, trees, *2900
