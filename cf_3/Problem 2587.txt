b'The only difference between easy and hard versions is constraints.'
b'Polycarp loves to listen to music, so he never leaves the player, even on the way home from the university. Polycarp overcomes the distance from the university to the house in exactly TT minutes.'
b'In the player, Polycarp stores nn songs, each of which is characterized by two parameters: titi and gigi, where titi is the length of the song in minutes (1\xe2\x89\xa4ti\xe2\x89\xa4501\xe2\x89\xa4ti\xe2\x89\xa450), gigi is its genre (1\xe2\x89\xa4gi\xe2\x89\xa431\xe2\x89\xa4gi\xe2\x89\xa43).'
b'Polycarp wants to create such a playlist so that he can listen to music all the time on the way from the university to his home, and at the time of his arrival home, the playlist is over. Polycarp never interrupts songs and always listens to them from beginning to end. Thus, if he started listening to the ii-th song, he would spend exactly titi minutes on its listening. Polycarp also does not like when two songs of the same genre play in a row (i.e. successively/adjacently) or when the songs in his playlist are repeated.'
b'Help Polycarpus count the number of different sequences of songs (their order matters), the total duration is exactly TT, such that there are no two consecutive songs of the same genre in them and all the songs in the playlist are different.'
b'Input'
b'The first line of the input contains two integers nn and TT (1\xe2\x89\xa4n\xe2\x89\xa450,1\xe2\x89\xa4T\xe2\x89\xa425001\xe2\x89\xa4n\xe2\x89\xa450,1\xe2\x89\xa4T\xe2\x89\xa42500) \xe2\x80\x94 the number of songs in the player and the required total duration, respectively.'
b'Next, the nn lines contain descriptions of songs: the ii-th line contains two integers titi and gigi (1\xe2\x89\xa4ti\xe2\x89\xa450,1\xe2\x89\xa4gi\xe2\x89\xa431\xe2\x89\xa4ti\xe2\x89\xa450,1\xe2\x89\xa4gi\xe2\x89\xa43) \xe2\x80\x94 the duration of the ii-th song and its genre, respectively.'
b'Output'
b'Output one integer \xe2\x80\x94 the number of different sequences of songs, the total length of exactly TT, such that there are no two consecutive songs of the same genre in them and all the songs in the playlist are different. Since the answer may be huge, output it modulo 109+7109+7 (that is, the remainder when dividing the quantity by 109+7109+7).'
Tags
combinatorics, dp, *2600
