b"You've probably heard about the twelve labors of Heracles, but do you have any idea about the thirteenth? It is commonly assumed it took him a dozen years to complete the twelve feats, so on average, a year to accomplish every one of them. As time flows faster these days, you have minutes rather than months to solve this task. But will you manage?"
b'In this problem, you are given a tree with nn weighted vertices. A tree is a connected graph with n\xe2\x88\x921n\xe2\x88\x921 edges.'
b"Let us define its kk-coloring as an assignment of kk colors to the edges so that each edge has exactly one color assigned to it. Note that you don't have to use all kk colors."
b'A subgraph of color xx consists of these edges from the original tree, which are assigned color xx, and only those vertices that are adjacent to at least one such edge. So there are no vertices of degree 00 in such a subgraph.'
b'The value of a connected component is the sum of weights of its vertices. Let us define the value of a subgraph as a maximum of values of its connected components. We will assume that the value of an empty subgraph equals 00.'
b'There is also a value of a kk-coloring, which equals the sum of values of subgraphs of all kk colors. Given a tree, for each kk from 11 to n\xe2\x88\x921n\xe2\x88\x921 calculate the maximal value of a kk-coloring.'
b'Input'
b'In the first line of input, there is a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa41051\xe2\x89\xa4t\xe2\x89\xa4105) denoting the number of test cases. Then tt test cases follow. '
b'First line of each test case contains a single integer nn (2\xe2\x89\xa4n\xe2\x89\xa41052\xe2\x89\xa4n\xe2\x89\xa4105). The second line consists of nn integers w1,w2,\xe2\x80\xa6,wnw1,w2,\xe2\x80\xa6,wn (0\xe2\x89\xa4wi\xe2\x89\xa41090\xe2\x89\xa4wi\xe2\x89\xa4109), wiwi equals the weight of ii-th vertex. In each of the following n\xe2\x88\x921n\xe2\x88\x921 lines, there are two integers uu, vv (1\xe2\x89\xa4u,v\xe2\x89\xa4n1\xe2\x89\xa4u,v\xe2\x89\xa4n) describing an edge between vertices uu and vv. It is guaranteed that these edges form a tree. '
b'The sum of nn in all test cases will not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For every test case, your program should print one line containing n\xe2\x88\x921n\xe2\x88\x921 integers separated with a single space. The ii-th number in a line should be the maximal value of a ii-coloring of the tree.'
Tags
data structures, greedy, sortings, trees, *1500
