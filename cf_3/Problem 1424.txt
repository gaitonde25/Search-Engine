b"In the Land of Fire there are nn villages and n\xe2\x88\x921n\xe2\x88\x921 bidirectional road, and there is a path between any pair of villages by roads. There are only two types of roads: stone ones and sand ones. Since the Land of Fire is constantly renovating, every morning workers choose a single road and flip its type (so it becomes a stone road if it was a sand road and vice versa). Also everyone here loves ramen, that's why every morning a ramen pavilion is set in the middle of every stone road, and at the end of each day all the pavilions are removed."
b"For each of the following mm days, after another road is flipped, Naruto and Jiraiya choose a simple path \xe2\x80\x94 that is, a route which starts in a village and ends in a (possibly, the same) village, and doesn't contain any road twice. Since Naruto and Jiraiya also love ramen very much, they buy a single cup of ramen on each stone road and one of them eats it. Since they don't want to offend each other, they only choose routes where they can eat equal number of ramen cups. Since they both like traveling, they choose any longest possible path. After every renovation find the maximal possible length of a path (that is, the number of roads in it) they can follow."
b'Input'
b'The first line contains the only positive integer nn (2\xe2\x89\xa4n\xe2\x89\xa45000002\xe2\x89\xa4n\xe2\x89\xa4500000) standing for the number of villages in the Land of Fire.'
b'Each of the following (n\xe2\x88\x921)(n\xe2\x88\x921) lines contains a description of another road, represented as three positive integers uu, vv and tt (1\xe2\x89\xa4u,v\xe2\x89\xa4n1\xe2\x89\xa4u,v\xe2\x89\xa4n, t\xe2\x88\x88{0,1}t\xe2\x88\x88{0,1}). The first two numbers denote the villages connected by the road, and the third denotes the initial type of the road: 00 for the sand one and 11 for the stone one. Roads are numbered from 11 to (n\xe2\x88\x921)(n\xe2\x88\x921) in the order from the input.'
b'The following line contains a positive integer mm (1\xe2\x89\xa4m\xe2\x89\xa45000001\xe2\x89\xa4m\xe2\x89\xa4500000) standing for the number of days Naruto and Jiraiya travel for.'
b'Each of the following mm lines contains the single integer idid (1\xe2\x89\xa4id\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4id\xe2\x89\xa4n\xe2\x88\x921) standing for the index of the road whose type is flipped on the morning of corresponding day.'
b'It is guaranteed that there is a road path between any pair of villages.'
b'Output'
b'Output mm lines. In the ii-th of them print the only integer denoting the maximal possible length of any valid path on the ii-th day.'
Tags
data structures, trees, *2800
