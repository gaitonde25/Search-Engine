b'Masha meets a new friend and learns his phone number\xc2\xa0\xe2\x80\x94 ss. She wants to remember it as soon as possible. The phone number\xc2\xa0\xe2\x80\x94 is a string of length mm that consists of digits from 00 to 99. The phone number may start with 0.'
b'Masha already knows nn phone numbers (all numbers have the same length mm). It will be easier for her to remember a new number if the ss is represented as segments of numbers she already knows. Each such segment must be of length at least 22, otherwise there will be too many segments and Masha will get confused.'
b"For example, Masha needs to remember the number: s=s= '12345678' and she already knows n=4n=4 numbers: '12340219', '20215601', '56782022', '12300678'. You can represent ss as a 33 segment: '1234' of number one, '56' of number two, and '78' of number three. There are other ways to represent ss."
b'Masha asks you for help, she asks you to break the string ss into segments of length 22 or more of the numbers she already knows. If there are several possible answers, print any of them.'
b'Input'
b'The first line of input data contains an integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104)\xc2\xa0\xe2\x80\x94the number of test cases.'
b'Before each test case there is a blank line. Then there is a line containing integers nn and mm (1\xe2\x89\xa4n,m\xe2\x89\xa41031\xe2\x89\xa4n,m\xe2\x89\xa4103)\xc2\xa0\xe2\x80\x94the number of phone numbers that Masha knows and the number of digits in each phone number. Then follow nn line, ii-th of which describes the ii-th number that Masha knows. The next line contains the phone number of her new friend ss.'
b'Among the given n+1n+1 phones, there may be duplicates (identical phones).'
b'It is guaranteed that the sum of n\xe2\x8b\x85mn\xe2\x8b\x85m (nn multiplied by mm) values over all input test cases does not exceed 106106.'
b'Output'
b'You need to print the answers to tt test cases. The first line of the answer should contain one number kk, corresponding to the number of segments into which you split the phone number ss. Print -1 if you cannot get such a split.'
b'If the answer is yes, then follow kk lines containing triples of numbers l,r,il,r,i. Such triplets mean that the next r\xe2\x88\x92l+1r\xe2\x88\x92l+1 digits of number ss are equal to a segment (substring) with boundaries [l,r][l,r] of the phone under number ii. Both the phones and the digits in them are numbered from 11. Note that r\xe2\x88\x92l+1\xe2\x89\xa52r\xe2\x88\x92l+1\xe2\x89\xa52 for all kk lines.'
Tags
brute force, constructive algorithms, dp, hashing, implementation, strings, *2000
