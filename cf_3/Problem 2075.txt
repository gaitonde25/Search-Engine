b'Evlampiy was gifted a rooted tree. The vertices of the tree are numbered from 11 to nn. Each of its vertices also has an integer aiai written on it. For each vertex ii, Evlampiy calculated cici\xc2\xa0\xe2\x80\x94 the number of vertices jj in the subtree of vertex ii, such that aj<aiaj<ai. '
b'Illustration for the second example, the first integer is aiai and the integer in parentheses is cici'
b'After the new year, Evlampiy could not remember what his gift was! He remembers the tree and the values of cici, but he completely forgot which integers aiai were written on the vertices.'
b'Help him to restore initial integers!'
b'Input'
b'The first line contains an integer nn (1\xe2\x89\xa4n\xe2\x89\xa42000)(1\xe2\x89\xa4n\xe2\x89\xa42000) \xe2\x80\x94 the number of vertices in the tree.'
b'The next nn lines contain descriptions of vertices: the ii-th line contains two integers pipi and cici (0\xe2\x89\xa4pi\xe2\x89\xa4n0\xe2\x89\xa4pi\xe2\x89\xa4n; 0\xe2\x89\xa4ci\xe2\x89\xa4n\xe2\x88\x9210\xe2\x89\xa4ci\xe2\x89\xa4n\xe2\x88\x921), where pipi is the parent of vertex ii or 00 if vertex ii is root, and cici is the number of vertices jj in the subtree of vertex ii, such that aj<aiaj<ai.'
b'It is guaranteed that the values of pipi describe a rooted tree with nn vertices.'
b'Output'
b'If a solution exists, in the first line print "YES", and in the second line output nn integers aiai (1\xe2\x89\xa4ai\xe2\x89\xa4109)(1\xe2\x89\xa4ai\xe2\x89\xa4109). If there are several solutions, output any of them. One can prove that if there is a solution, then there is also a solution in which all aiai are between 11 and 109109.'
b'If there are no solutions, print "NO".'
Tags
constructive algorithms, data structures, dfs and similar, graphs, greedy, trees, *1800
