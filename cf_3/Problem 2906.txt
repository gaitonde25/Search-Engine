b'Miyako came to the flea kingdom with a ukulele. She became good friends with local flea residents and played beautiful music for them every day.'
b"In return, the fleas made a bigger ukulele for her: it has nn strings, and each string has (1018+1)(1018+1) frets numerated from 00 to 10181018. The fleas use the array s1,s2,\xe2\x80\xa6,sns1,s2,\xe2\x80\xa6,sn to describe the ukulele's tuning, that is, the pitch of the jj-th fret on the ii-th string is the integer si+jsi+j."
b'Miyako is about to leave the kingdom, but the fleas hope that Miyako will answer some last questions for them.'
b'Each question is in the form of: "How many different pitches are there, if we consider frets between ll and rr (inclusive) on all strings?"'
b'Miyako is about to visit the cricket kingdom and has no time to answer all the questions. Please help her with this task!'
b'Formally, you are given a matrix with nn rows and (1018+1)(1018+1) columns, where the cell in the ii-th row and jj-th column (0\xe2\x89\xa4j\xe2\x89\xa410180\xe2\x89\xa4j\xe2\x89\xa41018) contains the integer si+jsi+j. You are to answer qq queries, in the kk-th query you have to answer the number of distinct integers in the matrix from the lklk-th to the rkrk-th columns, inclusive.'
b'Input'
b'The first line contains an integer nn (1\xe2\x89\xa4n\xe2\x89\xa41000001\xe2\x89\xa4n\xe2\x89\xa4100000)\xc2\xa0\xe2\x80\x94 the number of strings.'
b'The second line contains nn integers s1,s2,\xe2\x80\xa6,sns1,s2,\xe2\x80\xa6,sn (0\xe2\x89\xa4si\xe2\x89\xa410180\xe2\x89\xa4si\xe2\x89\xa41018)\xc2\xa0\xe2\x80\x94 the tuning of the ukulele.'
b'The third line contains an integer qq (1\xe2\x89\xa4q\xe2\x89\xa41000001\xe2\x89\xa4q\xe2\x89\xa4100000)\xc2\xa0\xe2\x80\x94 the number of questions.'
b'The kk-th among the following qq lines contains two integers lklk\xef\xbc\x8crkrk (0\xe2\x89\xa4lk\xe2\x89\xa4rk\xe2\x89\xa410180\xe2\x89\xa4lk\xe2\x89\xa4rk\xe2\x89\xa41018)\xc2\xa0\xe2\x80\x94 a question from the fleas.'
b'Output'
b'Output one number for each question, separated by spaces\xc2\xa0\xe2\x80\x94 the number of different pitches.'
Tags
binary search, sortings, *1800
