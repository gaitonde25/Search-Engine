b"Olya has an array of integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an. She wants to split it into tandem repeats. Since it's rarely possible, before that she wants to perform the following operation several (possibly, zero) number of times: insert a pair of equal numbers into an arbitrary position. Help her!"
b'More formally:'
b'  A tandem repeat is a sequence xx of even length 2k2k such that for each 1\xe2\x89\xa4i\xe2\x89\xa4k1\xe2\x89\xa4i\xe2\x89\xa4k the condition xi=xi+kxi=xi+k is satisfied.  An array aa could be split into tandem repeats if you can split it into several parts, each being a subsegment of the array, such that each part is a tandem repeat.  In one operation you can choose an arbitrary letter cc and insert [c,c][c,c] to any position in the array (at the beginning, between any two integers, or at the end).  You are to perform several operations and split the array into tandem repeats or determine that it is impossible. Please note that you do not have to minimize the number of operations. '
b'Input'
b'Each test contains multiple test cases. The first line contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa4300001\xe2\x89\xa4t\xe2\x89\xa430000) \xe2\x80\x94 the number of test cases. Description of the test cases follows.'
b'The first line of each test case contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa45001\xe2\x89\xa4n\xe2\x89\xa4500). '
b'The second line contains nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa41091\xe2\x89\xa4ai\xe2\x89\xa4109) \xc2\xa0\xe2\x80\x94 the initial array. '
b'It is guaranteed that the sum of n2n2 over all test cases does not exceed 250000250000.'
b'Output'
b'For each test case print answer in the following format.'
b'If you cannot turn the array into a concatenation of tandem repeats, print a single integer \xe2\x88\x921\xe2\x88\x921.'
b'Otherwise print the number of operations qq (0\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85n20\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85n2) that you want to do. Then print the descriptions of operations.'
b'In each of the following qq lines print two integers pp and cc (1\xe2\x89\xa4c\xe2\x89\xa41091\xe2\x89\xa4c\xe2\x89\xa4109), which mean that you insert the integer cc twice after pp elements of the array. If the length of the array is mm before the operation, then the condition 0\xe2\x89\xa4p\xe2\x89\xa4m0\xe2\x89\xa4p\xe2\x89\xa4m should be satisfied.'
b'Then you should print any way to split the resulting array into tandem repeats. First, print a single integer dd, and then print a sequence t1,t2,\xe2\x80\xa6,tdt1,t2,\xe2\x80\xa6,td of even integers of size dd (d,ti\xe2\x89\xa51d,ti\xe2\x89\xa51). These numbers are the lengths of the subsegments from left to right.'
b'Note that the size of the resulting array aa is m=n+2\xe2\x8b\x85qm=n+2\xe2\x8b\x85q. The following statements must hold: '
b'  m=\xe2\x88\x91i=1dtim=\xe2\x88\x91i=1dti.    For all integer ii such that 1\xe2\x89\xa4i\xe2\x89\xa4d1\xe2\x89\xa4i\xe2\x89\xa4d, the sequence al,al+1,\xe2\x80\xa6,aral,al+1,\xe2\x80\xa6,ar is a tandem repeat, where l=\xe2\x88\x91j=1i\xe2\x88\x921tj+1l=\xe2\x88\x91j=1i\xe2\x88\x921tj+1, r=l+ti\xe2\x88\x921r=l+ti\xe2\x88\x921. '
b'It can be shown that if the array can be turned into a concatenation of tandem repeats, then there exists a solution satisfying all constraints. If there are multiple answers, you can print any.'
Tags
constructive algorithms, implementation, sortings, *2000
