b'Alex decided to try his luck in TV shows. He once went to the quiz named "What\'s That Word?!". After perfectly answering the questions "How is a pseudonym commonly referred to in the Internet?" ("Um... a nick?"), "After which famous inventor we name the unit of the magnetic field strength?" ("Um... Nikola Tesla?") and "Which rock band performs "How You Remind Me"?" ("Um... Nickelback?"), he decided to apply to a little bit more difficult TV show: "What\'s in This Multiset?!".'
b'The rules of this TV show are as follows: there are nn multisets numbered from 11 to nn. Each of them is initially empty. Then, qq events happen; each of them is in one of the four possible types:'
b'  1 x v \xe2\x80\x94 set the xx-th multiset to a singleton {v}{v}. 2 x y z \xe2\x80\x94 set the xx-th multiset to a union of the yy-th and the zz-th multiset. For example: {1,3}\xe2\x88\xaa{1,4,4}={1,1,3,4,4}{1,3}\xe2\x88\xaa{1,4,4}={1,1,3,4,4}. 3 x y z \xe2\x80\x94 set the xx-th multiset to a product of the yy-th and the zz-th multiset. The product A\xc3\x97BA\xc3\x97B of two multisets AA, BB is defined as {gcd(a,b)\xe2\x88\xa3a\xe2\x88\x88A,b\xe2\x88\x88B}{gcd(a,b)\xe2\x88\xa3a\xe2\x88\x88A,b\xe2\x88\x88B}, where gcd(p,q)gcd(p,q) is the greatest common divisor of pp and qq. For example: {2,2,3}\xc3\x97{1,4,6}={1,2,2,1,2,2,1,1,3}{2,2,3}\xc3\x97{1,4,6}={1,2,2,1,2,2,1,1,3}. 4 x v \xe2\x80\x94 the participant is asked how many times number vv occurs in the xx-th multiset. As the quiz turned out to be too hard in the past, participants should now give the answers modulo 22 only. '
b'Note, that xx, yy and zz described above are not necessarily different. In events of types 22 and 33, the sum or the product is computed first, and then the assignment is performed.'
b'Alex is confused by the complicated rules of the show. Can you help him answer the requests of the 44-th type?'
b'Input'
b'The first line contains two integers nn and qq (1\xe2\x89\xa4n\xe2\x89\xa41051\xe2\x89\xa4n\xe2\x89\xa4105, 1\xe2\x89\xa4q\xe2\x89\xa41061\xe2\x89\xa4q\xe2\x89\xa4106) \xe2\x80\x94 the number of multisets and the number of events.'
b"Each of the following qq lines describes next event in the format given in statement. It's guaranteed that 1\xe2\x89\xa4x,y,z\xe2\x89\xa4n1\xe2\x89\xa4x,y,z\xe2\x89\xa4n and 1\xe2\x89\xa4v\xe2\x89\xa470001\xe2\x89\xa4v\xe2\x89\xa47000 always holds."
b"It's guaranteed that there will be at least one event of the 44-th type."
b'Output'
b'Print a string which consists of digits 00 and 11 only, and has length equal to the number of events of the 44-th type. The ii-th digit of the string should be equal to the answer for the ii-th query of the 44-th type.'
Tags
bitmasks, combinatorics, number theory, *2500
