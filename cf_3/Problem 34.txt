b'You are given a rooted tree consisting of nn vertices. Vertices are numbered from 11 to nn. Any vertex can be the root of a tree.'
b'A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root.'
b'The tree is specified by an array of parents pp containing nn numbers: pipi is a parent of the vertex with the index ii. The parent of a vertex uu is a vertex that is the next vertex on the shortest path from uu to the root. For example, on the simple path from 55 to 33 (the root), the next vertex would be 11, so the parent of 55 is 11.'
b'The root has no parent, so for it, the value of pipi is ii (the root is the only vertex for which pi=ipi=i).'
b'Find such a set of paths that:'
b'  each vertex belongs to exactly one path, each path can contain one or more vertices;  in each path each next vertex\xc2\xa0\xe2\x80\x94 is a son of the current vertex (that is, paths always lead down\xc2\xa0\xe2\x80\x94 from parent to son);  number of paths is minimal. '
b'For example, if n=5n=5 and p=[3,1,3,3,1]p=[3,1,3,3,1], then the tree can be divided into three paths: '
b'  3\xe2\x86\x921\xe2\x86\x9253\xe2\x86\x921\xe2\x86\x925 (path of 33 vertices),  44 (path of 11 vertices).  22 (path of 11 vertices). '
b'  Example of splitting a root tree into three paths for n=5n=5, the root of the tree\xc2\xa0\xe2\x80\x94 node 33. '
b'Input'
b'The first line of input data contains an integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104) \xe2\x80\x94 the number of test cases in the test.'
b'Each test case consists of two lines.'
b'The first of them contains an integer nn (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105). It is the number of vertices in the tree.'
b'The second line contains nn integers p1,p2,\xe2\x80\xa6,pnp1,p2,\xe2\x80\xa6,pn (1\xe2\x89\xa4pi\xe2\x89\xa4n1\xe2\x89\xa4pi\xe2\x89\xa4n). It is guaranteed that the pp array encodes some rooted tree.'
b'It is guaranteed that the sum of the values nn over all test cases in the test does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each test case on the first line, output an integer mm \xe2\x80\x94 the minimum number of non-intersecting leading down paths that can cover all vertices of the tree.'
b'Then print mm pairs of lines containing path descriptions. In the first of them print the length of the path, in the second \xe2\x80\x94 the sequence of vertices specifying that path in the order from top to bottom. You can output the paths in any order.'
b'If there are several answers, output any of them.'
Tags
graphs, implementation, trees, *1300
