b'Alice and Bob are going to celebrate Christmas by playing a game with a tree of presents. The tree has nn nodes (numbered 11 to nn, with some node rr as its root). There are aiai presents are hanging from the ii-th node.'
b'Before beginning the game, a special integer kk is chosen. The game proceeds as follows:'
b" Alice begins the game, with moves alternating each turn; in any move, the current player may choose some node (for example, ii) which has depth at least kk. Then, the player picks some positive number of presents hanging from that node, let's call it mm (1\xe2\x89\xa4m\xe2\x89\xa4ai)(1\xe2\x89\xa4m\xe2\x89\xa4ai); the player then places these mm presents on the kk-th ancestor (let's call it jj) of the ii-th node (the kk-th ancestor of vertex ii is a vertex jj such that ii is a descendant of jj, and the difference between the depth of jj and the depth of ii is exactly kk). Now, the number of presents of the ii-th node (ai)(ai) is decreased by mm, and, correspondingly, ajaj is increased by mm; Alice and Bob both play optimally. The player unable to make a move loses the game."
b'For each possible root of the tree, find who among Alice or Bob wins the game.'
b'Note: The depth of a node ii in a tree with root rr is defined as the number of edges on the simple path from node rr to node ii. The depth of root rr itself is zero.'
b'Input'
b'The first line contains two space-separated integers nn and kk (3\xe2\x89\xa4n\xe2\x89\xa4105,1\xe2\x89\xa4k\xe2\x89\xa420)(3\xe2\x89\xa4n\xe2\x89\xa4105,1\xe2\x89\xa4k\xe2\x89\xa420).'
b'The next n\xe2\x88\x921n\xe2\x88\x921 lines each contain two integers xx and yy (1\xe2\x89\xa4x,y\xe2\x89\xa4n,x\xe2\x89\xa0y)(1\xe2\x89\xa4x,y\xe2\x89\xa4n,x\xe2\x89\xa0y), denoting an undirected edge between the two nodes xx and yy. These edges form a tree of nn nodes.'
b'The next line contains nn space-separated integers denoting the array aa (0\xe2\x89\xa4ai\xe2\x89\xa4109)(0\xe2\x89\xa4ai\xe2\x89\xa4109).'
b'Output'
b'Output nn integers, where the ii-th integer is 11 if Alice wins the game when the tree is rooted at node ii, or 00 otherwise.'
Tags
bitmasks, data structures, dfs and similar, dp, games, math, trees, *2500
