b"You're given a simple, undirected, connected, weighted graph with nn nodes and mm edges."
b'Nodes are numbered from 11 to nn. There are exactly kk centrals (recharge points), which are nodes 1,2,\xe2\x80\xa6,k1,2,\xe2\x80\xa6,k.'
b'We consider a robot moving into this graph, with a battery of capacity cc, not fixed by the constructor yet. At any time, the battery contains an integer amount xx of energy between 00 and cc inclusive.'
b'Traversing an edge of weight wiwi is possible only if x\xe2\x89\xa5wix\xe2\x89\xa5wi, and costs wiwi energy points (x:=x\xe2\x88\x92wix:=x\xe2\x88\x92wi).'
b'Moreover, when the robot reaches a central, its battery is entirely recharged (x:=cx:=c).'
b"You're given qq independent missions, the ii-th mission requires to move the robot from central aiai to central bibi."
b'For each mission, you should tell the minimum capacity required to acheive it.'
b'Input'
b'The first line contains four integers nn, mm, kk and qq (2\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x89\xa41052\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x89\xa4105 and 1\xe2\x89\xa4m,q\xe2\x89\xa43\xe2\x8b\x851051\xe2\x89\xa4m,q\xe2\x89\xa43\xe2\x8b\x85105).'
b"The ii-th of the next mm lines contains three integers uiui, vivi and wiwi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n, ui\xe2\x89\xa0viui\xe2\x89\xa0vi, 1\xe2\x89\xa4wi\xe2\x89\xa41091\xe2\x89\xa4wi\xe2\x89\xa4109), that mean that there's an edge between nodes uu and vv, with a weight wiwi."
b'It is guaranteed that the given graph is simple (there is no self-loop, and there is at most one edge between every pair of nodes) and connected.'
b'The ii-th of the next qq lines contains two integers aiai and bibi (1\xe2\x89\xa4ai,bi\xe2\x89\xa4k1\xe2\x89\xa4ai,bi\xe2\x89\xa4k, ai\xe2\x89\xa0biai\xe2\x89\xa0bi).'
b'Output'
b'You have to output qq lines, where the ii-th line contains a single integer : the minimum capacity required to acheive the ii-th mission.'
Tags
binary search, dsu, graphs, shortest paths, trees, *2500
