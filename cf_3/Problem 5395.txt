b'A Large Software Company develops its own social network. Analysts have found that during the holidays, major sporting events and other significant events users begin to enter the network more frequently, resulting in great load increase on the infrastructure.'
b'As part of this task, we assume that the social network is 4n processes running on the n servers. All servers are absolutely identical machines, each of which has a volume of RAM of 1 GB = 1024 MB (1). Each process takes 100 MB of RAM on the server. At the same time, the needs of maintaining the viability of the server takes about 100 more megabytes of RAM. Thus, each server may have up to 9 different processes of social network.'
b'Now each of the n servers is running exactly 4 processes. However, at the moment of peak load it is sometimes necessary to replicate the existing 4n processes by creating 8n new processes instead of the old ones. More formally, there is a set of replication rules, the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) of which has the form of ai\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(bi,\xe2\x80\x89ci), where ai, bi and ci (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi,\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are the numbers of servers. This means that instead of an old process running on server ai, there should appear two new copies of the process running on servers bi and ci. The two new replicated processes can be on the same server (i.e., bi may be equal to ci) or even on the same server where the original process was (i.e. ai may be equal to bi or ci). During the implementation of the rule ai\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(bi,\xe2\x80\x89ci) first the process from the server ai is destroyed, then appears a process on the server bi, then appears a process on the server ci.'
b'There is a set of 4n rules, destroying all the original 4n processes from n servers, and creating after their application 8n replicated processes, besides, on each of the n servers will be exactly 8 processes. However, the rules can only be applied consecutively, and therefore the amount of RAM of the servers imposes limitations on the procedure for the application of the rules.'
b'According to this set of rules determine the order in which you want to apply all the 4n rules so that at any given time the memory of each of the servers contained at most 9 processes (old and new together), or tell that it is impossible.'
b'Input'
b'The first line of the input contains integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8930\xe2\x80\x89000) \xe2\x80\x94 the number of servers of the social network.'
b'Next 4n lines contain the rules of replicating processes, the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) of these lines as form ai,\xe2\x80\x89bi,\xe2\x80\x89ci (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi,\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and describes rule ai\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(bi,\xe2\x80\x89ci).'
b'It is guaranteed that each number of a server from 1 to n occurs four times in the set of all ai, and eight times among a set that unites all bi and ci.'
b'Output'
b'If the required order of performing rules does not exist, print "NO" (without the quotes).'
b'Otherwise, print in the first line "YES" (without the quotes), and in the second line \xe2\x80\x94 a sequence of 4n numbers from 1 to 4n, giving the numbers of the rules in the order they are applied. The sequence should be a permutation, that is, include each number from 1 to 4n exactly once.'
b'If there are multiple possible variants, you are allowed to print any of them.'
Tags
constructive algorithms, greedy, *2600
