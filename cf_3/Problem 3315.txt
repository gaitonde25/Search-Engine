b'The Metropolis computer network consists of nn servers, each has an encryption key in the range from 00 to 2k\xe2\x88\x9212k\xe2\x88\x921 assigned to it. Let cici be the encryption key assigned to the ii-th server. Additionally, mm pairs of servers are directly connected via a data communication channel. Because of the encryption algorithms specifics, a data communication channel can only be considered safe if the two servers it connects have distinct encryption keys. The initial assignment of encryption keys is guaranteed to keep all data communication channels safe.'
b'You have been informed that a new virus is actively spreading across the internet, and it is capable to change the encryption key of any server it infects. More specifically, the virus body contains some unknown number xx in the same aforementioned range, and when server ii is infected, its encryption key changes from cici to ci\xe2\x8a\x95xci\xe2\x8a\x95x, where \xe2\x8a\x95\xe2\x8a\x95 denotes the bitwise XOR operation.'
b'Sadly, you know neither the number xx nor which servers of Metropolis are going to be infected by the dangerous virus, so you have decided to count the number of such situations in which all data communication channels remain safe. Formally speaking, you need to find the number of pairs (A,x)(A,x), where AA is some (possibly empty) subset of the set of servers and xx is some number in the range from 00 to 2k\xe2\x88\x9212k\xe2\x88\x921, such that when all servers from the chosen subset AA and none of the others are infected by a virus containing the number xx, all data communication channels remain safe. Since this number can be quite big, you are asked to find its remainder modulo 109+7109+7.'
b'Input'
b'The first line of input contains three integers nn, mm and kk (1\xe2\x89\xa4n\xe2\x89\xa45000001\xe2\x89\xa4n\xe2\x89\xa4500000, 0\xe2\x89\xa4m\xe2\x89\xa4min(n(n\xe2\x88\x921)2,500000)0\xe2\x89\xa4m\xe2\x89\xa4min(n(n\xe2\x88\x921)2,500000), 0\xe2\x89\xa4k\xe2\x89\xa4600\xe2\x89\xa4k\xe2\x89\xa460)\xc2\xa0\xe2\x80\x94 the number of servers, the number of pairs of servers directly connected by a data communication channel, and the parameter kk, which defines the range of possible values for encryption keys.'
b'The next line contains nn integers cici (0\xe2\x89\xa4ci\xe2\x89\xa42k\xe2\x88\x9210\xe2\x89\xa4ci\xe2\x89\xa42k\xe2\x88\x921), the ii-th of which is the encryption key used by the ii-th server.'
b'The next mm lines contain two integers uiui and vivi each (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n, ui\xe2\x89\xa0viui\xe2\x89\xa0vi) denoting that those servers are connected by a data communication channel. It is guaranteed that each pair of servers appears in this list at most once.'
b'Output'
b'The only output line should contain a single integer\xc2\xa0\xe2\x80\x94 the number of safe infections of some subset of servers by a virus with some parameter, modulo 109+7109+7.'
Tags
dfs and similar, dsu, graphs, math, sortings, *2200
