b'In this problem you will have to help Berland army with organizing their command delivery system.'
b'There are nn officers in Berland army. The first officer is the commander of the army, and he does not have any superiors. Every other officer has exactly one direct superior. If officer aa is the direct superior of officer bb, then we also can say that officer bb is a direct subordinate of officer aa.'
b'Officer xx is considered to be a subordinate (direct or indirect) of officer yy if one of the following conditions holds:'
b'  officer yy is the direct superior of officer xx;  the direct superior of officer xx is a subordinate of officer yy. '
b'For example, on the picture below the subordinates of the officer 33 are: 5,6,7,8,95,6,7,8,9.'
b'The structure of Berland army is organized in such a way that every officer, except for the commander, is a subordinate of the commander of the army.'
b"Formally, let's represent Berland army as a tree consisting of nn vertices, in which vertex uu corresponds to officer uu. The parent of vertex uu corresponds to the direct superior of officer uu. The root (which has index 11) corresponds to the commander of the army."
b'Berland War Ministry has ordered you to give answers on qq queries, the ii-th query is given as (ui,ki)(ui,ki), where uiui is some officer, and kiki is a positive integer.'
b'To process the ii-th query imagine how a command from uiui spreads to the subordinates of uiui. Typical DFS (depth first search) algorithm is used here.'
b"Suppose the current officer is aa and he spreads a command. Officer aa chooses bb \xe2\x80\x94 one of his direct subordinates (i.e. a child in the tree) who has not received this command yet. If there are many such direct subordinates, then aa chooses the one having minimal index. Officer aa gives a command to officer bb. Afterwards, bb uses exactly the same algorithm to spread the command to its subtree. After bb finishes spreading the command, officer aa chooses the next direct subordinate again (using the same strategy). When officer aa cannot choose any direct subordinate who still hasn't received this command, officer aa finishes spreading the command."
b"Let's look at the following example:"
b'  '
b'If officer 11 spreads a command, officers receive it in the following order: [1,2,3,5,6,8,7,9,4][1,2,3,5,6,8,7,9,4].'
b'If officer 33 spreads a command, officers receive it in the following order: [3,5,6,8,7,9][3,5,6,8,7,9].'
b'If officer 77 spreads a command, officers receive it in the following order: [7,9][7,9].'
b'If officer 99 spreads a command, officers receive it in the following order: [9][9].'
b'To answer the ii-th query (ui,ki)(ui,ki), construct a sequence which describes the order in which officers will receive the command if the uiui-th officer spreads it. Return the kiki-th element of the constructed list or -1 if there are fewer than kiki elements in it.'
b"You should process queries independently. A query doesn't affect the following queries."
b'Input'
b'The first line of the input contains two integers nn and qq (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105,1\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105,1\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of officers in Berland army and the number of queries.'
b"The second line of the input contains n\xe2\x88\x921n\xe2\x88\x921 integers p2,p3,\xe2\x80\xa6,pnp2,p3,\xe2\x80\xa6,pn (1\xe2\x89\xa4pi<i1\xe2\x89\xa4pi<i), where pipi is the index of the direct superior of the officer having the index ii. The commander has index 11 and doesn't have any superiors."
b'The next qq lines describe the queries. The ii-th query is given as a pair (ui,kiui,ki) (1\xe2\x89\xa4ui,ki\xe2\x89\xa4n1\xe2\x89\xa4ui,ki\xe2\x89\xa4n), where uiui is the index of the officer which starts spreading a command, and kiki is the index of the required officer in the command spreading sequence.'
b'Output'
b'Print qq numbers, where the ii-th number is the officer at the position kiki in the list which describes the order in which officers will receive the command if it starts spreading from officer uiui. Print "-1" if the number of officers which receive the command is less than kiki.'
b'You should process queries independently. They do not affect each other.'
Tags
dfs and similar, graphs, trees, *1600
