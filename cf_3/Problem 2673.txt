b'The only difference between easy and hard versions is constraints.'
b'Nauuo is a girl who loves random picture websites.'
b'One day she made a random picture website by herself which includes nn pictures.'
b'When Nauuo visits the website, she sees exactly one picture. The website does not display each picture with equal probability. The ii-th picture has a non-negative weight wiwi, and the probability of the ii-th picture being displayed is wi\xe2\x88\x91nj=1wjwi\xe2\x88\x91j=1nwj. That is to say, the probability of a picture to be displayed is proportional to its weight.'
b'However, Nauuo discovered that some pictures she does not like were displayed too often. '
b'To solve this problem, she came up with a great idea: when she saw a picture she likes, she would add 11 to its weight; otherwise, she would subtract 11 from its weight.'
b'Nauuo will visit the website mm times. She wants to know the expected weight of each picture after all the mm visits modulo 998244353998244353. Can you help her?'
b'The expected weight of the ii-th picture can be denoted by qipiqipi where gcd(pi,qi)=1gcd(pi,qi)=1, you need to print an integer riri satisfying 0\xe2\x89\xa4ri<9982443530\xe2\x89\xa4ri<998244353 and ri\xe2\x8b\x85pi\xe2\x89\xa1qi(mod998244353)ri\xe2\x8b\x85pi\xe2\x89\xa1qi(mod998244353). It can be proved that such riri exists and is unique.'
b'Input'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n\xe2\x89\xa4501\xe2\x89\xa4n\xe2\x89\xa450, 1\xe2\x89\xa4m\xe2\x89\xa4501\xe2\x89\xa4m\xe2\x89\xa450) \xe2\x80\x94 the number of pictures and the number of visits to the website.'
b'The second line contains nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (aiai is either 00 or 11) \xe2\x80\x94 if ai=0ai=0 , Nauuo does not like the ii-th picture; otherwise Nauuo likes the ii-th picture. It is guaranteed that there is at least one picture which Nauuo likes.'
b'The third line contains nn integers w1,w2,\xe2\x80\xa6,wnw1,w2,\xe2\x80\xa6,wn (1\xe2\x89\xa4wi\xe2\x89\xa4501\xe2\x89\xa4wi\xe2\x89\xa450) \xe2\x80\x94 the initial weights of the pictures.'
b'Output'
b'The output contains nn integers r1,r2,\xe2\x80\xa6,rnr1,r2,\xe2\x80\xa6,rn \xe2\x80\x94 the expected weights modulo 998244353998244353.'
Tags
dp, probabilities, *2300
