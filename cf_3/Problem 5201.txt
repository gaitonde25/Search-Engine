b"Limak is a little polar bear. His parents told him to clean a house before the New Year's Eve. Their house is a rectangular grid with h rows and w columns. Each cell is an empty square."
b"He is a little bear and thus he can't clean a house by himself. Instead, he is going to use a cleaning robot."
b"A cleaning robot has a built-in pattern of n moves, defined by a string of the length n. A single move (character) moves a robot to one of four adjacent cells. Each character is one of the following four: 'U' (up), 'D' (down), 'L' (left), 'R' (right). One move takes one minute."
b'A cleaning robot must be placed and started in some cell. Then it repeats its pattern of moves till it hits a wall (one of four borders of a house). After hitting a wall it can be placed and used again.'
b"Limak isn't sure if placing a cleaning robot in one cell will be enough. Thus, he is going to start it w\xc2\xb7h times, one time in each cell. Maybe some cells will be cleaned more than once but who cares?"
b'Limak asks you one question. How much time will it take to clean a house? Find and print the number of minutes modulo 109\xe2\x80\x89+\xe2\x80\x897. It\'s also possible that a cleaning robot will never stop\xc2\xa0\xe2\x80\x94 then print "-1" (without the quotes) instead.'
b'Placing and starting a robot takes no time, however, you must count a move when robot hits a wall. Take a look into samples for further clarification.'
b'Input'
b'The first line contains three integers n, h and w (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89h,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89500\xe2\x80\x89000)\xc2\xa0\xe2\x80\x94 the length of the pattern, the number of rows and the number of columns, respectively.'
b"The second line contains a string of length n\xc2\xa0\xe2\x80\x94 the pattern of n moves. Each character is one of uppercase letters 'U', 'D', 'L' or 'R'."
b'Output'
b'Print one line with the answer.'
b'If a cleaning robot will never stop, print "-1" (without the quotes). Otherwise, print the number of minutes it will take to clean a house modulo 109\xe2\x80\x89+\xe2\x80\x897.'
Tags
binary search, implementation, *2500
