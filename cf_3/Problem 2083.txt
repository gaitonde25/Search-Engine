b'It is only a few days until Seollal (Korean Lunar New Year), and Jaehyun has invited his family to his garden. There are kids among the guests. To make the gathering more fun for the kids, Jaehyun is going to run a game of hide-and-seek.'
b'The garden can be represented by a n\xc3\x97mn\xc3\x97m grid of unit cells. Some (possibly zero) cells are blocked by rocks, and the remaining cells are free. Two cells are neighbors if they share an edge. Each cell has up to 4 neighbors: two in the horizontal direction and two in the vertical direction. '
b'Since the garden is represented as a grid, we can classify the cells in the garden as either "black" or "white". The top-left cell is black, and two cells which are neighbors must be different colors. Cell indices are 1-based, so the top-left corner of the garden is cell (1,1)(1,1).'
b'Jaehyun wants to turn his garden into a maze by placing some walls between two cells. Walls can only be placed between neighboring cells. If the wall is placed between two neighboring cells aa and bb, then the two cells aa and bb are not neighboring from that point. One can walk directly between two neighboring cells if and only if there is no wall directly between them. '
b'A maze must have the following property. For each pair of free cells in the maze, there must be exactly one simple path between them. A simple path between cells aa and bb is a sequence of free cells in which the first cell is aa, the last cell is bb, all cells are distinct, and any two consecutive cells are neighbors which are not directly blocked by a wall.'
b"At first, kids will gather in cell (1,1)(1,1), and start the hide-and-seek game. A kid can hide in a cell if and only if that cell is free, it is not (1,1)(1,1), and has exactly one free neighbor. Jaehyun planted roses in the black cells, so it's dangerous if the kids hide there. So Jaehyun wants to create a maze where the kids can only hide in white cells."
b'You are given the map of the garden as input. Your task is to help Jaehyun create a maze.'
b'Input'
b'Your program will be judged in multiple test cases.'
b'The first line contains the number of test cases tt. (1\xe2\x89\xa4t\xe2\x89\xa41001\xe2\x89\xa4t\xe2\x89\xa4100). Afterward, tt test cases with the described format will be given.'
b'The first line of a test contains two integers n,mn,m (2\xe2\x89\xa4n,m\xe2\x89\xa4202\xe2\x89\xa4n,m\xe2\x89\xa420), the size of the grid.'
b'In the next nn line of a test contains a string of length mm, consisting of the following characters (without any whitespace): '
b'  O: A free cell.  X: A rock. '
b'It is guaranteed that the first cell (cell (1,1)(1,1)) is free, and every free cell is reachable from (1,1)(1,1). '
b'If t\xe2\x89\xa52t\xe2\x89\xa52 is satisfied, then the size of the grid will satisfy n\xe2\x89\xa410,m\xe2\x89\xa410n\xe2\x89\xa410,m\xe2\x89\xa410. In other words, if any grid with size n>10n>10 or m>10m>10 is given as an input, then it will be the only input on the test case (t=1t=1).'
b'Output'
b'For each test case, print the following:'
b'If there are no possible mazes, print a single line NO.'
b'Otherwise, print a single line YES, followed by a grid of size (2n\xe2\x88\x921)\xc3\x97(2m\xe2\x88\x921)(2n\xe2\x88\x921)\xc3\x97(2m\xe2\x88\x921) denoting the found maze. The rules for displaying the maze follows. All cells are indexed in 1-base.'
b"  For all 1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m, if the cell (i,j)(i,j) is free cell, print 'O' in the cell (2i\xe2\x88\x921,2j\xe2\x88\x921)(2i\xe2\x88\x921,2j\xe2\x88\x921). Otherwise, print 'X' in the cell (2i\xe2\x88\x921,2j\xe2\x88\x921)(2i\xe2\x88\x921,2j\xe2\x88\x921).  For all 1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x9211\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x921, if the neighboring cell (i,j),(i,j+1)(i,j),(i,j+1) have wall blocking it, print ' ' in the cell (2i\xe2\x88\x921,2j)(2i\xe2\x88\x921,2j). Otherwise, print any printable character except spaces in the cell (2i\xe2\x88\x921,2j)(2i\xe2\x88\x921,2j). A printable character has an ASCII code in range [32,126][32,126]: This includes spaces and alphanumeric characters.  For all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921,1\xe2\x89\xa4j\xe2\x89\xa4m1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921,1\xe2\x89\xa4j\xe2\x89\xa4m, if the neighboring cell (i,j),(i+1,j)(i,j),(i+1,j) have wall blocking it, print '\xc2\xa0' in the cell (2i,2j\xe2\x88\x921)(2i,2j\xe2\x88\x921). Otherwise, print any printable character except spaces in the cell (2i,2j\xe2\x88\x921)(2i,2j\xe2\x88\x921)  For all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x9211\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x921, print any printable character in the cell (2i,2j)(2i,2j). "
b'Please, be careful about trailing newline characters or spaces. Each row of the grid should contain exactly 2m\xe2\x88\x9212m\xe2\x88\x921 characters, and rows should be separated by a newline character. Trailing spaces must not be omitted in a row.'
Tags
graphs, *3300
