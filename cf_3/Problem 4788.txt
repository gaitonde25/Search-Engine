b'ZS the Coder and Chris the Baboon has explored Udayland for quite some time. They realize that it consists of n towns numbered from 1 to n. '
b'There are n directed roads in the Udayland. i-th of them goes from town i to some other town ai (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i). ZS the Coder can flip the direction of any road in Udayland, i.e. if it goes from town A to town B before the flip, it will go from town B to town A after.'
b'ZS the Coder considers the roads in the Udayland confusing, if there is a sequence of distinct towns A1,\xe2\x80\x89A2,\xe2\x80\x89...,\xe2\x80\x89Ak (k\xe2\x80\x89>\xe2\x80\x891) such that for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k there is a road from town Ai to town Ai\xe2\x80\x89+\xe2\x80\x891 and another road from town Ak to town A1. In other words, the roads are confusing if some of them form a directed cycle of some towns.'
b'Now ZS the Coder wonders how many sets of roads (there are 2n variants) in initial configuration can he choose to flip such that after flipping each road in the set exactly once, the resulting network will not be confusing.'
b'Note that it is allowed that after the flipping there are more than one directed road from some town and possibly some towns with no roads leading out of it, or multiple roads between any pair of cities.'
b'Input'
b'The first line of the input contains single integer n (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7105)\xc2\xa0\xe2\x80\x94 the number of towns in Udayland.'
b'The next line contains n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i), ai denotes a road going from town i to town ai.'
b'Output'
b'Print a single integer\xc2\xa0\xe2\x80\x94 the number of ways to flip some set of the roads so that the resulting whole set of all roads is not confusing. Since this number may be too large, print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.'
Tags
combinatorics, dfs and similar, graphs, math, *1900
