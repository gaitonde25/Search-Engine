b'Sagheer is playing a game with his best friend Soliman. He brought a tree with n nodes numbered from 1 to n and rooted at node 1. The i-th node has ai apples. This tree has a special property: the lengths of all paths from the root to any leaf have the same parity (i.e. all paths have even length or all paths have odd length).'
b"Sagheer and Soliman will take turns to play. Soliman will make the first move. The player who can't make a move loses."
b'In each move, the current player will pick a single node, take a non-empty subset of apples from it and do one of the following two things:'
b'  eat the apples, if the node is a leaf.  move the apples to one of the children, if the node is non-leaf. '
b'Before Soliman comes to start playing, Sagheer will make exactly one change to the tree. He will pick two different nodes u and v and swap the apples of u with the apples of v.'
b'Can you help Sagheer count the number of ways to make the swap (i.e. to choose u and v) after which he will win the game if both players play optimally? (u,\xe2\x80\x89v) and (v,\xe2\x80\x89u) are considered to be the same pair.'
b'Input'
b'The first line will contain one integer n (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105) \xe2\x80\x94 the number of nodes in the apple tree.'
b'The second line will contain n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89107) \xe2\x80\x94 the number of apples on each node of the tree.'
b'The third line will contain n\xe2\x80\x89-\xe2\x80\x891 integers p2,\xe2\x80\x89p3,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 the parent of each node of the tree. Node i has parent pi (for 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Node 1 is the root of the tree.'
b'It is guaranteed that the input describes a valid tree, and the lengths of all paths from the root to any leaf will have the same parity.'
b'Output'
b'On a single line, print the number of different pairs of nodes (u,\xe2\x80\x89v), u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v such that if they start playing after swapping the apples of both nodes, Sagheer will win the game. (u,\xe2\x80\x89v) and (v,\xe2\x80\x89u) are considered to be the same pair.'
Tags
games, trees, *2300
