b'You may know that Euclid was a mathematician. Well, as it turns out, Morpheus knew it too. So when he wanted to play a mean trick on Euclid, he sent him an appropriate nightmare. '
b'In his bad dream Euclid has a set SS of nn mm-dimensional vectors over the Z2Z2 field and can perform vector addition on them. In other words he has vectors with mm coordinates, each one equal either 00 or 11. Vector addition is defined as follows: let u+v=wu+v=w, then wi=(ui+vi)mod2wi=(ui+vi)mod2. '
b'Euclid can sum any subset of SS and archive another mm-dimensional vector over Z2Z2. In particular, he can sum together an empty subset; in such a case, the resulting vector has all coordinates equal 00.'
b'Let TT be the set of all the vectors that can be written as a sum of some vectors from SS. Now Euclid wonders the size of TT and whether he can use only a subset S\xe2\x80\xb2S\xe2\x80\xb2 of SS to obtain all the vectors from TT. As it is usually the case in such scenarios, he will not wake up until he figures this out. So far, things are looking rather grim for the philosopher. But there is hope, as he noticed that all vectors in SS have at most 22 coordinates equal 11. '
b'Help Euclid and calculate |T||T|, the number of mm-dimensional vectors over Z2Z2 that can be written as a sum of some vectors from SS. As it can be quite large, calculate it modulo 109+7109+7. You should also find S\xe2\x80\xb2S\xe2\x80\xb2, the smallest such subset of SS, that all vectors in TT can be written as a sum of vectors from S\xe2\x80\xb2S\xe2\x80\xb2. In case there are multiple such sets with a minimal number of elements, output the lexicographically smallest one with respect to the order in which their elements are given in the input. '
b'Consider sets AA and BB such that |A|=|B||A|=|B|. Let a1,a2,\xe2\x80\xa6a|A|a1,a2,\xe2\x80\xa6a|A| and b1,b2,\xe2\x80\xa6b|B|b1,b2,\xe2\x80\xa6b|B| be increasing arrays of indices elements of AA and BB correspondingly. AA is lexicographically smaller than BB iff there exists such ii that aj=bjaj=bj for all j<ij<i and ai<biai<bi.'
b'Input'
b'In the first line of input, there are two integers nn, mm (1\xe2\x89\xa4n,m\xe2\x89\xa45\xe2\x8b\x851051\xe2\x89\xa4n,m\xe2\x89\xa45\xe2\x8b\x85105) denoting the number of vectors in SS and the number of dimensions. '
b'Next nn lines contain the description of the vectors in SS. In each of them there is an integer kk (1\xe2\x89\xa4k\xe2\x89\xa421\xe2\x89\xa4k\xe2\x89\xa42) and then follow kk distinct integers x1,\xe2\x80\xa6xkx1,\xe2\x80\xa6xk (1\xe2\x89\xa4xi\xe2\x89\xa4m1\xe2\x89\xa4xi\xe2\x89\xa4m). This encodes an mm-dimensional vector having 11s on coordinates x1,\xe2\x80\xa6xkx1,\xe2\x80\xa6xk and 00s on the rest of them.'
b'Among the nn vectors, no two are the same.'
b'Output'
b'In the first line, output two integers: remainder modulo 109+7109+7 of |T||T| and |S\xe2\x80\xb2||S\xe2\x80\xb2|. In the second line, output |S\xe2\x80\xb2||S\xe2\x80\xb2| numbers, indices of the elements of S\xe2\x80\xb2S\xe2\x80\xb2 in ascending order. The elements of SS are numbered from 11 in the order they are given in the input.'
Tags
bitmasks, dfs and similar, dsu, graphs, greedy, math, sortings, *2100
