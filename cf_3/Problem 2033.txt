b'An online contest will soon be held on ForceCoders, a large competitive programming platform. The authors have prepared nn problems; and since the platform is very popular, 998244351998244351 coder from all over the world is going to solve them.'
b'For each problem, the authors estimated the number of people who would solve it: for the ii-th problem, the number of accepted solutions will be between lili and riri, inclusive.'
b'The creator of ForceCoders uses different criteria to determine if the contest is good or bad. One of these criteria is the number of inversions in the problem order. An inversion is a pair of problems (x,y)(x,y) such that xx is located earlier in the contest (x<yx<y), but the number of accepted solutions for yy is strictly greater.'
b'Obviously, both the creator of ForceCoders and the authors of the contest want the contest to be good. Now they want to calculate the probability that there will be no inversions in the problem order, assuming that for each problem ii, any integral number of accepted solutions for it (between lili and riri) is equally probable, and all these numbers are independent.'
b'Input'
b'The first line contains one integer nn (2\xe2\x89\xa4n\xe2\x89\xa4502\xe2\x89\xa4n\xe2\x89\xa450) \xe2\x80\x94 the number of problems in the contest.'
b'Then nn lines follow, the ii-th line contains two integers lili and riri (0\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa49982443510\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4998244351) \xe2\x80\x94 the minimum and maximum number of accepted solutions for the ii-th problem, respectively.'
b'Output'
b'The probability that there will be no inversions in the contest can be expressed as an irreducible fraction xyxy, where yy is coprime with 998244353998244353. Print one integer \xe2\x80\x94 the value of xy\xe2\x88\x921xy\xe2\x88\x921, taken modulo 998244353998244353, where y\xe2\x88\x921y\xe2\x88\x921 is an integer such that yy\xe2\x88\x921\xe2\x89\xa11yy\xe2\x88\x921\xe2\x89\xa11 (mod(mod 998244353)998244353).'
Tags
combinatorics, dp, probabilities, *2700
