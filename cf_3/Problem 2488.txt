b'The main characters have been omitted to be short.'
b'You are given a directed unweighted graph without loops with nn vertexes and a path in it (that path is not necessary simple) given by a sequence p1,p2,\xe2\x80\xa6,pmp1,p2,\xe2\x80\xa6,pm of mm vertexes; for each 1\xe2\x89\xa4i<m1\xe2\x89\xa4i<m there is an arc from pipi to pi+1pi+1.'
b'Define the sequence v1,v2,\xe2\x80\xa6,vkv1,v2,\xe2\x80\xa6,vk of kk vertexes as good, if vv is a subsequence of pp, v1=p1v1=p1, vk=pmvk=pm, and pp is one of the shortest paths passing through the vertexes v1v1, \xe2\x80\xa6\xe2\x80\xa6, vkvk in that order.'
b'A sequence aa is a subsequence of a sequence bb if aa can be obtained from bb by deletion of several (possibly, zero or all) elements. It is obvious that the sequence pp is good but your task is to find the shortest good subsequence.'
b'If there are multiple shortest good subsequences, output any of them.'
b' '
b'Input'
b'The first line contains a single integer nn (2\xe2\x89\xa4n\xe2\x89\xa41002\xe2\x89\xa4n\xe2\x89\xa4100)\xc2\xa0\xe2\x80\x94 the number of vertexes in a graph. '
b"The next nn lines define the graph by an adjacency matrix: the jj-th character in the ii-st line is equal to 11 if there is an arc from vertex ii to the vertex jj else it is equal to 00. It is guaranteed that the graph doesn't contain loops."
b'The next line contains a single integer mm (2\xe2\x89\xa4m\xe2\x89\xa41062\xe2\x89\xa4m\xe2\x89\xa4106)\xc2\xa0\xe2\x80\x94 the number of vertexes in the path. '
b'The next line contains mm integers p1,p2,\xe2\x80\xa6,pmp1,p2,\xe2\x80\xa6,pm (1\xe2\x89\xa4pi\xe2\x89\xa4n1\xe2\x89\xa4pi\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the sequence of vertexes in the path. It is guaranteed that for any 1\xe2\x89\xa4i<m1\xe2\x89\xa4i<m there is an arc from pipi to pi+1pi+1.'
b'Output'
b'In the first line output a single integer kk (2\xe2\x89\xa4k\xe2\x89\xa4m2\xe2\x89\xa4k\xe2\x89\xa4m)\xc2\xa0\xe2\x80\x94 the length of the shortest good subsequence. In the second line output kk integers v1v1, \xe2\x80\xa6\xe2\x80\xa6, vkvk (1\xe2\x89\xa4vi\xe2\x89\xa4n1\xe2\x89\xa4vi\xe2\x89\xa4n)\xc2\xa0\xe2\x80\x94 the vertexes in the subsequence. If there are multiple shortest subsequences, print any. Any two consecutive numbers should be distinct.'
Tags
dp, graphs, greedy, shortest paths, *1700
