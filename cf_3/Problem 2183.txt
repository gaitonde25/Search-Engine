b'There are nn people in this world, conveniently numbered 11 through nn. They are using burles to buy goods and services. Occasionally, a person might not have enough currency to buy what he wants or needs, so he borrows money from someone else, with the idea that he will repay the loan later with interest. Let d(a,b)d(a,b) denote the debt of aa towards bb, or 00 if there is no such debt.'
b'Sometimes, this becomes very complex, as the person lending money can run into financial troubles before his debtor is able to repay his debt, and finds himself in the need of borrowing money. '
b'When this process runs for a long enough time, it might happen that there are so many debts that they can be consolidated. There are two ways this can be done:'
b'  Let d(a,b)>0d(a,b)>0 and d(c,d)>0d(c,d)>0 such that a\xe2\x89\xa0ca\xe2\x89\xa0c or b\xe2\x89\xa0db\xe2\x89\xa0d. We can decrease the d(a,b)d(a,b) and d(c,d)d(c,d) by\xc2\xa0zz and increase d(c,b)d(c,b) and d(a,d)d(a,d) by\xc2\xa0zz, where 0<z\xe2\x89\xa4min(d(a,b),d(c,d))0<z\xe2\x89\xa4min(d(a,b),d(c,d)).  Let d(a,a)>0d(a,a)>0. We can set d(a,a)d(a,a) to 00. '
b'The total debt is defined as the sum of all debts:'
b'\xce\xa3d=\xe2\x88\x91a,bd(a,b)\xce\xa3d=\xe2\x88\x91a,bd(a,b)'
b"Your goal is to use the above rules in any order any number of times, to make the total debt as small as possible. Note that you don't have to minimise the number of non-zero debts, only the total debt."
b'Input'
b'The first line contains two space separated integers nn\xc2\xa0(1\xe2\x89\xa4n\xe2\x89\xa41051\xe2\x89\xa4n\xe2\x89\xa4105) and mm\xc2\xa0(0\xe2\x89\xa4m\xe2\x89\xa43\xe2\x8b\x851050\xe2\x89\xa4m\xe2\x89\xa43\xe2\x8b\x85105), representing the number of people and the number of debts, respectively.'
b'mm lines follow, each of which contains three space separated integers uiui, vivi\xc2\xa0(1\xe2\x89\xa4ui,vi\xe2\x89\xa4n,ui\xe2\x89\xa0vi1\xe2\x89\xa4ui,vi\xe2\x89\xa4n,ui\xe2\x89\xa0vi), didi\xc2\xa0(1\xe2\x89\xa4di\xe2\x89\xa41091\xe2\x89\xa4di\xe2\x89\xa4109), meaning that the person uiui borrowed didi burles from person vivi.'
b'Output'
b'On the first line print an integer m\xe2\x80\xb2m\xe2\x80\xb2\xc2\xa0(0\xe2\x89\xa4m\xe2\x80\xb2\xe2\x89\xa43\xe2\x8b\x851050\xe2\x89\xa4m\xe2\x80\xb2\xe2\x89\xa43\xe2\x8b\x85105), representing the number of debts after the consolidation. It can be shown that an answer always exists with this additional constraint.'
b'After that print m\xe2\x80\xb2m\xe2\x80\xb2 lines, ii-th of which contains three space separated integers ui,vi,diui,vi,di, meaning that the person uiui owes the person vivi exactly didi burles. The output must satisfy 1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n, ui\xe2\x89\xa0viui\xe2\x89\xa0vi and 0<di\xe2\x89\xa410180<di\xe2\x89\xa41018.'
b'For each pair i\xe2\x89\xa0ji\xe2\x89\xa0j, it should hold that ui\xe2\x89\xa0ujui\xe2\x89\xa0uj or vi\xe2\x89\xa0vjvi\xe2\x89\xa0vj. In other words, each pair of people can be included at most once in the output.'
Tags
constructive algorithms, data structures, graphs, greedy, implementation, math, two pointers, *2000
