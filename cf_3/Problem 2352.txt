b'Your program fails again. This time it gets "Wrong answer on test 233"'
b'.'
b'This is the harder version of the problem. In this version, 1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105. You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problems.'
b'The problem is to finish nn one-choice-questions. Each of the questions contains kk options, and only one of them is correct. The answer to the ii-th question is hihi, and if your answer of the question ii is hihi, you earn 11 point, otherwise, you earn 00 points for this question. The values h1,h2,\xe2\x80\xa6,hnh1,h2,\xe2\x80\xa6,hn are known to you in this problem.'
b'However, you have a mistake in your program. It moves the answer clockwise! Consider all the nn answers are written in a circle. Due to the mistake in your program, they are shifted by one cyclically.'
b'Formally, the mistake moves the answer for the question ii to the question imodn+1imodn+1. So it moves the answer for the question 11 to question 22, the answer for the question 22 to the question 33, ..., the answer for the question nn to the question 11.'
b'We call all the nn answers together an answer suit. There are knkn possible answer suits in total.'
b"You're wondering, how many answer suits satisfy the following condition: after moving clockwise by 11, the total number of points of the new answer suit is strictly larger than the number of points of the old one. You need to find the answer modulo 998244353998244353."
b'For example, if n=5n=5, and your answer suit is a=[1,2,3,4,5]a=[1,2,3,4,5], it will submitted as a\xe2\x80\xb2=[5,1,2,3,4]a\xe2\x80\xb2=[5,1,2,3,4] because of a mistake. If the correct answer suit is h=[5,2,2,3,4]h=[5,2,2,3,4], the answer suit aa earns 11 point and the answer suite a\xe2\x80\xb2a\xe2\x80\xb2 earns 44 points. Since 4>14>1, the answer suit a=[1,2,3,4,5]a=[1,2,3,4,5] should be counted.'
b'Input'
b'The first line contains two integers nn, kk (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105, 1\xe2\x89\xa4k\xe2\x89\xa41091\xe2\x89\xa4k\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the number of questions and the number of possible answers to each question.'
b'The following line contains nn integers h1,h2,\xe2\x80\xa6,hnh1,h2,\xe2\x80\xa6,hn, (1\xe2\x89\xa4hi\xe2\x89\xa4k)1\xe2\x89\xa4hi\xe2\x89\xa4k)\xc2\xa0\xe2\x80\x94 answers to the questions.'
b'Output'
b'Output one integer: the number of answers suits satisfying the given condition, modulo 998244353998244353.'
Tags
combinatorics, math, *2400
