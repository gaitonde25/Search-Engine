b'The United Federation of Planets is an alliance of NN planets, they are indexed from 11 to NN. Some planets are connected by space tunnels. In a space tunnel, a starship can fly both ways really fast. There are exactly N\xe2\x88\x921N\xe2\x88\x921 space tunnels, and we can travel from any planet to any other planet in the Federation using these tunnels.'
b"It's well known that there are DD additional parallel universes. These are exact copies of our universe, they have the same planets and space tunnels. They are indexed from 11 to DD (our universe has index 00). We denote the planet xx in universe ii by PixPxi. We can travel from one universe to another using dimension portals. For every ii (0\xe2\x89\xa4i\xe2\x89\xa4D\xe2\x88\x9210\xe2\x89\xa4i\xe2\x89\xa4D\xe2\x88\x921), we will place exactly one portal that allows us to fly from PiAiPAii to Pi+1BiPBii+1, for some planet indices AiAi and BiBi (i.e. 1\xe2\x89\xa4Ai,Bi\xe2\x89\xa4N1\xe2\x89\xa4Ai,Bi\xe2\x89\xa4N)."
b"Once all the portals are placed, Starship Batthy\xc3\xa1ny will embark on its maiden voyage. It is currently orbiting around P01P10. Captain \xc3\x81gnes and Lieutenant G\xc3\xa1bor have decided to play the following game: they choose alternately a destination (a planet) to fly to. This planet can be in the same universe, if a space tunnel goes there, or it can be in another universe, if a portal goes there. Their aim is to visit places where no one has gone before. That's why, once they have visited a planet PixPxi, they never go back there (but they can visit the planet xx in another universe). Captain \xc3\x81gnes chooses the first destination (then G\xc3\xa1bor, then \xc3\x81gnes etc.). If somebody can't choose a planet where they have not been before in his/her turn, he/she loses."
b'Captain \xc3\x81gnes and Lieutenant G\xc3\xa1bor are both very clever: they know the locations of all tunnels and portals, and they both play optimally. For how many different placements of portals does Captain \xc3\x81gnes win the game? Two placements are different if there is an index ii (0\xe2\x89\xa4i\xe2\x89\xa4D\xe2\x88\x9210\xe2\x89\xa4i\xe2\x89\xa4D\xe2\x88\x921), where the iith portal connects different pairs of planets in the two placements (i.e AiAi or BiBi differs).'
b'This number can be very big, so we are interested in it modulo 109+7109+7.'
b'Input'
b'The first line contains two space-separated integers, NN (1\xe2\x89\xa4N\xe2\x89\xa41051\xe2\x89\xa4N\xe2\x89\xa4105) \xe2\x80\x93 the number of planets and DD (1\xe2\x89\xa4D\xe2\x89\xa410181\xe2\x89\xa4D\xe2\x89\xa41018) \xe2\x80\x93 the number of additional parallel universes.  Each of the next N\xe2\x88\x921N\xe2\x88\x921 lines contains two space-separated integers uu and vv (1\xe2\x89\xa4u,v\xe2\x89\xa4N1\xe2\x89\xa4u,v\xe2\x89\xa4N), denoting that PiuPui and PivPvi are connected by a space tunnel for all ii (0\xe2\x89\xa4i\xe2\x89\xa4D0\xe2\x89\xa4i\xe2\x89\xa4D).'
b'Output'
b'You should print a single integer, the number of possible placements of portals where Captain \xc3\x81gnes wins modulo 109+7109+7.'
Tags
*special problem, combinatorics, dfs and similar, dp, games, graphs, matrices, trees, *2600
