b'You stumbled upon a new kind of chess puzzles. The chessboard you are given is not necesserily 8\xc3\x9788\xc3\x978, but it still is N\xc3\x97NN\xc3\x97N. Each square has some number written on it, all the numbers are from 11 to N2N2 and all the numbers are pairwise distinct. The jj-th square in the ii-th row has a number AijAij written on it.'
b'In your chess set you have only three pieces: a knight, a bishop and a rook. At first, you put one of them on the square with the number 11 (you can choose which one). Then you want to reach square 22 (possibly passing through some other squares in process), then square 33 and so on until you reach square N2N2. In one step you are allowed to either make a valid move with the current piece or replace it with some other piece. Each square can be visited arbitrary number of times.'
b'A knight can move to a square that is two squares away horizontally and one square vertically, or two squares vertically and one square horizontally. A bishop moves diagonally. A rook moves horizontally or vertically. The move should be performed to a different square from the one a piece is currently standing on.'
b'You want to minimize the number of steps of the whole traversal. Among all the paths to have the same number of steps you want to choose the one with the lowest number of piece replacements.'
b'What is the path you should take to satisfy all conditions?'
b'Input'
b'The first line contains a single integer NN (3\xe2\x89\xa4N\xe2\x89\xa4103\xe2\x89\xa4N\xe2\x89\xa410) \xe2\x80\x94 the size of the chessboard.'
b'Each of the next NN lines contains NN integers Ai1,Ai2,\xe2\x80\xa6,AiNAi1,Ai2,\xe2\x80\xa6,AiN (1\xe2\x89\xa4Aij\xe2\x89\xa4N21\xe2\x89\xa4Aij\xe2\x89\xa4N2) \xe2\x80\x94 the numbers written on the squares of the ii-th row of the board.'
b'It is guaranteed that all AijAij are pairwise distinct.'
b'Output'
b'The only line should contain two integers \xe2\x80\x94 the number of steps in the best answer and the number of replacement moves in it.'
Tags
dfs and similar, dp, shortest paths, *2200
