b'You are given a directed graph of nn vertices and mm edges. Vertices are numbered from 11 to nn. There is a token in vertex 11.'
b'The following actions are allowed: '
b'  Token movement. To move the token from vertex uu to vertex vv if there is an edge u\xe2\x86\x92vu\xe2\x86\x92v in the graph. This action takes 11 second.  Graph transposition. To transpose all the edges in the graph: replace each edge u\xe2\x86\x92vu\xe2\x86\x92v by an edge v\xe2\x86\x92uv\xe2\x86\x92u. This action takes increasingly more time: kk-th transposition takes 2k\xe2\x88\x9212k\xe2\x88\x921 seconds, i.e. the first transposition takes 11 second, the second one takes 22 seconds, the third one takes 44 seconds, and so on. '
b'The goal is to move the token from vertex 11 to vertex nn in the shortest possible time. Print this time modulo 998244353998244353.'
b'Input'
b'The first line of input contains two integers n,mn,m (1\xe2\x89\xa4n,m\xe2\x89\xa42000001\xe2\x89\xa4n,m\xe2\x89\xa4200000).'
b'The next mm lines contain two integers each: u,vu,v (1\xe2\x89\xa4u,v\xe2\x89\xa4n;u\xe2\x89\xa0v1\xe2\x89\xa4u,v\xe2\x89\xa4n;u\xe2\x89\xa0v), which represent the edges of the graph. It is guaranteed that all ordered pairs (u,v)(u,v) are distinct.'
b'It is guaranteed that it is possible to move the token from vertex 11 to vertex nn using the actions above.'
b'Output'
b'Print one integer: the minimum required time modulo 998244353998244353.'
Tags
dfs and similar, graphs, greedy, shortest paths, *2400
