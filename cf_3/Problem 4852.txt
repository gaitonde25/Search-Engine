b'Barney is searching for his dream girl. He lives in NYC. NYC has n junctions numbered from 1 to n and n\xe2\x80\x89-\xe2\x80\x891 roads connecting them. We will consider the NYC as a rooted tree with root being junction 1. m girls live in NYC, i-th of them lives along junction ci and her weight initially equals i pounds.'
b'  '
b'Barney consider a girl x to be better than a girl y if and only if: girl x has weight strictly less than girl y or girl x and girl y have equal weights and index of girl x living junction index is strictly less than girl y living junction index, i.e. cx\xe2\x80\x89<\xe2\x80\x89cy. Thus for any two girls one of them is always better than another one.'
b'For the next q days, one event happens each day. There are two types of events:'
b'  Barney goes from junction v to junction u. As a result he picks at most k best girls he still have not invited from junctions on his way and invites them to his house to test if one of them is his dream girl. If there are less than k not invited girls on his path, he invites all of them. Girls living along junctions in subtree of junction v (including v itself) put on some weight. As result, their weights increase by k pounds. '
b'Your task is for each event of first type tell Barney the indices of girls he will invite to his home in this event.'
b'Input'
b'The first line of input contains three integers n, m and q (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89m,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105)\xc2\xa0\xe2\x80\x94 the number of junctions in NYC, the number of girls living in NYC and the number of events respectively.'
b'The next n\xe2\x80\x89-\xe2\x80\x891 lines describes the roads. Each line contains two integers v and u (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v,\xe2\x80\x89u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u) meaning that there is a road connecting junctions v and u .'
b"The next line contains m integers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cm (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)\xc2\xa0\xe2\x80\x94 the girl's living junctions."
b'The next q lines describe the events in chronological order. Each line starts with an integer t (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892)\xc2\xa0\xe2\x80\x94 type of the event .'
b"If t\xe2\x80\x89=\xe2\x80\x891 then the line describes event of first type three integers v, u and k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v,\xe2\x80\x89u,\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) follow\xc2\xa0\xe2\x80\x94 the endpoints of Barney's path and the number of girls that he will invite at most."
b"Otherwise the line describes event of second type and two integers v and k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89109) follow\xc2\xa0\xe2\x80\x94 the root of the subtree and value by which all the girls' weights in the subtree should increase."
b'Output'
b"For each event of the first type, print number t and then t integers g1,\xe2\x80\x89g2,\xe2\x80\x89...,\xe2\x80\x89gt in one line, meaning that in this event Barney will invite t girls whose indices are g1,\xe2\x80\x89...,\xe2\x80\x89gt in the order from the best to the worst according to Barney's considerations."
Tags
data structures, dsu, trees, *3000
