b'Guy-Manuel and Thomas are planning 144144 trips around the world.'
b"You are given a simple weighted undirected connected graph with nn vertexes and mm edges with the following restriction: there isn't any simple cycle (i. e. a cycle which doesn't pass through any vertex more than once) of length greater than 33 which passes through the vertex 11. The cost of a path (not necessarily simple) in this graph is defined as the XOR of weights of all edges in that path with each edge being counted as many times as the path passes through it."
b"But the trips with cost 00 aren't exciting. "
b'You may choose any subset of edges incident to the vertex 11 and remove them. How many are there such subsets, that, when removed, there is not any nontrivial cycle with the cost equal to 00 which passes through the vertex 11 in the resulting graph? A cycle is called nontrivial if it passes through some edge odd number of times. As the answer can be very big, output it modulo 109+7109+7.'
b'Input'
b"The first line contains two integers nn and mm (1\xe2\x89\xa4n,m\xe2\x89\xa41051\xe2\x89\xa4n,m\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of vertexes and edges in the graph. The ii-th of the next mm lines contains three integers aiai, bibi and wiwi (1\xe2\x89\xa4ai,bi\xe2\x89\xa4n,ai\xe2\x89\xa0bi,0\xe2\x89\xa4wi<321\xe2\x89\xa4ai,bi\xe2\x89\xa4n,ai\xe2\x89\xa0bi,0\xe2\x89\xa4wi<32)\xc2\xa0\xe2\x80\x94 the endpoints of the ii-th edge and its weight. It's guaranteed there aren't any multiple edges, the graph is connected and there isn't any simple cycle of length greater than 33 which passes through the vertex 11."
b'Output'
b'Output the answer modulo 109+7109+7.'
Tags
bitmasks, combinatorics, dfs and similar, dp, graphs, graphs, math, trees, *3000
