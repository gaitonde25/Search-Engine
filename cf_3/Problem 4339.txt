b'Tired of boring dates, Leha and Noora decided to play a game.'
b'Leha found a tree with n vertices numbered from 1 to n. We remind you that tree is an undirected graph without cycles. Each vertex v of a tree has a number av written on it. Quite by accident it turned out that all values written on vertices are distinct and are natural numbers between 1 and n.'
b"The game goes in the following way. Noora chooses some vertex u of a tree uniformly at random and passes a move to Leha. Leha, in his turn, chooses (also uniformly at random) some vertex v from remaining vertices of a tree (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u). As you could guess there are n(n\xe2\x80\x89-\xe2\x80\x891) variants of choosing vertices by players. After that players calculate the value of a function f(u,\xe2\x80\x89v)\xe2\x80\x89=\xe2\x80\x89\xcf\x86(au\xc2\xb7av) \xc2\xb7 d(u,\xe2\x80\x89v) of the chosen vertices where \xcf\x86(x) is Euler's totient function and d(x,\xe2\x80\x89y) is the shortest distance between vertices x and y in a tree."
b'Soon the game became boring for Noora, so Leha decided to defuse the situation and calculate expected value of function f over all variants of choosing vertices u and v, hoping of at least somehow surprise the girl.'
b'Leha asks for your help in calculating this expected value. Let this value be representable in the form of an irreducible fraction . To further surprise Noora, he wants to name her the value . '
b'Help Leha!'
b'Input'
b'The first line of input contains one integer number n (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7105) \xc2\xa0\xe2\x80\x94 number of vertices in a tree.'
b'The second line contains n different numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) separated by spaces, denoting the values written on a tree vertices.'
b'Each of the next n\xe2\x80\x89-\xe2\x80\x891 lines contains two integer numbers x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), describing the next edge of a tree. It is guaranteed that this set of edges describes a tree.'
b'Output'
b'In a single line print a number equal to P\xc2\xb7Q\xe2\x80\x89-\xe2\x80\x891 modulo 109\xe2\x80\x89+\xe2\x80\x897.'
Tags
divide and conquer, math, number theory, trees, *3100
