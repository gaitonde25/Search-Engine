b'Consider the insertion sort algorithm used to sort an integer sequence [a1,a2,\xe2\x80\xa6,an][a1,a2,\xe2\x80\xa6,an] of length nn in non-decreasing order.'
b"For each ii in order from 22 to nn, do the following. If ai\xe2\x89\xa5ai\xe2\x88\x921ai\xe2\x89\xa5ai\xe2\x88\x921, do nothing and move on to the next value of ii. Otherwise, find the smallest jj such that ai<ajai<aj, shift the elements on positions from jj to i\xe2\x88\x921i\xe2\x88\x921 by one position to the right, and write down the initial value of aiai to position jj. In this case we'll say that we performed an insertion of an element from position ii to position jj."
b'It can be noticed that after processing any ii, the prefix of the sequence [a1,a2,\xe2\x80\xa6,ai][a1,a2,\xe2\x80\xa6,ai] is sorted in non-decreasing order, therefore, the algorithm indeed sorts any sequence.'
b'For example, sorting [4,5,3,1,3][4,5,3,1,3] proceeds as follows: '
b'  i=2i=2: a2\xe2\x89\xa5a1a2\xe2\x89\xa5a1, do nothing;  i=3i=3: j=1j=1, insert from position 33 to position 11: [3,4,5,1,3][3,4,5,1,3];  i=4i=4: j=1j=1, insert from position 44 to position 11: [1,3,4,5,3][1,3,4,5,3];  i=5i=5: j=3j=3, insert from position 55 to position 33: [1,3,3,4,5][1,3,3,4,5]. '
b'You are given an integer nn and a list of mm integer pairs (xi,yi)(xi,yi). We are interested in sequences such that if you sort them using the above algorithm, exactly mm insertions will be performed: first from position x1x1 to position y1y1, then from position x2x2 to position y2y2, ..., finally, from position xmxm to position ymym.'
b'How many sequences of length nn consisting of (not necessarily distinct) integers between 11 and nn, inclusive, satisfy the above condition? Print this number modulo 998244353998244353.'
b'Input'
b'Each test contains multiple test cases. The first line contains the number of test cases tt (1\xe2\x89\xa4t\xe2\x89\xa41051\xe2\x89\xa4t\xe2\x89\xa4105). Description of the test cases follows.'
b'The first line of each test case contains two integers nn and mm (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105; 0\xe2\x89\xa4m<n0\xe2\x89\xa4m<n)\xc2\xa0\xe2\x80\x94 the length of the sequence and the number of insertions.'
b'The ii-th of the following mm lines contains two integers xixi and yiyi (2\xe2\x89\xa4x1<x2<\xe2\x80\xa6<xm\xe2\x89\xa4n2\xe2\x89\xa4x1<x2<\xe2\x80\xa6<xm\xe2\x89\xa4n; 1\xe2\x89\xa4yi<xi1\xe2\x89\xa4yi<xi). These lines describe the sequence of insertions in chronological order.'
b'It is guaranteed that the sum of mm over all test cases does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105. Note that there is no constraint on the sum of nn of the same kind.'
b'Output'
b'For each test case, print the number of sequences of length nn consisting of integers from 11 to nn such that sorting them with the described algorithm produces the given sequence of insertions, modulo 998244353998244353.'
Tags
combinatorics, data structures, *2600
