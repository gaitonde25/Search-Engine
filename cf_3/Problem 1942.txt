b'This is a harder version of the problem. In this version n\xe2\x89\xa4500000n\xe2\x89\xa4500000'
b'The outskirts of the capital are being actively built up in Berland. The company "Kernel Panic" manages the construction of a residential complex of skyscrapers in New Berlskva. All skyscrapers are built along the highway. It is known that the company has already bought nn plots along the highway and is preparing to build nn skyscrapers, one skyscraper per plot.'
b'Architects must consider several requirements when planning a skyscraper. Firstly, since the land on each plot has different properties, each skyscraper has a limit on the largest number of floors it can have. Secondly, according to the design code of the city, it is unacceptable for a skyscraper to simultaneously have higher skyscrapers both to the left and to the right of it.'
b"Formally, let's number the plots from 11 to nn. Then if the skyscraper on the ii-th plot has aiai floors, it must hold that aiai is at most mimi (1\xe2\x89\xa4ai\xe2\x89\xa4mi1\xe2\x89\xa4ai\xe2\x89\xa4mi). Also there mustn't be integers jj and kk such that j<i<kj<i<k and aj>ai<akaj>ai<ak. Plots jj and kk are not required to be adjacent to ii."
b'The company wants the total number of floors in the built skyscrapers to be as large as possible. Help it to choose the number of floors for each skyscraper in an optimal way, i.e. in such a way that all requirements are fulfilled, and among all such construction plans choose any plan with the maximum possible total number of floors.'
b'Input'
b'The first line contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa45000001\xe2\x89\xa4n\xe2\x89\xa4500000)\xc2\xa0\xe2\x80\x94 the number of plots.'
b'The second line contains the integers m1,m2,\xe2\x80\xa6,mnm1,m2,\xe2\x80\xa6,mn (1\xe2\x89\xa4mi\xe2\x89\xa41091\xe2\x89\xa4mi\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the limit on the number of floors for every possible number of floors for a skyscraper on each plot.'
b'Output'
b'Print nn integers aiai\xc2\xa0\xe2\x80\x94 the number of floors in the plan for each skyscraper, such that all requirements are met, and the total number of floors in all skyscrapers is the maximum possible.'
b'If there are multiple answers possible, print any of them.'
Tags
data structures, dp, greedy, *1900
