b'There is a grid with rr rows and cc columns, where the square on the ii-th row and jj-th column has an integer ai,jai,j written on it. Initially, all elements are set to 00. We are allowed to do the following operation:'
b'  Choose indices 1\xe2\x89\xa4i\xe2\x89\xa4r1\xe2\x89\xa4i\xe2\x89\xa4r and 1\xe2\x89\xa4j\xe2\x89\xa4c1\xe2\x89\xa4j\xe2\x89\xa4c, then replace all values on the same row or column as (i,j)(i,j) with the value xor 11. In other words, for all ax,yax,y where x=ix=i or y=jy=j or both, replace ax,yax,y with ax,yax,y xor 11. '
b"You want to form grid bb by doing the above operations a finite number of times. However, some elements of bb are missing and are replaced with '?' instead."
b"Let kk be the number of '?' characters. Among all the 2k2k ways of filling up the grid bb by replacing each '?' with '0' or '1', count the number of grids, that can be formed by doing the above operation a finite number of times, starting from the grid filled with 00. As this number can be large, output it modulo 998244353998244353."
b'Input'
b'The first line contains two integers rr and cc (1\xe2\x89\xa4r,c\xe2\x89\xa420001\xe2\x89\xa4r,c\xe2\x89\xa42000) \xc2\xa0\xe2\x80\x94 the number of rows and columns of the grid respectively.'
b'The ii-th of the next rr lines contain cc characters bi,1,bi,2,\xe2\x80\xa6,bi,cbi,1,bi,2,\xe2\x80\xa6,bi,c (bi,j\xe2\x88\x88{0,1,?}bi,j\xe2\x88\x88{0,1,?}).'
b'Output'
b'Print a single integer representing the number of ways to fill up grid bb modulo 998244353998244353.'
Tags
constructive algorithms, graphs, math, matrices, *3200
