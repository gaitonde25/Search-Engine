b'Integer factorisation is hard. The RSA Factoring Challenge offered $100000$100000 for factoring RSA-10241024, a 10241024-bit long product of two prime numbers. To this date, nobody was able to claim the prize. We want you to factorise a 10241024-bit number.'
b'Since your programming language of choice might not offer facilities for handling large integers, we will provide you with a very simple calculator. '
b'To use this calculator, you can print queries on the standard output and retrieve the results from the standard input. The operations are as follows: '
b'  + x y where xx and yy are integers between 00 and n\xe2\x88\x921n\xe2\x88\x921. Returns (x+y)modn(x+y)modn.  - x y where xx and yy are integers between 00 and n\xe2\x88\x921n\xe2\x88\x921. Returns (x\xe2\x88\x92y)modn(x\xe2\x88\x92y)modn.  * x y where xx and yy are integers between 00 and n\xe2\x88\x921n\xe2\x88\x921. Returns (x\xe2\x8b\x85y)modn(x\xe2\x8b\x85y)modn.  / x y where xx and yy are integers between 00 and n\xe2\x88\x921n\xe2\x88\x921 and yy is coprime with nn. Returns (x\xe2\x8b\x85y\xe2\x88\x921)modn(x\xe2\x8b\x85y\xe2\x88\x921)modn where y\xe2\x88\x921y\xe2\x88\x921 is multiplicative inverse of yy modulo nn. If yy is not coprime with nn, then \xe2\x88\x921\xe2\x88\x921 is returned instead.  sqrt x where xx is integer between 00 and n\xe2\x88\x921n\xe2\x88\x921 coprime with nn. Returns yy such that y2modn=xy2modn=x. If there are multiple such integers, only one of them is returned. If there are none, \xe2\x88\x921\xe2\x88\x921 is returned instead.  ^ x y where xx and yy are integers between 00 and n\xe2\x88\x921n\xe2\x88\x921. Returns xymodnxymodn. '
b'Find the factorisation of nn that is a product of between 22 and 1010 distinct prime numbers, all of form 4x+34x+3 for some integer xx.'
b'Because of technical issues, we restrict number of requests to 100100.'
b'Input'
b'The only line contains a single integer nn\xc2\xa0(21\xe2\x89\xa4n\xe2\x89\xa42102421\xe2\x89\xa4n\xe2\x89\xa421024). It is guaranteed that nn is a product of between 22 and 1010 distinct prime numbers, all of form 4x+34x+3 for some integer xx.'
b'Output'
b'You can print as many queries as you wish, adhering to the time limit (see the Interaction section for more details). '
b'When you think you know the answer, output a single line of form ! k p_1 p_2 ... p_k, where kk is the number of prime factors of nn, and pipi are the distinct prime factors. You may print the factors in any order.'
b'Hacks input'
b'For hacks, use the following format:. '
b'The first should contain kk (2\xe2\x89\xa4k\xe2\x89\xa4102\xe2\x89\xa4k\xe2\x89\xa410)\xc2\xa0\xe2\x80\x94 the number of prime factors of nn. '
b'The second should contain kk space separated integers p1,p2,\xe2\x80\xa6,pkp1,p2,\xe2\x80\xa6,pk (21\xe2\x89\xa4n\xe2\x89\xa42102421\xe2\x89\xa4n\xe2\x89\xa421024)\xc2\xa0\xe2\x80\x94 the prime factors of nn. All prime factors have to be of form 4x+34x+3 for some integer xx. They all have to be distinct. '
Tags
interactive, math, number theory, *3200
