b"Let's consider the following game of Alice and Bob on a directed acyclic graph. Each vertex may contain an arbitrary number of chips. Alice and Bob make turns alternating. Alice goes first. In one turn player can move exactly one chip along any edge outgoing from the vertex that contains this chip to the end of this edge. The one who cannot make a turn loses. Both players play optimally."
b'Consider the following process that takes place every second on a given graph with nn vertices: '
b'  An integer vv is chosen equiprobably from [1,n+1][1,n+1].  If v\xe2\x89\xa4nv\xe2\x89\xa4n, we add a chip to the vv-th vertex and go back to step 1.  If v=n+1v=n+1, Alice and Bob play the game with the current arrangement of chips and the winner is determined. After that, the process is terminated. '
b'Find the probability that Alice will win the game. It can be shown that the answer can be represented as PQPQ, where PP and QQ are coprime integers and Q\xe2\x89\xa1\xcc\xb80(mod998244353)Q\xe2\x89\xa20(mod998244353). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921mod998244353P\xe2\x8b\x85Q\xe2\x88\x921mod998244353.'
b'Input'
b'The first line contains two integers nn and mm\xc2\xa0\xe2\x80\x94 the number of vertices and edges of the graph (1\xe2\x89\xa4n\xe2\x89\xa41051\xe2\x89\xa4n\xe2\x89\xa4105, 0\xe2\x89\xa4m\xe2\x89\xa41050\xe2\x89\xa4m\xe2\x89\xa4105).'
b"The following mm lines contain edges description. The ii-th of them contains two integers uiui and vivi\xc2\xa0\xe2\x80\x94 the beginning and the end vertices of the ii-th edge (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n1\xe2\x89\xa4ui,vi\xe2\x89\xa4n). It's guaranteed that the graph is acyclic."
b'Output'
b'Output a single integer\xc2\xa0\xe2\x80\x94 the probability of Alice victory modulo 998244353998244353.'
Tags
bitmasks, games, math, matrices, *2700
