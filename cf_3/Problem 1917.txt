b'Mayor of city M. decided to launch several new metro lines during 2020. Since the city has a very limited budget, it was decided not to dig new tunnels but to use the existing underground network.'
b"The tunnel system of the city M. consists of nn metro stations. The stations are connected with n\xe2\x88\x921n\xe2\x88\x921 bidirectional tunnels. Between every two stations vv and uu there is exactly one simple path. Each metro line the mayor wants to create is a simple path between stations aiai and bibi. Metro lines can intersects freely, that is, they can share common stations or even common tunnels. However, it's not yet decided which of two directions each line will go. More precisely, between the stations aiai and bibi the trains will go either from aiai to bibi, or from bibi to aiai, but not simultaneously."
b"The city MM uses complicated faring rules. Each station is assigned with a positive integer cici\xc2\xa0\xe2\x80\x94 the fare zone of the station. The cost of travel from vv to uu is defined as cu\xe2\x88\x92cvcu\xe2\x88\x92cv roubles. Of course, such travel only allowed in case there is a metro line, the trains on which go from vv to uu. Mayor doesn't want to have any travels with a negative cost, so it was decided to assign directions of metro lines and station fare zones in such a way, that fare zones are strictly increasing during any travel on any metro line."
b"Mayor wants firstly assign each station a fare zone and then choose a lines direction, such that all fare zones are increasing along any line. In connection with the approaching celebration of the day of the city, the mayor wants to assign fare zones so that the maximum cici will be as low as possible. Please help mayor to design a new assignment or determine if it's impossible to do. Please note that you only need to assign the fare zones optimally, you don't need to print lines' directions. This way, you solution will be considered correct if there will be a way to assign directions of every metro line, so that the fare zones will be strictly increasing along any movement of the trains."
b'Input'
b'The first line contains an integers nn, mm (2\xe2\x89\xa4n,\xe2\x89\xa4500000,\xc2\xa01\xe2\x89\xa4m\xe2\x89\xa45000002\xe2\x89\xa4n,\xe2\x89\xa4500000,\xc2\xa01\xe2\x89\xa4m\xe2\x89\xa4500000)\xc2\xa0\xe2\x80\x94 the number of stations in the city and the number of metro lines.'
b"Each of the following n\xe2\x88\x921n\xe2\x88\x921 lines describes another metro tunnel. Each tunnel is described with integers vivi, uiui (1\xe2\x89\xa4vi,\xc2\xa0ui\xe2\x89\xa4n1\xe2\x89\xa4vi,\xc2\xa0ui\xe2\x89\xa4n, vi\xe2\x89\xa0uivi\xe2\x89\xa0ui). It's guaranteed, that there is exactly one simple path between any two stations."
b'Each of the following mm lines describes another metro line. Each line is described with integers aiai, bibi (1\xe2\x89\xa4ai,\xc2\xa0bi\xe2\x89\xa4n1\xe2\x89\xa4ai,\xc2\xa0bi\xe2\x89\xa4n, ai\xe2\x89\xa0biai\xe2\x89\xa0bi).'
b'Output'
b'In the first line print integer kk\xc2\xa0\xe2\x80\x94 the maximum fare zone used.'
b"In the next line print integers c1,c2,\xe2\x80\xa6,cnc1,c2,\xe2\x80\xa6,cn (1\xe2\x89\xa4ci\xe2\x89\xa4k1\xe2\x89\xa4ci\xe2\x89\xa4k) \xc2\xa0\xe2\x80\x94 stations' fare zones. "
b'In case there are several possible answers, print any of them. In case it\'s impossible to assign fare zones, print "-1".'
Tags
dp, trees, *3500
