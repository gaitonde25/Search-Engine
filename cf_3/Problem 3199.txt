b'Consider some set of distinct characters AA and some string SS, consisting of exactly nn characters, where each character is present in AA.'
b'You are given an array of mm integers bb (b1<b2<\xe2\x8b\xaf<bmb1<b2<\xe2\x8b\xaf<bm). '
b'You are allowed to perform the following move on the string SS:'
b'  Choose some valid ii and set k=bik=bi;  Take the first kk characters of S=PrkS=Prk;  Take the last kk characters of S=SukS=Suk;  Substitute the first kk characters of SS with the reversed SukSuk;  Substitute the last kk characters of SS with the reversed PrkPrk. '
b'For example, let\'s take a look at S=S= "abcdefghi" and k=2k=2. Pr2=Pr2= "ab", Su2=Su2= "hi". Reversed Pr2=Pr2= "ba", Su2=Su2= "ih". Thus, the resulting SS is "ihcdefgba".'
b'The move can be performed arbitrary number of times (possibly zero). Any ii can be selected multiple times over these moves.'
b'Let\'s call some strings SS and TT equal if and only if there exists such a sequence of moves to transmute string SS to string TT. For the above example strings "abcdefghi" and "ihcdefgba" are equal. Also note that this implies S=SS=S.'
b'The task is simple. Count the number of distinct strings.'
b'The answer can be huge enough, so calculate it modulo 998244353998244353.'
b'Input'
b'The first line contains three integers nn, mm and |A||A| (2\xe2\x89\xa4n\xe2\x89\xa41092\xe2\x89\xa4n\xe2\x89\xa4109, 1\xe2\x89\xa4m\xe2\x89\xa4min(n2,2\xe2\x8b\x85105)1\xe2\x89\xa4m\xe2\x89\xa4min(n2,2\xe2\x8b\x85105), 1\xe2\x89\xa4|A|\xe2\x89\xa41091\xe2\x89\xa4|A|\xe2\x89\xa4109) \xe2\x80\x94 the length of the strings, the size of the array bb and the size of the set AA, respectively.'
b'The second line contains mm integers b1,b2,\xe2\x80\xa6,bmb1,b2,\xe2\x80\xa6,bm (1\xe2\x89\xa4bi\xe2\x89\xa4n21\xe2\x89\xa4bi\xe2\x89\xa4n2, b1<b2<\xe2\x8b\xaf<bmb1<b2<\xe2\x8b\xaf<bm).'
b'Output'
b'Print a single integer \xe2\x80\x94 the number of distinct strings of length nn with characters from set AA modulo 998244353998244353.'
Tags
combinatorics, strings, *2300
