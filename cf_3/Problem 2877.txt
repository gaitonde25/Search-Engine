b'Semyon participates in the most prestigious competition of the world ocean for the title of the most dangerous shark. During this competition sharks compete in different subjects: speed swimming, masking, map navigation and many others. Now Semyon is taking part in \xc2\xabdestruction\xc2\xbb contest.'
b'During it, mm dominoes are placed in front of the shark. All dominoes are on the same line, but the height of the dominoes may vary. The distance between adjacent dominoes is 11. Moreover, each Domino has its own cost value, expressed as an integer. The goal is to drop all the dominoes. To do this, the shark can push any domino to the left or to the right, and it will begin falling in this direction. If during the fall the domino touches other dominoes, they will also start falling in the same direction in which the original domino is falling, thus beginning a chain reaction, as a result of which many dominoes can fall. A falling domino touches another one, if and only if the distance between them was strictly less than the height of the falling domino, the dominoes do not necessarily have to be adjacent.'
b'Of course, any shark can easily drop all the dominoes in this way, so the goal is not to drop all the dominoes, but do it with a minimum cost. The cost of the destruction is the sum of the costs of dominoes that the shark needs to push to make all the dominoes fall.'
b'Simon has already won in the previous subjects, but is not smart enough to win in this one. Help Semyon and determine the minimum total cost of the dominoes he will have to push to make all the dominoes fall.'
b'Input'
b'In order to reduce input size, the heights and costs of the dominoes are described with blocks.'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n\xe2\x89\xa4250000,1\xe2\x89\xa4m\xe2\x89\xa41071\xe2\x89\xa4n\xe2\x89\xa4250000,1\xe2\x89\xa4m\xe2\x89\xa4107)\xc2\xa0\xe2\x80\x94 the number of the blocks and the total number of the dominoes Semyon must drop.'
b'Then descriptions of nn blocks follow. Description of every block consists of three lines.'
b"The first line of block's description contains a single integer kiki (1\xe2\x89\xa4ki\xe2\x89\xa4250000,\xe2\x88\x91ni=1ki\xe2\x89\xa42500001\xe2\x89\xa4ki\xe2\x89\xa4250000,\xe2\x88\x91i=1nki\xe2\x89\xa4250000)\xc2\xa0\xe2\x80\x94 the number of dominoes in the block."
b"The second line of block's description contains kiki integers ajaj (1\xe2\x89\xa4aj\xe2\x89\xa4m1\xe2\x89\xa4aj\xe2\x89\xa4m)\xc2\xa0\xe2\x80\x94 the heights of the dominoes in the blocks."
b'The third line contains kiki integers cjcj (1\xe2\x89\xa4cj\xe2\x89\xa41000001\xe2\x89\xa4cj\xe2\x89\xa4100000)\xc2\xa0\xe2\x80\x94 the costs of the dominoes in the block.'
b'Then the domino sequence is described (from left to right).'
b'The first line of this description contains a single integer qq (n\xe2\x89\xa4q\xe2\x89\xa4250000n\xe2\x89\xa4q\xe2\x89\xa4250000)\xc2\xa0\xe2\x80\x94 the number of blocks in the sequence of domino sequence.'
b'Each of the following qq lines contains integers idi,muliidi,muli (1\xe2\x89\xa4idi\xe2\x89\xa4n1\xe2\x89\xa4idi\xe2\x89\xa4n, 1\xe2\x89\xa4muli\xe2\x89\xa41000001\xe2\x89\xa4muli\xe2\x89\xa4100000), denoting that the next kidikidi dominoes are dominoes of the block idiidi, with their cost multiplied by mulimuli.'
b"It's guaranteed, that \xe2\x88\x91qi=1kidi=m\xe2\x88\x91i=1qkidi=m, and that's every block is used in the sequence at least once."
b'Output'
b'Print exactly one integer\xc2\xa0\xe2\x80\x94 the minimum cost to make all the dominoes fall.'
Tags
data structures, dp, two pointers, *2700
