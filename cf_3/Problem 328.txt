b"Railway network of one city consists of nn stations connected by n\xe2\x88\x921n\xe2\x88\x921 roads. These stations and roads forms a tree. Station 11 is a city center. For each road you know the time trains spend to pass this road. You can assume that trains don't spend time on stops. Let's define dist(v)dist(v) as the time that trains spend to get from the station vv to the station 11."
b'This railway network is splitted into zones named by first kk capital latin letters. The zone of the ii-th station is zizi. City center is in the zone A. For all other stations it is guaranteed that the first station on the road from this station to the city center is either in the same zone or in the zone with lexicographically smaller name. Any road is completely owned by the zone of the most distant end from the city center.'
b"Tourist will arrive at the airport soon and then he will go to the city center. Here's how the trip from station vv to station 11 happends: "
b"  At the moment 00, tourist enters the train that follows directly from the station vv to the station 11. The trip will last for dist(v)dist(v) minutes.  Tourist can buy tickets for any subset of zones at any moment. Ticket for zone ii costs passipassi euro.  Every TT minutes since the start of the trip (that is, at the moments T,2T,\xe2\x80\xa6T,2T,\xe2\x80\xa6) the control system will scan tourist. If at the moment of scan tourist is in the zone ii without zone ii ticket, he should pay fineifinei euro. Formally, the zone of tourist is determined in the following way:   If tourist is at the station 11, then he already at the city center so he shouldn't pay fine.  If tourist is at the station u\xe2\x89\xa01u\xe2\x89\xa01, then he is in the zone zuzu.  If tourist is moving from the station xx to the station yy that are directly connected by road, then he is in the zone zxzx.  Note, that tourist can pay fine multiple times in the same zone. "
b'Tourist always selects such way to buy tickets and pay fines that minimizes the total cost of trip. Let f(v)f(v) be such cost for station vv.'
b"Unfortunately, tourist doesn't know the current values of passipassi and fineifinei for different zones and he has forgot the location of the airport. He will ask you queries of 33 types:"
b'  11 ii cc\xc2\xa0\xe2\x80\x94 the cost of ticket in zone ii has changed. Now passipassi is cc.  22 ii cc\xc2\xa0\xe2\x80\x94 the cost of fine in zone ii has changed. Now fineifinei is cc.  33 uu\xc2\xa0\xe2\x80\x94 solve the following problem for current values of passpass and finefine:   You are given the station uu. Consider all the stations vv that satisfy the following conditions:   zv=zuzv=zu  The station uu is on the path from the station vv to the station 11.  Find the value of min(f(v))min(f(v)) over all such stations vv with the following assumption: tourist has the ticket for the zone of station zuzu.  '
b'Input'
b'The first line contains the single integer nn (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of stations.'
b'Each of the next n\xe2\x88\x921n\xe2\x88\x921 lines contains three integers vivi, uiui, titi (1\xe2\x89\xa4vi,ui\xe2\x89\xa4n,1\xe2\x89\xa4ti\xe2\x89\xa41091\xe2\x89\xa4vi,ui\xe2\x89\xa4n,1\xe2\x89\xa4ti\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the ends of the ii-th road and the time it takes a train to pass this road. It is guaranteed that this roads forms a tree.'
b'The next line contains the single integer kk (1\xe2\x89\xa4k\xe2\x89\xa4261\xe2\x89\xa4k\xe2\x89\xa426)\xc2\xa0\xe2\x80\x94 the number of zones.'
b'The next line contains nn symbols z1z2\xe2\x80\xa6znz1z2\xe2\x80\xa6zn\xc2\xa0\xe2\x80\x94 zizi is the name of the zone of the ii-th station. It is guaranteed that the conditions from the second paragraph are satisfied.'
b'The next line contains kk integers pass1pass1, pass2pass2, \xe2\x80\xa6\xe2\x80\xa6, passkpassk (1\xe2\x89\xa4passi\xe2\x89\xa41091\xe2\x89\xa4passi\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 initial costs of tickets.'
b'The next line contains kk integers fine1fine1, fine2fine2, \xe2\x80\xa6\xe2\x80\xa6, finekfinek (1\xe2\x89\xa4finei\xe2\x89\xa41091\xe2\x89\xa4finei\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 initial fines.'
b'The next line contains the single integer TT (1\xe2\x89\xa4T\xe2\x89\xa41091\xe2\x89\xa4T\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the time gap between scans of control system.'
b'The next line contains the single integer qq (1\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of queries.'
b'Next qq lines contains queries as described in the statement. It is guaranteed that in the queries of the first and the second type ii is a correct name of the zone (one of the first kk capital latin letters) and 1\xe2\x89\xa4c\xe2\x89\xa41091\xe2\x89\xa4c\xe2\x89\xa4109, and in the queries of the third type 1\xe2\x89\xa4u\xe2\x89\xa4n1\xe2\x89\xa4u\xe2\x89\xa4n.'
b'Output'
b'For each query of the third type print the answer to it.'
Tags
dfs and similar, graphs, shortest paths, trees, *3500
