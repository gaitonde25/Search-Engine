b'The Committee for Research on Binary Viruses discovered a method of replication for a large family of viruses whose genetic codes are sequences of zeros and ones. Each virus originates from a single gene; for simplicity genes are denoted by integers from 00 to G\xe2\x88\x921G\xe2\x88\x921. At each moment in time a virus is a sequence of genes. When mutation occurs, one of the genes from the sequence is replaced by a certain sequence of genes, according to the mutation table. The virus stops mutating when it consists only of genes 00 and 11.'
b'For instance, for the following mutation table: 2\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xe2\x9f\xa93\xe2\x86\x92\xe2\x9f\xa82\xc2\xa00\xc2\xa00\xe2\x9f\xa93\xe2\x86\x92\xe2\x9f\xa81\xc2\xa03\xe2\x9f\xa94\xe2\x86\x92\xe2\x9f\xa80\xc2\xa03\xc2\xa01\xc2\xa02\xe2\x9f\xa95\xe2\x86\x92\xe2\x9f\xa82\xc2\xa01\xe2\x9f\xa95\xe2\x86\x92\xe2\x9f\xa85\xe2\x9f\xa92\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xe2\x9f\xa93\xe2\x86\x92\xe2\x9f\xa82\xc2\xa00\xc2\xa00\xe2\x9f\xa93\xe2\x86\x92\xe2\x9f\xa81\xc2\xa03\xe2\x9f\xa94\xe2\x86\x92\xe2\x9f\xa80\xc2\xa03\xc2\xa01\xc2\xa02\xe2\x9f\xa95\xe2\x86\x92\xe2\x9f\xa82\xc2\xa01\xe2\x9f\xa95\xe2\x86\x92\xe2\x9f\xa85\xe2\x9f\xa9 a virus that initially consisted of a single gene 44, could have mutated as follows: \xe2\x9f\xa84\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa03\xc2\xa01\xc2\xa02\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa02\xc2\xa00\xc2\xa00\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xc2\xa01\xc2\xa02\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa00\xc2\xa01\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa02\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x9f\xa9\xe2\x9f\xa84\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa03\xc2\xa01\xc2\xa02_\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa02\xc2\xa00\xc2\xa00_\xc2\xa01\xc2\xa02\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa00\xc2\xa01_\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa02\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa01_\xe2\x9f\xa9 or in another way: \xe2\x9f\xa84\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa03\xc2\xa01\xc2\xa02\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xc2\xa03\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xc2\xa01\xc2\xa02\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xc2\xa03\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xc2\xa02\xc2\xa00\xc2\xa00\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x80\x93\xe2\x80\x93\xe2\x80\x93\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x9f\xa9\xe2\x9f\xa84\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa03\xc2\xa01\xc2\xa02_\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xc2\xa03_\xc2\xa01\xc2\xa02\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xc2\xa03\xc2\xa01\xc2\xa00\xc2\xa01_\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xc2\xa02\xc2\xa00\xc2\xa00_\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80\xc2\xa01\xc2\xa00\xc2\xa01_\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x9f\xa9'
b"Viruses are detected by antibodies that identify the presence of specific continuous fragments of zeros and ones in the viruses' codes. For example, an antibody reacting to a fragment \xe2\x9f\xa80\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa00\xe2\x9f\xa9\xe2\x9f\xa80\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa00\xe2\x9f\xa9 will detect a virus \xe2\x9f\xa80\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x9f\xa9\xe2\x9f\xa80\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x9f\xa9, but it will not detect a virus \xe2\x9f\xa80\xc2\xa01\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x9f\xa9\xe2\x9f\xa80\xc2\xa01\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa00\xc2\xa01\xc2\xa00\xc2\xa01\xe2\x9f\xa9."
b'For each gene from 22 to G\xe2\x88\x921G\xe2\x88\x921, the scientists are wondering whether a given set of antibodies is enough to detect all viruses that can emerge through mutations from this gene. If not, they want to know the length of the shortest virus that cannot be detected.'
b"It may happen that sometimes scientists don't have any antibodies. Then of course no virus can be detected, so the scientists are only interested in the length of the shortest possible virus that can emerge from the gene mutations."
b'Input'
b'The first line of the input will contain three integers GG, NN and MM (G>2G>2, N\xe2\x89\xa5G\xe2\x88\x922N\xe2\x89\xa5G\xe2\x88\x922, M\xe2\x89\xa50M\xe2\x89\xa50) specifying the number of genes, the number of rows in the mutation table, and the number of antibodies.'
b'The following NN lines contain descriptions of rows of the mutation table; each line begins with two integers aa and kk (2\xe2\x89\xa4a<G2\xe2\x89\xa4a<G, k\xe2\x89\xa51k\xe2\x89\xa51), followed by a sequence of kk integers b1,b2,\xe2\x80\xa6,bkb1,b2,\xe2\x80\xa6,bk (0\xe2\x89\xa4bi<G0\xe2\x89\xa4bi<G), that encode the row a\xe2\x86\x92\xe2\x9f\xa8b1\xc2\xa0b2\xc2\xa0\xe2\x80\xa6\xc2\xa0bk\xe2\x9f\xa9a\xe2\x86\x92\xe2\x9f\xa8b1\xc2\xa0b2\xc2\xa0\xe2\x80\xa6\xc2\xa0bk\xe2\x9f\xa9'
b'The sum of all values kk does not exceed 100100. Every integer from 22 to G\xe2\x88\x921G\xe2\x88\x921 appears in the table as aa at least once.'
b'The next MM lines contain descriptions of the antibodies; each such line begins with an integer \xe2\x84\x93\xe2\x84\x93 (\xe2\x84\x93\xe2\x89\xa51\xe2\x84\x93\xe2\x89\xa51), followed by a sequence of \xe2\x84\x93\xe2\x84\x93 integers c1,c2,\xe2\x80\xa6,c\xe2\x84\x93c1,c2,\xe2\x80\xa6,c\xe2\x84\x93 (0\xe2\x89\xa4ci\xe2\x89\xa410\xe2\x89\xa4ci\xe2\x89\xa41), describing the antibody. The sum of all values \xe2\x84\x93\xe2\x84\x93 does not exceed 5050.'
b'Output'
b'Your program needs to output exactly G\xe2\x88\x922G\xe2\x88\x922 lines, containing the answers for the subsequent genes from 22 to G\xe2\x88\x921G\xe2\x88\x921.'
b'If all viruses that can mutate from this single gene can be detected by the given set of antibodies, you need to print the word "YES". You also need to print this if there are no viruses that could originate from this gene (it can happen when the sequences never stop mutating).'
b'Otherwise you need to print the word "NO", followed by an integer denoting the minimal length of the undetectable virus. You can assume that for all the prepared input data this value will be smaller than 263263.'
Tags
*special problem, dp, shortest paths, string suffix structures, *2900
