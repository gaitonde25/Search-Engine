b'The statement of this problem shares a lot with problem A. The differences are that in this problem, the probability is introduced, and the constraint is different.'
b'A robot cleaner is placed on the floor of a rectangle room, surrounded by walls. The floor consists of nn rows and mm columns. The rows of the floor are numbered from 11 to nn from top to bottom, and columns of the floor are numbered from 11 to mm from left to right. The cell on the intersection of the rr-th row and the cc-th column is denoted as (r,c)(r,c). The initial position of the robot is (rb,cb)(rb,cb).'
b'In one second, the robot moves by drdr rows and dcdc columns, that is, after one second, the robot moves from the cell (r,c)(r,c) to (r+dr,c+dc)(r+dr,c+dc). Initially dr=1dr=1, dc=1dc=1. If there is a vertical wall (the left or the right walls) in the movement direction, dcdc is reflected before the movement, so the new value of dcdc is \xe2\x88\x92dc\xe2\x88\x92dc. And if there is a horizontal wall (the upper or lower walls), drdr is reflected before the movement, so the new value of drdr is \xe2\x88\x92dr\xe2\x88\x92dr.'
b'Each second (including the moment before the robot starts moving), the robot cleans every cell lying in the same row or the same column as its position. There is only one dirty cell at (rd,cd)(rd,cd). The job of the robot is to clean that dirty cell. '
b'After a lot of testings in problem A, the robot is now broken. It cleans the floor as described above, but at each second the cleaning operation is performed with probability p100p100 only, and not performed with probability 1\xe2\x88\x92p1001\xe2\x88\x92p100. The cleaning or not cleaning outcomes are independent each second.'
b"Given the floor size nn and mm, the robot's initial position (rb,cb)(rb,cb) and the dirty cell's position (rd,cd)(rd,cd), find the expected time for the robot to do its job."
b'It can be shown that the answer can be expressed as an irreducible fraction xyxy, where xx and yy are integers and y\xe2\x89\xa1\xcc\xb80(mod109+7)y\xe2\x89\xa20(mod109+7). Output the integer equal to x\xe2\x8b\x85y\xe2\x88\x921mod(109+7)x\xe2\x8b\x85y\xe2\x88\x921mod(109+7). In other words, output such an integer aa that 0\xe2\x89\xa4a<109+70\xe2\x89\xa4a<109+7 and a\xe2\x8b\x85y\xe2\x89\xa1x(mod109+7)a\xe2\x8b\x85y\xe2\x89\xa1x(mod109+7).'
b'Input'
b'Each test contains multiple test cases. The first line contains the number of test cases tt (1\xe2\x89\xa4t\xe2\x89\xa4101\xe2\x89\xa4t\xe2\x89\xa410). Description of the test cases follows.'
b'A test case consists of only one line, containing nn, mm, rbrb, cbcb, rdrd, cdcd, and pp (4\xe2\x89\xa4n\xe2\x8b\x85m\xe2\x89\xa41054\xe2\x89\xa4n\xe2\x8b\x85m\xe2\x89\xa4105, n,m\xe2\x89\xa52n,m\xe2\x89\xa52, 1\xe2\x89\xa4rb,rd\xe2\x89\xa4n1\xe2\x89\xa4rb,rd\xe2\x89\xa4n, 1\xe2\x89\xa4cb,cd\xe2\x89\xa4m1\xe2\x89\xa4cb,cd\xe2\x89\xa4m, 1\xe2\x89\xa4p\xe2\x89\xa4991\xe2\x89\xa4p\xe2\x89\xa499)\xc2\xa0\xe2\x80\x94 the sizes of the room, the initial position of the robot, the position of the dirt cell and the probability of cleaning in percentage.'
b'Output'
b'For each test case, print a single integer \xe2\x80\x94 the expected time for the robot to clean the dirty cell, modulo 109+7109+7.'
Tags
implementation, math, probabilities, *2300
