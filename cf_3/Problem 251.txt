b'There are nn cars on a coordinate axis OXOX. Each car is located at an integer point initially and no two cars are located at the same point. Also, each car is oriented either left or right, and they can move at any constant positive speed in that direction at any moment.'
b'More formally, we can describe the ii-th car with a letter and an integer: its orientation oriiorii and its location xixi. If orii=Lorii=L, then xixi is decreasing at a constant rate with respect to time. Similarly, if orii=Rorii=R, then xixi is increasing at a constant rate with respect to time. '
b"We call two cars irrelevant if they never end up in the same point regardless of their speed. In other words, they won't share the same coordinate at any moment."
b'We call two cars destined if they always end up in the same point regardless of their speed. In other words, they must share the same coordinate at some moment.'
b'Unfortunately, we lost all information about our cars, but we do remember mm relationships. There are two types of relationships:'
b'11 ii jj \xe2\x80\x94ii-th car and jj-th car are irrelevant.'
b'22 ii jj \xe2\x80\x94ii-th car and jj-th car are destined.'
b'Restore the orientations and the locations of the cars satisfying the relationships, or report that it is impossible. If there are multiple solutions, you can output any.'
b'Note that if two cars share the same coordinate, they will intersect, but at the same moment they will continue their movement in their directions.'
b'Input'
b'The first line contains two integers, nn and mm (2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105;1\xe2\x89\xa4m\xe2\x89\xa4min(2\xe2\x8b\x85105,n(n\xe2\x88\x921)2)(2\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105;1\xe2\x89\xa4m\xe2\x89\xa4min(2\xe2\x8b\x85105,n(n\xe2\x88\x921)2) \xe2\x80\x94 the number of cars and the number of restrictions respectively.'
b'Each of the next mm lines contains three integers, typetype, ii, and jj (1\xe2\x89\xa4type\xe2\x89\xa42;1\xe2\x89\xa4i,j\xe2\x89\xa4n;i\xe2\x89\xa0j)(1\xe2\x89\xa4type\xe2\x89\xa42;1\xe2\x89\xa4i,j\xe2\x89\xa4n;i\xe2\x89\xa0j).'
b'If typetype = 11, ii-th car and jj-th car are irrelevant. Otherwise, ii-th car and jj-th car are destined.'
b'It is guaranteed that for each pair of cars, there are at most 11 relationship between.'
b'Output'
b'In the first line, print either "YES" or "NO" (in any case), whether it is possible to restore the orientations and the locations of the cars satisfying the relationships.'
b'If the answer is "YES", print nn lines each containing a symbol and an integer: oriiorii and xixi (orii\xe2\x88\x88{L,R};\xe2\x88\x92109\xe2\x89\xa4xi\xe2\x89\xa4109)(orii\xe2\x88\x88{L,R};\xe2\x88\x92109\xe2\x89\xa4xi\xe2\x89\xa4109) \xe2\x80\x94 representing the information of the ii-th car.'
b'If the orientation is left, then oriiorii = LL. Otherwise oriiorii = RR.'
b'xixi is the where the ii-th car is located. Note that all xixi should be distinct. '
b'We can prove that if there exists a solution, then there must be a solution satisfying the constraints on xixi.'
Tags
2-sat, constructive algorithms, dfs and similar, dsu, graphs, greedy, sortings, *2200
