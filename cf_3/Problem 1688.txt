b'James Bond has a new plan for catching his enemy. There are some cities and directed roads between them, such that it is possible to travel between any two cities using these roads. When the enemy appears in some city, Bond knows her next destination but has no idea which path she will choose to move there. '
b'The city aa is called interesting, if for each city bb, there is exactly one simple path from aa to bb. By a simple path, we understand a sequence of distinct cities, such that for every two neighboring cities, there exists a directed road from the first to the second city. '
b"Bond's enemy is the mistress of escapes, so only the chase started in an interesting city gives the possibility of catching her. James wants to arrange his people in such cities. However, if there are not enough interesting cities, the whole action doesn't make sense since Bond's people may wait too long for the enemy."
b'You are responsible for finding all the interesting cities or saying that there is not enough of them. By not enough, James means strictly less than 20%20% of all cities. '
b'Input'
b'The first line contains one integer tt (1\xe2\x89\xa4t\xe2\x89\xa420001\xe2\x89\xa4t\xe2\x89\xa42000)\xc2\xa0\xe2\x80\x94 the number of test cases. Each test case is described as follows:'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n\xe2\x89\xa41051\xe2\x89\xa4n\xe2\x89\xa4105, 0\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x851050\xe2\x89\xa4m\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of cities and roads between them. Each of the following mm lines contains two integers uu, vv (u\xe2\x89\xa0vu\xe2\x89\xa0v; 1\xe2\x89\xa4u,v\xe2\x89\xa4n1\xe2\x89\xa4u,v\xe2\x89\xa4n), which denote that there is a directed road from uu to vv.'
b"You can assume that between each ordered pair of cities there is at most one road. The sum of nn over all test cases doesn't exceed 105105, and the sum of mm doesn't exceed 2\xe2\x8b\x851052\xe2\x8b\x85105."
b'Output'
b'If strictly less than 20%20% of all cities are interesting, print \xe2\x88\x921\xe2\x88\x921. Otherwise, let kk be the number of interesting cities. Print kk distinct integers in increasing order\xc2\xa0\xe2\x80\x94 the indices of interesting cities.'
Tags
dfs and similar, graphs, probabilities, trees, *3000
