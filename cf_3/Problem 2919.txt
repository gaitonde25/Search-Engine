b'You are given a string of length nn. Each character is one of the first pp lowercase Latin letters.'
b'You are also given a matrix AA with binary values of size p\xc3\x97pp\xc3\x97p. This matrix is symmetric (Aij=AjiAij=Aji). Aij=1Aij=1 means that the string can have the ii-th and jj-th letters of Latin alphabet adjacent.'
b"Let's call the string crisp if all of the adjacent characters in it can be adjacent (have 1 in the corresponding cell of matrix AA)."
b'You are allowed to do the following move. Choose any letter, remove all its occurrences and join the remaining parts of the string without changing their order. For example, removing letter \'a\' from "abacaba" will yield "bcb".'
b'The string you are given is crisp. The string should remain crisp after every move you make.'
b'You are allowed to do arbitrary number of moves (possible zero). What is the shortest resulting string you can obtain?'
b'Input'
b'The first line contains two integers nn and pp (1\xe2\x89\xa4n\xe2\x89\xa41051\xe2\x89\xa4n\xe2\x89\xa4105, 1\xe2\x89\xa4p\xe2\x89\xa4171\xe2\x89\xa4p\xe2\x89\xa417) \xe2\x80\x94 the length of the initial string and the length of the allowed prefix of Latin alphabet.'
b'The second line contains the initial string. It is guaranteed that it contains only first pp lowercase Latin letters and that is it crisp. Some of these pp first Latin letters might not be present in the string.'
b'Each of the next pp lines contains pp integer numbers \xe2\x80\x94 the matrix AA (0\xe2\x89\xa4Aij\xe2\x89\xa410\xe2\x89\xa4Aij\xe2\x89\xa41, Aij=AjiAij=Aji). Aij=1Aij=1 means that the string can have the ii-th and jj-th letters of Latin alphabet adjacent.'
b'Output'
b'Print a single integer \xe2\x80\x94 the length of the shortest string after you make arbitrary number of moves (possible zero).'
Tags
bitmasks, dp, *2500
