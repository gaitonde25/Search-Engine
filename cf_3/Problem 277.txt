b'Given a cyclic array aa of size nn, where aiai is the value of aa in the ii-th position, there may be repeated values. Let us define that a permutation of aa is equal to another permutation of aa if and only if their values are the same for each position ii or we can transform them to each other by performing some cyclic rotation. Let us define for a cyclic array bb its number of components as the number of connected components in a graph, where the vertices are the positions of bb and we add an edge between each pair of adjacent positions of bb with equal values (note that in a cyclic array the first and last position are also adjacents).'
b'Find the expected value of components of a permutation of aa if we select it equiprobably over the set of all the different permutations of aa.'
b'Input'
b'The input consists of multiple test cases. The first line contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa41051\xe2\x89\xa4t\xe2\x89\xa4105) \xe2\x80\x94 the number of test cases. Description of the test cases follows.'
b'The first line of each test case contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa41061\xe2\x89\xa4n\xe2\x89\xa4106) \xe2\x80\x94 the size of the cyclic array aa.'
b'The second line of each test case contains nn integers, the ii-th of them is the value aiai (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n).'
b'It is guaranteed that the sum of nn over all test cases does not exceed 106106.'
b'It is guaranteed that the total number of different permutations of aa is not divisible by MM'
b'Output'
b'For each test case print a single integer \xe2\x80\x94 the expected value of components of a permutation of aa if we select it equiprobably over the set of all the different permutations of aa modulo 998244353998244353. '
b'Formally, let M=998244353M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pqpq, where pp and qq are integers and q\xe2\x89\xa1\xcc\xb80(modM)q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modMp\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer xx that 0\xe2\x89\xa4x<M0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)x\xe2\x8b\x85q\xe2\x89\xa1p(modM).'
Tags
combinatorics, math, number theory, probabilities, *2900
