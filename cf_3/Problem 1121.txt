b'Lunar rover finally reached planet X. After landing, he met an obstacle, that contains permutation pp of length nn. Scientists found out, that to overcome an obstacle, the robot should make pp an identity permutation (make pi=ipi=i for all ii).'
b"Unfortunately, scientists can't control the robot. Thus the only way to make pp an identity permutation is applying the following operation to pp multiple times: "
b'  Select two indices ii and jj (i\xe2\x89\xa0ji\xe2\x89\xa0j), such that pj=ipj=i and swap the values of pipi and pjpj. It takes robot (j\xe2\x88\x92i)2(j\xe2\x88\x92i)2 seconds to do this operation. '
b' Positions '
b''
b'ii'
b'i'
b' and '
b''
b'jj'
b'j'
b" are selected by the robot (scientists can't control it). He will apply this operation while "
b''
b'pp'
b'p'
b" isn't an identity permutation. We can show that the robot will make no more than "
b''
b'nn'
b'n'
b' operations regardless of the choice of '
b''
b'ii'
b'i'
b' and '
b''
b'jj'
b'j'
b' on each operation.'
b"Scientists asked you to find out the maximum possible time it will take the robot to finish making pp an identity permutation (i.\xc2\xa0e. worst-case scenario), so they can decide whether they should construct a new lunar rover or just rest and wait. They won't believe you without proof, so you should build an example of pp and robot's operations that maximizes the answer."
b'For a better understanding of the statement, read the sample description.'
b'Input'
b'The first line of input contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104)\xc2\xa0\xe2\x80\x94 the number of test cases.'
b'Each of next tt lines contains the single integer nn (2\xe2\x89\xa4n\xe2\x89\xa41052\xe2\x89\xa4n\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x93 the length of pp.'
b'Note, that pp is not given to you. You should find the maximum possible time over all permutations of length nn.'
b"It is guaranteed, that the total sum of nn over all test cases doesn't exceed 105105."
b'Output'
b'For each test case in the first line, print how many seconds will the robot spend in the worst case.'
b'In the next line, print the initial value of pp that you used to construct an answer.'
b'In the next line, print the number of operations m\xe2\x89\xa4nm\xe2\x89\xa4n that the robot makes in your example.'
b'In the each of next mm lines print two integers ii and jj\xc2\xa0\xe2\x80\x94 indices of positions that the robot will swap on this operation. Note that pj=ipj=i must holds (at the time of operation).'
Tags
constructive algorithms, greedy, *2500
