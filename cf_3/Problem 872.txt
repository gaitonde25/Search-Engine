b'This is an interactive problem.'
b'This is a hard version of the problem. The difference from the easy version is that in the hard version 1\xe2\x89\xa4t\xe2\x89\xa4min(n,104)1\xe2\x89\xa4t\xe2\x89\xa4min(n,104) and the total number of queries is limited to 6\xe2\x8b\x851046\xe2\x8b\x85104.'
b'Polycarp is playing a computer game. In this game, an array consisting of zeros and ones is hidden. Polycarp wins if he guesses the position of the kk-th zero from the left tt times.'
b'Polycarp can make no more than 6\xe2\x8b\x851046\xe2\x8b\x85104 requests totally of the following type: '
b'  ? ll rr\xc2\xa0\xe2\x80\x94 find out the sum of all elements in positions from ll to rr (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) inclusive. '
b'To make the game more interesting, each guessed zero turns into one and the game continues on the changed array. More formally, if the position of the kk-th zero was xx, then after Polycarp guesses this position, the xx-th element of the array will be replaced from 00 to 11.'
b'Help Polycarp win the game.'
Tags
binary search, constructive algorithms, data structures, interactive, *2200
