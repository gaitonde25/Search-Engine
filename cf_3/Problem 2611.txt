b'This problem is a version of problem D from the same contest with some additional constraints and tasks.'
b'There are nn candies in a candy box. The type of the ii-th candy is aiai (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n). '
b'You have to prepare a gift using some of these candies with the following restriction: the numbers of candies of each type presented in a gift should be all distinct (i.\xe2\x80\x89e. for example, a gift having two candies of type 11 and two candies of type 22 is bad).'
b'It is possible that multiple types of candies are completely absent from the gift. It is also possible that not all candies of some types will be taken to a gift.'
b"You really like some of the candies and don't want to include them into the gift, but you want to eat them yourself instead. For each candy, a number fifi is given, which is equal to 00 if you really want to keep ii-th candy for yourself, or 11 if you don't mind including it into your gift. It is possible that two candies of the same type have different values of fifi."
b"You want your gift to be as large as possible, but you don't want to include too many of the candies you want to eat into the gift. So, you want to calculate the maximum possible number of candies that can be included into a gift, and among all ways to choose maximum number of candies, you want to maximize the number of candies having fi=1fi=1 in your gift."
b'You have to answer qq independent queries.'
b'If you are Python programmer, consider using PyPy instead of Python when you submit your code.'
b'Input'
b'The first line of the input contains one integer qq (1\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of queries.'
b'The first line of each query contains one integer nn (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the number of candies.'
b"Then nn lines follow, each containing two integers aiai and fifi (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n, 0\xe2\x89\xa4fi\xe2\x89\xa410\xe2\x89\xa4fi\xe2\x89\xa41), where aiai is the type of the ii-th candy, and fifi denotes whether you want to keep the ii-th candy for yourself (00 if you want to keep it, 11 if you don't mind giving it away)."
b'It is guaranteed that the sum of nn over all queries does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each query print two integers:'
b'  the maximum number of candies in a gift you can compose, according to the constraints in the statement;  the maximum number of candies having fi=1fi=1 in a gift you can compose that contains the maximum possible number of candies. '
b' '
Tags
greedy, implementation, sortings, *2000
