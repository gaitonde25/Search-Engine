b"Everybody knows that Bal\xc3\xa1zs has the fanciest fence in the whole town. It's built up from NN fancy sections. The sections are rectangles standing closely next to each other on the ground. The iith section has integer height hihi and integer width wiwi.  We are looking for fancy rectangles on this fancy fence.  A rectangle is fancy if: "
b"  its sides are either horizontal or vertical and have integer lengths  the distance between the rectangle and the ground is integer  the distance between the rectangle and the left side of the first section is integer  it's lying completely on sections "
b' What is the number of fancy rectangles?  This number can be very big, so we are interested in it modulo '
b''
b'109+7109+7'
b'10^9+7'
b'.'
b'Input'
b'The first line contains NN (1\xe2\x89\xa4N\xe2\x89\xa41051\xe2\x89\xa4N\xe2\x89\xa4105) \xe2\x80\x93 the number of sections.  The second line contains NN space-separated integers, the iith number is hihi (1\xe2\x89\xa4hi\xe2\x89\xa41091\xe2\x89\xa4hi\xe2\x89\xa4109).  The third line contains NN space-separated integers, the iith number is wiwi (1\xe2\x89\xa4wi\xe2\x89\xa41091\xe2\x89\xa4wi\xe2\x89\xa4109).'
b'Output'
b'You should print a single integer, the number of fancy rectangles modulo 109+7109+7. So the output range is 0,1,2,\xe2\x80\xa6,109+60,1,2,\xe2\x80\xa6,109+6.'
Tags
*special problem, data structures, dsu, implementation, math, sortings, *1800
