b"It's May in Flatland, and there are mm days in this month. Despite the fact that May Holidays are canceled long time ago, employees of some software company still have a habit of taking short or long vacations in May."
b'Of course, not all managers of the company like this. There are nn employees in the company that form a tree-like structure of subordination: each employee has a unique integer id ii between 11 and nn, and each employee with id ii (except the head manager whose id is 1) has exactly one direct manager with id pipi. The structure of subordination is not cyclic, i.e. if we start moving from any employee to his direct manager, then we will eventually reach the head manager. We define that an employee uu is a subordinate of an employee vv, if vv is a direct manager of uu, or the direct manager of uu is a subordinate of vv. Let sisi be the number of subordinates the ii-th employee has (for example, s1=n\xe2\x88\x921s1=n\xe2\x88\x921, because all employees except himself are subordinates of the head manager).'
b'Each employee ii has a bearing limit of titi, which is an integer between 00 and sisi. It denotes the maximum number of the subordinates of the ii-th employee being on vacation at the same moment that he can bear. If at some moment strictly more than titi subordinates of the ii-th employee are on vacation, and the ii-th employee himself is not on a vacation, he becomes displeased.'
b'In each of the mm days of May exactly one event of the following two types happens: either one employee leaves on a vacation at the beginning of the day, or one employee returns from a vacation in the beginning of the day. You know the sequence of events in the following mm days. Your task is to compute for each of the mm days the number of displeased employees on that day.'
b'Input'
b'The first line contains two integers nn and mm (2\xe2\x89\xa4n,m\xe2\x89\xa41052\xe2\x89\xa4n,m\xe2\x89\xa4105) \xe2\x80\x94 the number of employees in the company and the number of days in May.'
b'The second line contains n\xe2\x88\x921n\xe2\x88\x921 integers p2,p3,\xe2\x80\xa6,pnp2,p3,\xe2\x80\xa6,pn (1\xe2\x89\xa4pi\xe2\x89\xa4n1\xe2\x89\xa4pi\xe2\x89\xa4n), denoting the direct managers of employees.'
b'The third line contains nn integers t1,t2,\xe2\x80\xa6,tnt1,t2,\xe2\x80\xa6,tn (0\xe2\x89\xa4ti\xe2\x89\xa4si0\xe2\x89\xa4ti\xe2\x89\xa4si), denoting the bearing limits of empoyees.'
b'The fourth line contains mm integers q1,q2,\xe2\x80\xa6,qmq1,q2,\xe2\x80\xa6,qm (1\xe2\x89\xa4|qi|\xe2\x89\xa4n1\xe2\x89\xa4|qi|\xe2\x89\xa4n, qi\xe2\x89\xa00qi\xe2\x89\xa00), denoting the events. If qiqi is positive, then the employee with id qiqi leaves for a vacation starting from this day, if qiqi is negative, then the employee \xe2\x88\x92qi\xe2\x88\x92qi returns from a vacation starting from this day. In the beginning of May no employee is on vacation. It is guaranteed that if some employee leaves for a vacation, he is not on a vacation at the moment and vice versa.'
b'Output'
b'Print a sequence of mm integers a1,a2,\xe2\x80\xa6,ama1,a2,\xe2\x80\xa6,am, where aiai is the number of displeased employees on the ii-th day.'
Tags
data structures, trees, *2900
