b'You are playing a computer game, where you lead a party of mm soldiers. Each soldier is characterised by his agility aiai.'
b'The level you are trying to get through can be represented as a straight line segment from point 00 (where you and your squad is initially located) to point n+1n+1 (where the boss is located).'
b"The level is filled with kk traps. Each trap is represented by three numbers lili, riri and didi. lili is the location of the trap, and didi is the danger level of the trap: whenever a soldier with agility lower than didi steps on a trap (that is, moves to the point lili), he gets instantly killed. Fortunately, you can disarm traps: if you move to the point riri, you disarm this trap, and it no longer poses any danger to your soldiers. Traps don't affect you, only your soldiers."
b"You have tt seconds to complete the level \xe2\x80\x94 that is, to bring some soldiers from your squad to the boss. Before the level starts, you choose which soldiers will be coming with you, and which soldiers won't be. After that, you have to bring all of the chosen soldiers to the boss. To do so, you may perform the following actions:"
b'  if your location is xx, you may move to x+1x+1 or x\xe2\x88\x921x\xe2\x88\x921. This action consumes one second;  if your location is xx and the location of your squad is xx, you may move to x+1x+1 or to x\xe2\x88\x921x\xe2\x88\x921 with your squad in one second. You may not perform this action if it puts some soldier in danger (i.\xe2\x80\x89e. the point your squad is moving into contains a non-disarmed trap with didi greater than agility of some soldier from the squad). This action consumes one second;  if your location is xx and there is a trap ii with ri=xri=x, you may disarm this trap. This action is done instantly (it consumes no time). '
b'Note that after each action both your coordinate and the coordinate of your squad should be integers.'
b'You have to choose the maximum number of soldiers such that they all can be brought from the point 00 to the point n+1n+1 (where the boss waits) in no more than tt seconds.'
b'Input'
b'The first line contains four integers mm, nn, kk and tt (1\xe2\x89\xa4m,n,k,t\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4m,n,k,t\xe2\x89\xa42\xe2\x8b\x85105, n<tn<t) \xe2\x80\x94 the number of soldiers, the number of integer points between the squad and the boss, the number of traps and the maximum number of seconds you may spend to bring the squad to the boss, respectively.'
b'The second line contains mm integers a1a1, a2a2, ..., amam (1\xe2\x89\xa4ai\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4ai\xe2\x89\xa42\xe2\x8b\x85105), where aiai is the agility of the ii-th soldier.'
b'Then kk lines follow, containing the descriptions of traps. Each line contains three numbers lili, riri and didi (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n, 1\xe2\x89\xa4di\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4di\xe2\x89\xa42\xe2\x8b\x85105) \xe2\x80\x94 the location of the trap, the location where the trap can be disarmed, and its danger level, respectively.'
b'Output'
b'Print one integer \xe2\x80\x94 the maximum number of soldiers you may choose so that you may bring them all to the boss in no more than tt seconds.'
Tags
binary search, dp, greedy, sortings, *1900
