b'A chainword is a special type of crossword. As most of the crosswords do, it has cells that you put the letters in and some sort of hints to what these letters should be.'
b'The letter cells in a chainword are put in a single row. We will consider chainwords of length mm in this task.'
b"A hint to a chainword is a sequence of segments such that the segments don't intersect with each other and cover all mm letter cells. Each segment contains a description of the word in the corresponding cells."
b'The twist is that there are actually two hints: one sequence is the row above the letter cells and the other sequence is the row below the letter cells. When the sequences are different, they provide a way to resolve the ambiguity in the answers.'
b'You are provided with a dictionary of nn words, each word consists of lowercase Latin letters. All words are pairwise distinct.'
b'An instance of a chainword is the following triple: '
b'  a string of mm lowercase Latin letters;  the first hint: a sequence of segments such that the letters that correspond to each segment spell a word from the dictionary;  the second hint: another sequence of segments such that the letters that correspond to each segment spell a word from the dictionary. '
b"Note that the sequences of segments don't necessarily have to be distinct."
b'Two instances of chainwords are considered different if they have different strings, different first hints or different second hints.'
b'Count the number of different instances of chainwords. Since the number might be pretty large, output it modulo 998244353998244353.'
b'Input'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n\xe2\x89\xa481\xe2\x89\xa4n\xe2\x89\xa48, 1\xe2\x89\xa4m\xe2\x89\xa41091\xe2\x89\xa4m\xe2\x89\xa4109)\xc2\xa0\xe2\x80\x94 the number of words in the dictionary and the number of letter cells.'
b'Each of the next nn lines contains a word\xc2\xa0\xe2\x80\x94 a non-empty string of no more than 55 lowercase Latin letters. All words are pairwise distinct. '
b'Output'
b'Print a single integer\xc2\xa0\xe2\x80\x94 the number of different instances of chainwords of length mm for the given dictionary modulo 998244353998244353.'
Tags
brute force, data structures, dp, matrices, string suffix structures, strings, *2700
