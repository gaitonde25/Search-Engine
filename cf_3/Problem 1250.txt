b'The only difference between the easy and hard versions is that tokens of type O do not appear in the input of the easy version.'
b'Errichto gave Monogon the following challenge in order to intimidate him from taking his top contributor spot on Codeforces.'
b'In a Tic-Tac-Toe grid, there are nn rows and nn columns. Each cell of the grid is either empty or contains a token. There are two types of tokens: X and O. If there exist three tokens of the same type consecutive in a row or column, it is a winning configuration. Otherwise, it is a draw configuration.'
b'  The patterns in the first row are winning configurations. The patterns in the second row are draw configurations. '
b'In an operation, you can change an X to an O, or an O to an X. Let kk denote the total number of tokens in the grid. Your task is to make the grid a draw in at most \xe2\x8c\x8ak3\xe2\x8c\x8b\xe2\x8c\x8ak3\xe2\x8c\x8b (rounding down) operations.'
b'You are not required to minimize the number of operations.'
b'Input'
b'The first line contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa41001\xe2\x89\xa4t\xe2\x89\xa4100) \xe2\x80\x94 the number of test cases.'
b'The first line of each test case contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa43001\xe2\x89\xa4n\xe2\x89\xa4300) \xe2\x80\x94 the size of the grid.'
b"The following nn lines each contain a string of nn characters, denoting the initial grid. The character in the ii-th row and jj-th column is '.' if the cell is empty, or it is the type of token in the cell: 'X' or 'O'."
b'It is guaranteed that not all cells are empty.'
b'The sum of nn across all test cases does not exceed 300300.'
b'Output'
b'For each test case, print the state of the grid after applying the operations.'
b'We have proof that a solution always exists. If there are multiple solutions, print any.'
Tags
constructive algorithms, math, *2300
