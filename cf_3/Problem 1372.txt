b'Sarah has always been a lover of nature, and a couple of years ago she saved up enough money to travel the world and explore all the things built by nature over its lifetime on earth. During this time she visited some truly special places which were left untouched for centuries, from watching icebergs in freezing weather to scuba-diving in oceans and admiring the sea life, residing unseen. These experiences were enhanced with breathtaking views built by mountains over time and left there for visitors to see for years on end. Over time, all these expeditions took a toll on Sarah and culminated in her decision to settle down in the suburbs and live a quiet life. '
b"However, as Sarah's love for nature never faded, she started growing flowers in her garden in an attempt to stay connected with nature. At the beginning she planted only blue orchids, but over time she started using different flower types to add variety to her collection of flowers. This collection of flowers can be represented as an array of NN flowers and the ii-th of them has a type associated with it, denoted as AiAi. Each resident, passing by her collection and limited by the width of his view, can only see KK contiguous flowers at each moment in time. To see the whole collection, the resident will look at the first KK contiguous flowers A1,A2,...,AKA1,A2,...,AK, then shift his view by one flower and look at the next section of K contiguous flowers A2,A3,...,AK+1A2,A3,...,AK+1 and so on until they scan the whole collection, ending with section AN\xe2\x88\x92K+1,...,AN\xe2\x88\x921,ANAN\xe2\x88\x92K+1,...,AN\xe2\x88\x921,AN."
b'Each resident determines the beautiness of a section of KK flowers as the number of distinct flower types in that section. Furthermore, the beautiness of the whole collection is calculated by summing the beautiness values of each contiguous section. Formally, beautiness BiBi of a section starting at the ii-th position is calculated as Bi=distinct(Ai,Ai+1,...,Ai+K\xe2\x88\x921)Bi=distinct(Ai,Ai+1,...,Ai+K\xe2\x88\x921), and beautiness of the collection BB is calculated as B=B1+B2+...+BN\xe2\x88\x92K+1B=B1+B2+...+BN\xe2\x88\x92K+1.'
b'In addition, as Sarah wants to keep her collection of flowers have a fresh feel, she can also pick two points LL and RR, dispose flowers between those two points and plant new flowers, all of them being the same type.'
b'You will be given QQ queries and each of those queries will be of the following two types: '
b"  You will be given three integers L,R,XL,R,X describing that Sarah has planted flowers of type XX between positions LL and RR inclusive. Formally collection is changed such that A[i]=XA[i]=X for all ii in range [L..R][L..R].  You will be given integer KK, width of the resident's view and you have to determine the beautiness value BB resident has associated with the collection "
b'For each query of second type print the result \xe2\x80\x93 beautiness BB of the collection.'
b'Input'
b'First line contains two integers NN and Q(1\xe2\x89\xa4N,Q\xe2\x89\xa4105)Q(1\xe2\x89\xa4N,Q\xe2\x89\xa4105) \xe2\x80\x94 number of flowers and the number of queries, respectively.'
b'The second line contains NN integers A1,A2,...,AN(1\xe2\x89\xa4Ai\xe2\x89\xa4109)A1,A2,...,AN(1\xe2\x89\xa4Ai\xe2\x89\xa4109) \xe2\x80\x94 where AiAi represents type of the ii-th flower.'
b'Each of the next QQ lines describe queries and start with integer T\xe2\x88\x88{1,2}T\xe2\x88\x88{1,2}. '
b"  If T=1T=1, there will be three more integers in the line L,R,X(1\xe2\x89\xa4L,R\xe2\x89\xa4N;1\xe2\x89\xa4X\xe2\x89\xa4109)L,R,X(1\xe2\x89\xa4L,R\xe2\x89\xa4N;1\xe2\x89\xa4X\xe2\x89\xa4109) \xe2\x80\x94 LL and RR describing boundaries and XX describing the flower type  If T=2T=2, there will be one more integer in the line K(1\xe2\x89\xa4K\xe2\x89\xa4N)K(1\xe2\x89\xa4K\xe2\x89\xa4N) \xe2\x80\x94 resident's width of view "
b'Output'
b'For each query of the second type print the beautiness BB of the collection.'
Tags
data structures, *3500
