b"A binary tree of nn nodes is given. Nodes of the tree are numbered from 11 to nn and the root is the node 11. Each node can have no child, only one left child, only one right child, or both children. For convenience, let's denote lulu and ruru as the left and the right child of the node uu respectively, lu=0lu=0 if uu does not have the left child, and ru=0ru=0 if the node uu does not have the right child."
b"Each node has a string label, initially is a single character cucu. Let's define the string representation of the binary tree as the concatenation of the labels of the nodes in the in-order. Formally, let f(u)f(u) be the string representation of the tree rooted at the node uu. f(u)f(u) is defined as follows: f(u)={<empty string>,f(lu)+cu+f(ru)if\xc2\xa0u=0;otherwise,f(u)={<empty string>,if\xc2\xa0u=0;f(lu)+cu+f(ru)otherwise, where ++ denotes the string concatenation operation."
b'This way, the string representation of the tree is f(1)f(1).'
b'For each node, we can duplicate its label at most once, that is, assign cucu with cu+cucu+cu, but only if uu is the root of the tree, or if its parent also has its label duplicated.'
b'You are given the tree and an integer kk. What is the lexicographically smallest string representation of the tree, if we can duplicate labels of at most kk nodes?'
b'A string aa is lexicographically smaller than a string bb if and only if one of the following holds: '
b'  aa is a prefix of bb, but a\xe2\x89\xa0ba\xe2\x89\xa0b;  in the first position where aa and bb differ, the string aa has a letter that appears earlier in the alphabet than the corresponding letter in bb. '
b'Input'
b'The first line contains two integers nn and kk (1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105).'
b'The second line contains a string cc of nn lower-case English letters, where cici is the initial label of the node ii for 1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n. Note that the given string cc is not the initial string representation of the tree.'
b'The ii-th of the next nn lines contains two integers lili and riri (0\xe2\x89\xa4li,ri\xe2\x89\xa4n0\xe2\x89\xa4li,ri\xe2\x89\xa4n). If the node ii does not have the left child, li=0li=0, and if the node ii does not have the right child, ri=0ri=0.'
b'It is guaranteed that the given input forms a binary tree, rooted at 11.'
b'Output'
b'Print a single line, containing the lexicographically smallest string representation of the tree if at most kk nodes have their labels duplicated.'
Tags
data structures, dfs and similar, greedy, strings, trees, *2500
