b'For a permutation pp of numbers 11 through nn, we define a stair array aa as follows: aiai is length of the longest segment of permutation which contains position ii and is made of consecutive values in sorted order: [x,x+1,\xe2\x80\xa6,y\xe2\x88\x921,y][x,x+1,\xe2\x80\xa6,y\xe2\x88\x921,y] or [y,y\xe2\x88\x921,\xe2\x80\xa6,x+1,x][y,y\xe2\x88\x921,\xe2\x80\xa6,x+1,x] for some x\xe2\x89\xa4yx\xe2\x89\xa4y. For example, for permutation p=[4,1,2,3,7,6,5]p=[4,1,2,3,7,6,5] we have a=[1,3,3,3,3,3,3]a=[1,3,3,3,3,3,3]. '
b'You are given the stair array aa. Your task is to calculate the number of permutations which have stair array equal to aa. Since the number can be big, compute it modulo 998244353998244353. Note that this number can be equal to zero.'
b'Input'
b'The first line of input contains integer nn (1\xe2\x89\xa4n\xe2\x89\xa41051\xe2\x89\xa4n\xe2\x89\xa4105) \xc2\xa0\xe2\x80\x94 the length of a stair array aa.'
b'The second line of input contains nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4n1\xe2\x89\xa4ai\xe2\x89\xa4n).'
b'Output'
b'Print the number of permutations which have stair array equal to aa. Since the number can be big, compute it modulo 998244353998244353.'
Tags
combinatorics, divide and conquer, dp, fft, math, *3400
