b'There are nn cities and n\xe2\x88\x921n\xe2\x88\x921 two-way roads in Treeland. Each road connects a pair of different cities. From any city you can drive to any other, moving only along the roads. Cities are numbered from 11 to nn. Yes, of course, you recognized an undirected tree in this description.'
b'The government plans to repair all the roads. Each road will be repaired by some private company. In total, the country has 106106 private companies that are numbered from 11 to 106106. It is possible that some companies will not repair roads at all, and some will repair many roads.'
b'To simplify the control over the work of private companies, the following restriction was introduced: for each city, we calculate the number of different companies that repair roads that have this city at one end. This number for each city should not exceed 22. In other words, for each city, there should be no more than two different companies that repair roads related to this city.'
b'The National Anti-Corruption Committee of Treeland raises concerns that all (or almost all) of the work will go to one private company. For this reason, the committee requires that roads be distributed among companies in such a way as to minimize the value of rr. For each company, we calculate the number of roads assigned to it, the maximum among all companies is called the number rr.'
b'Help the government find such a way to distribute all roads among companies in the required way.'
b'Input'
b'The first line contains an integer tt (1\xe2\x89\xa4t\xe2\x89\xa410001\xe2\x89\xa4t\xe2\x89\xa41000) \xe2\x80\x94 the number of input cases in the input. Next, the input cases themselves are given. The first line of each test case set contains an integer nn (2\xe2\x89\xa4n\xe2\x89\xa430002\xe2\x89\xa4n\xe2\x89\xa43000) \xe2\x80\x94 the number of cities in Treeland. Next, in the n\xe2\x88\x921n\xe2\x88\x921 lines the roads are written: a line contains two integers xixi, yiyi (1\xe2\x89\xa4xi,yi\xe2\x89\xa4n1\xe2\x89\xa4xi,yi\xe2\x89\xa4n), indicating that the ii-th road connects the cities xixi and yiyi.'
b'It is guaranteed that the sum of all values nn \xe2\x80\x8b\xe2\x80\x8bfor all test cases in the input does not exceed 30003000.'
b'Output'
b'Print the answers for all tt test cases in the input. Each test case must begin with a line that contains rr \xe2\x80\x94 the minimum possible number of roads assigned to the most used company. Next, in the next line print n\xe2\x88\x921n\xe2\x88\x921 the number c1,c2,\xe2\x80\xa6,cn\xe2\x88\x921c1,c2,\xe2\x80\xa6,cn\xe2\x88\x921 (1\xe2\x89\xa4ci\xe2\x89\xa41061\xe2\x89\xa4ci\xe2\x89\xa4106), where cici indicates the company to repair the ii-th road. If there are several optimal assignments, print any of them.'
Tags
*special problem, binary search, dp, trees, *3100
