b'There is a directed graph on nn vertices numbered 11 through nn where each vertex (except nn) has two outgoing arcs, red and blue. At any point in time, exactly one of the arcs is active for each vertex. Initially, all blue arcs are active and there is a token located at vertex 11. In one second, the vertex with token first switches its active arcs \xe2\x80\x94 the inactive arc becomes active and vice versa. Then, the token is moved along the active arc. When the token reaches the vertex nn, it stops. It is guaranteed that nn is reachable via arcs from every vertex.'
b'You are given qq queries. Each query contains a state of the graph \xe2\x80\x94 a pair (v,s)(v,s) of the following form: '
b"  vv is the vertex where the token is currently located;  ss is a string consisting of n\xe2\x88\x921n\xe2\x88\x921 characters. The ii-th character corresponds to the color of the active edge leading from the ii-th vertex (the character is 'R' if red arc is active, otherwise the character is 'B'). "
b'For each query, determine whether the given state is reachable from the initial state and the first time this configuration appears. Note that the two operations (change active arc and traverse it) are atomic \xe2\x80\x94 a state is not considered reached if it appears after changing the active arc but before traversing it.'
b'Input'
b'The first line contains a single integer nn (2\xe2\x89\xa4n\xe2\x89\xa4582\xe2\x89\xa4n\xe2\x89\xa458)\xc2\xa0\xe2\x80\x94 the number of vertices.'
b'n\xe2\x88\x921n\xe2\x88\x921 lines follow, ii-th of contains two space separated integers bibi and riri (1\xe2\x89\xa4bi,ri\xe2\x89\xa4n1\xe2\x89\xa4bi,ri\xe2\x89\xa4n) representing a blue arc (i,bi)(i,bi) and red arc (i,ri)(i,ri), respectively. It is guaranteed that vertex nn is reachable from every vertex.'
b'The next line contains a single integer qq (1\xe2\x89\xa4q\xe2\x89\xa450001\xe2\x89\xa4q\xe2\x89\xa45000)\xc2\xa0\xe2\x80\x94 the number of queries.'
b"Then qq lines with queries follow. The jj-th of these lines contains an integer vv (1\xe2\x89\xa4v<n1\xe2\x89\xa4v<n) and a string ss of length n\xe2\x88\x921n\xe2\x88\x921 consiting only of characters 'R' and 'B'. The ii-th of these characters is 'R' if the red arc going from ii is active and 'B' otherwise."
b'Output'
b'Output qq lines, each containing answer to a single query.'
b'If the state in the ii-th query is unreachable, output the integer \xe2\x88\x921\xe2\x88\x921. Otherwise, output titi \xe2\x80\x94 the first time when the state appears (measured in seconds, starting from the initial state of the graph which appears in time 00).'
Tags
dp, graphs, math, matrices, meet-in-the-middle, *3400
