b'There are many freight trains departing from Kirnes planet every day. One day on that planet consists of hh hours, and each hour consists of mm minutes, where mm is an even number. Currently, there are nn freight trains, and they depart every day at the same time: ii-th train departs at hihi hours and mimi minutes.'
b'The government decided to add passenger trams as well: they plan to add a regular tram service with half-hour intervals. It means that the first tram of the day must depart at 00 hours and tt minutes, where 0\xe2\x89\xa4t<m20\xe2\x89\xa4t<m2, the second tram departs m2m2 minutes after the first one and so on. This schedule allows exactly two passenger trams per hour, which is a great improvement.'
b'To allow passengers to board the tram safely, the tram must arrive kk minutes before. During the time when passengers are boarding the tram, no freight train can depart from the planet. However, freight trains are allowed to depart at the very moment when the boarding starts, as well as at the moment when the passenger tram departs. Note that, if the first passenger tram departs at 00 hours and tt minutes, where t<kt<k, then the freight trains can not depart during the last k\xe2\x88\x92tk\xe2\x88\x92t minutes of the day.'
b'  A schematic picture of the correct way to run passenger trams. Here h=2h=2 (therefore, the number of passenger trams is 2h=42h=4), the number of freight trains is n=6n=6. The passenger trams are marked in red (note that the spaces between them are the same). The freight trains are marked in blue. Time segments of length kk before each passenger tram are highlighted in red. Note that there are no freight trains inside these segments. '
b'Unfortunately, it might not be possible to satisfy the requirements of the government without canceling some of the freight trains. Please help the government find the optimal value of tt to minimize the number of canceled freight trains in case all passenger trams depart according to schedule.'
b'Input'
b'The first line of input contains four integers nn, hh, mm, kk (1\xe2\x89\xa4n\xe2\x89\xa41000001\xe2\x89\xa4n\xe2\x89\xa4100000, 1\xe2\x89\xa4h\xe2\x89\xa41091\xe2\x89\xa4h\xe2\x89\xa4109, 2\xe2\x89\xa4m\xe2\x89\xa41092\xe2\x89\xa4m\xe2\x89\xa4109, mm is even, 1\xe2\x89\xa4k\xe2\x89\xa4m21\xe2\x89\xa4k\xe2\x89\xa4m2)\xc2\xa0\xe2\x80\x94 the number of freight trains per day, the number of hours and minutes on the planet, and the boarding time for each passenger tram.'
b'nn lines follow, each contains two integers hihi and mimi (0\xe2\x89\xa4hi<h0\xe2\x89\xa4hi<h, 0\xe2\x89\xa4mi<m0\xe2\x89\xa4mi<m)\xc2\xa0\xe2\x80\x94 the time when ii-th freight train departs. It is guaranteed that no freight trains depart at the same time.'
b'Output'
b'The first line of output should contain two integers: the minimum number of trains that need to be canceled, and the optimal starting time tt. Second line of output should contain freight trains that need to be canceled.'
Tags
binary search, brute force, data structures, sortings, two pointers, *2300
