b'There is a sheet of paper that can be represented with a grid of size n\xc3\x97mn\xc3\x97m: nn rows and mm columns of cells. All cells are colored in white initially.'
b'qq operations have been applied to the sheet. The ii-th of them can be described as follows: '
b'  xixi yiyi\xc2\xa0\xe2\x80\x94 choose one of kk non-white colors and color the entire row xixi and the entire column yiyi in it. The new color is applied to each cell, regardless of whether the cell was colored before the operation. '
b'The sheet after applying all qq operations is called a coloring. Two colorings are different if there exists at least one cell that is colored in different colors.'
b'How many different colorings are there? Print the number modulo 998244353998244353.'
b'Input'
b'The first line contains a single integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104)\xc2\xa0\xe2\x80\x94 the number of testcases.'
b'The first line of the testcase contains four integers n,m,kn,m,k and qq (1\xe2\x89\xa4n,m,k,q\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n,m,k,q\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the size of the sheet, the number of non-white colors and the number of operations.'
b'The ii-th of the following qq lines contains a description of the ii-th operation\xc2\xa0\xe2\x80\x94 two integers xixi and yiyi (1\xe2\x89\xa4xi\xe2\x89\xa4n1\xe2\x89\xa4xi\xe2\x89\xa4n; 1\xe2\x89\xa4yi\xe2\x89\xa4m1\xe2\x89\xa4yi\xe2\x89\xa4m)\xc2\xa0\xe2\x80\x94 the row and the column the operation is applied to.'
b"The sum of qq over all testcases doesn't exceed 2\xe2\x8b\x851052\xe2\x8b\x85105."
b'Output'
b'For each testcase, print a single integer\xc2\xa0\xe2\x80\x94 the number of different colorings modulo 998244353998244353.'
Tags
data structures, implementation, math, *1700
