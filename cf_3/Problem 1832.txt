b'In the wilds far beyond lies the Land of Sacredness, which can be viewed as a tree \xc2\xa0\xe2\x80\x94 connected undirected graph consisting of nn nodes and n\xe2\x88\x921n\xe2\x88\x921 edges. The nodes are numbered from 11 to nn. '
b'There are mm travelers attracted by its prosperity and beauty. Thereupon, they set off their journey on this land. The ii-th traveler will travel along the shortest path from sisi to titi. In doing so, they will go through all edges in the shortest path from sisi to titi, which is unique in the tree.'
b'During their journey, the travelers will acquaint themselves with the others. Some may even become friends. To be specific, the ii-th traveler and the jj-th traveler will become friends if and only if there are at least kk edges that both the ii-th traveler and the jj-th traveler will go through. '
b'Your task is to find out the number of pairs of travelers (i,j)(i,j) satisfying the following conditions: '
b'  1\xe2\x89\xa4i<j\xe2\x89\xa4m1\xe2\x89\xa4i<j\xe2\x89\xa4m.  the ii-th traveler and the jj-th traveler will become friends. '
b'Input'
b'The first line contains three integers nn, mm and kk (2\xe2\x89\xa4n,m\xe2\x89\xa41.5\xe2\x8b\x851052\xe2\x89\xa4n,m\xe2\x89\xa41.5\xe2\x8b\x85105, 1\xe2\x89\xa4k\xe2\x89\xa4n1\xe2\x89\xa4k\xe2\x89\xa4n). '
b'Each of the next n\xe2\x88\x921n\xe2\x88\x921 lines contains two integers uu and vv (1\xe2\x89\xa4u,v\xe2\x89\xa4n1\xe2\x89\xa4u,v\xe2\x89\xa4n), denoting there is an edge between uu and vv. '
b'The ii-th line of the next mm lines contains two integers sisi and titi (1\xe2\x89\xa4si,ti\xe2\x89\xa4n1\xe2\x89\xa4si,ti\xe2\x89\xa4n, si\xe2\x89\xa0tisi\xe2\x89\xa0ti), denoting the starting point and the destination of ii-th traveler. '
b'It is guaranteed that the given edges form a tree.'
b'Output'
b'The only line contains a single integer \xc2\xa0\xe2\x80\x94 the number of pairs of travelers satisfying the given conditions.'
Tags
data structures, divide and conquer, graphs, trees, *3500
