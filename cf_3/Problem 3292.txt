b'Ildar took a band (a thin strip of cloth) and colored it. Formally, the band has nn cells, each of them is colored into one of 2626 colors, so we can denote each color with one of the lowercase letters of English alphabet. '
b'Ildar decided to take some segment of the band [l,r][l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) he likes and cut it from the band. So he will create a new band that can be represented as a string t=slsl+1\xe2\x80\xa6srt=slsl+1\xe2\x80\xa6sr.'
b'After that Ildar will play the following game: he cuts the band tt into some new bands and counts the number of different bands among them. Formally, Ildar chooses 1\xe2\x89\xa4k\xe2\x89\xa4|t|1\xe2\x89\xa4k\xe2\x89\xa4|t| indexes 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik=|t|1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik=|t| and cuts tt to kk bands-strings t1t2\xe2\x80\xa6ti1,ti1+1\xe2\x80\xa6ti2,\xe2\x80\xa6,tik\xe2\x88\x921+1\xe2\x80\xa6tikt1t2\xe2\x80\xa6ti1,ti1+1\xe2\x80\xa6ti2,\xe2\x80\xa6,tik\xe2\x88\x921+1\xe2\x80\xa6tik and counts the number of different bands among them. He wants to know the minimal possible number of different bands he can get under the constraint that at least one band repeats at least two times. The result of the game is this number. If it is impossible to cut tt in such a way, the result of the game is -1.'
b"Unfortunately Ildar hasn't yet decided which segment he likes, but he has qq segments-candidates [l1,r1][l1,r1], [l2,r2][l2,r2], ..., [lq,rq][lq,rq]. Your task is to calculate the result of the game for each of them."
b'Input'
b'The first line contains one integer nn (1\xe2\x89\xa4n\xe2\x89\xa42000001\xe2\x89\xa4n\xe2\x89\xa4200000)\xc2\xa0\xe2\x80\x94 the length of the band Ildar has.'
b'The second line contains a string ss consisting of nn lowercase English letters\xc2\xa0\xe2\x80\x94 the band Ildar has.'
b'The third line contains a single integer qq (1\xe2\x89\xa4q\xe2\x89\xa42000001\xe2\x89\xa4q\xe2\x89\xa4200000)\xc2\xa0\xe2\x80\x94 the number of segments Ildar has chosen as candidates.'
b'Each of the next qq lines contains two integer integers lili and riri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n) denoting the ends of the ii-th segment.'
b'Output'
b'Output qq lines, where the ii-th of them should contain the result of the game on the segment [li,ri][li,ri].'
Tags
data structures, divide and conquer, hashing, string suffix structures, strings, *3500
