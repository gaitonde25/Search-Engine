b'While looking at the kitchen fridge, the little boy Tyler noticed magnets with symbols, that can be aligned into a string ss.'
b"Tyler likes strings, and especially those that are lexicographically smaller than another string, tt. After playing with magnets on the fridge, he is wondering, how many distinct strings can be composed out of letters of string ss by rearranging them, so that the resulting string is lexicographically smaller than the string tt? Tyler is too young, so he can't answer this question. The alphabet Tyler uses is very large, so for your convenience he has already replaced the same letters in ss and tt to the same integers, keeping that different letters have been replaced to different integers."
b'We call a string xx lexicographically smaller than a string yy if one of the followings conditions is fulfilled: '
b'  There exists such position of symbol mm that is presented in both strings, so that before mm-th symbol the strings are equal, and the mm-th symbol of string xx is smaller than mm-th symbol of string yy.  String xx is the prefix of string yy and x\xe2\x89\xa0yx\xe2\x89\xa0y. '
b'Because the answer can be too large, print it modulo 998244353998244353.'
b'Input'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n,m\xe2\x89\xa42000001\xe2\x89\xa4n,m\xe2\x89\xa4200000)\xc2\xa0\xe2\x80\x94 the lengths of strings ss and tt respectively.'
b'The second line contains nn integers s1,s2,s3,\xe2\x80\xa6,sns1,s2,s3,\xe2\x80\xa6,sn (1\xe2\x89\xa4si\xe2\x89\xa42000001\xe2\x89\xa4si\xe2\x89\xa4200000)\xc2\xa0\xe2\x80\x94 letters of the string ss.'
b'The third line contains mm integers t1,t2,t3,\xe2\x80\xa6,tmt1,t2,t3,\xe2\x80\xa6,tm (1\xe2\x89\xa4ti\xe2\x89\xa42000001\xe2\x89\xa4ti\xe2\x89\xa4200000)\xc2\xa0\xe2\x80\x94 letters of the string tt.'
b'Output'
b'Print a single number\xc2\xa0\xe2\x80\x94 the number of strings lexicographically smaller than tt that can be obtained by rearranging the letters in ss, modulo 998244353998244353.'
Tags
combinatorics, data structures, implementation, *1900
