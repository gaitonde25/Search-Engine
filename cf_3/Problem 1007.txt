b'Qingshan and Daniel are going to play a card game. But it will be so boring if only two persons play this. So they will make nn robots in total to play this game automatically. Robots made by Qingshan belong to the team 11, and robots made by Daniel belong to the team 22. Robot ii belongs to team titi. Before the game starts, aiai cards are given for robot ii.'
b'The rules for this card game are simple: '
b"  Before the start, the robots are arranged in a circle in the order or their indices. The robots will discard cards in some order, in each step one robot discards a single card. When the game starts, robot 11 will discard one of its cards. After that, robots will follow the following rules:  If robot ii discards the card last, the nearest robot whose team is opposite from ii's will discard the card next. In another word jj will discard a card right after ii, if and only if among all jj that satisfy ti\xe2\x89\xa0tjti\xe2\x89\xa0tj, dist(i,j)dist(i,j) (definition is below) is minimum.  The robot who has no cards should quit the game immediately. This robot won't be considered in the next steps.  When no robot can discard the card next, the game ends. "
b'We define the distance from robot xx to robot yy as dist(x,y)=(y\xe2\x88\x92x+n)modndist(x,y)=(y\xe2\x88\x92x+n)modn. It is similar to the oriented distance on the circle.'
b'For example, when n=5n=5, the distance from 11 to 33 is dist(1,3)=(3\xe2\x88\x921+5)mod5=2dist(1,3)=(3\xe2\x88\x921+5)mod5=2, the distance from 33 to 11 is dist(3,1)=(1\xe2\x88\x923+5)mod5=3dist(3,1)=(1\xe2\x88\x923+5)mod5=3.'
b"Later, Qingshan finds out that it will take so much time to see how robots play. She wants to know the result as quickly as possible. You, as Qingshan's fan, are asked to calculate an array [ans1,ans2,\xe2\x80\xa6,ansn][ans1,ans2,\xe2\x80\xa6,ansn]\xc2\xa0\xe2\x80\x94 ansiansi is equal to the number of cards, that ii-th robot will discard during the game. You need to hurry!"
b'To avoid the large size of the input, the team and the number of cards of each robot will be generated in your code with some auxiliary arrays.'
b'Input'
b'The first line contains one integer nn (1\xe2\x89\xa4n\xe2\x89\xa45\xe2\x8b\x851061\xe2\x89\xa4n\xe2\x89\xa45\xe2\x8b\x85106)\xc2\xa0\xe2\x80\x94 the number of robots playing this game.'
b'The second line contains one integer mm (1\xe2\x89\xa4m\xe2\x89\xa4min(n,200000)1\xe2\x89\xa4m\xe2\x89\xa4min(n,200000)).'
b"Each of the next mm line contains four integers pipi, kiki, bibi, wiwi (1\xe2\x89\xa4pi\xe2\x89\xa4n1\xe2\x89\xa4pi\xe2\x89\xa4n, 1\xe2\x89\xa4ki\xe2\x89\xa4109+71\xe2\x89\xa4ki\xe2\x89\xa4109+7, 0\xe2\x89\xa4bi,wi<ki0\xe2\x89\xa4bi,wi<ki). It's guaranteed that pm=npm=n and pj\xe2\x88\x921<pjpj\xe2\x88\x921<pj (2\xe2\x89\xa4j\xe2\x89\xa4m2\xe2\x89\xa4j\xe2\x89\xa4m)."
b'Arrays ajaj and tjtj should be generated by the following pseudo code:'
b'seed = 0base = 0function rnd():\tret = seed\tseed = (seed * base + 233) mod 1000000007\treturn retp[0] = 0for i = 1 to m:\tseed = b[i]\tbase = w[i]\tfor j = p[i - 1] + 1 to p[i]:\t\tt[j] = (rnd() mod 2) + 1\t\ta[j] = (rnd() mod k[i]) + 1'
b'Output'
b'Print a single integer (\xe2\x88\x8fni=1((ansi\xe2\x8a\x95i2)+1))mod109+7(\xe2\x88\x8fi=1n((ansi\xe2\x8a\x95i2)+1))mod109+7, where \xe2\x8a\x95\xe2\x8a\x95 denotes the bitwise XOR operation.'
Tags
brute force, data structures, greedy, implementation, *3200
