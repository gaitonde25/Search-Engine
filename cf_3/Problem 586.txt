b'Ivan is playing yet another roguelike computer game. He controls a single hero in the game. The hero has nn equipment slots. There is a list of cici items for the ii-th slot, the jj-th of them increases the hero strength by ai,jai,j. The items for each slot are pairwise distinct and are listed in the increasing order of their strength increase. So, ai,1<ai,2<\xe2\x8b\xaf<ai,ciai,1<ai,2<\xe2\x8b\xaf<ai,ci.'
b'For each slot Ivan chooses exactly one item. Let the chosen item for the ii-th slot be the bibi-th item in the corresponding list. The sequence of choices [b1,b2,\xe2\x80\xa6,bn][b1,b2,\xe2\x80\xa6,bn] is called a build.'
b"The strength of a build is the sum of the strength increases of the items in it. Some builds are banned from the game. There is a list of mm pairwise distinct banned builds. It's guaranteed that there's at least one build that's not banned."
b'What is the build with the maximum strength that is not banned from the game? If there are multiple builds with maximum strength, print any of them.'
b'Input'
b'The first line contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa4101\xe2\x89\xa4n\xe2\x89\xa410)\xc2\xa0\xe2\x80\x94 the number of equipment slots.'
b'The ii-th of the next nn lines contains the description of the items for the ii-th slot. First, one integer cici (1\xe2\x89\xa4ci\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4ci\xe2\x89\xa42\xe2\x8b\x85105)\xc2\xa0\xe2\x80\x94 the number of items for the ii-th slot. Then cici integers ai,1,ai,2,\xe2\x80\xa6,ai,ciai,1,ai,2,\xe2\x80\xa6,ai,ci (1\xe2\x89\xa4ai,1<ai,2<\xe2\x8b\xaf<ai,ci\xe2\x89\xa41081\xe2\x89\xa4ai,1<ai,2<\xe2\x8b\xaf<ai,ci\xe2\x89\xa4108).'
b"The sum of cici doesn't exceed 2\xe2\x8b\x851052\xe2\x8b\x85105."
b'The next line contains a single integer mm (0\xe2\x89\xa4m\xe2\x89\xa41050\xe2\x89\xa4m\xe2\x89\xa4105)\xc2\xa0\xe2\x80\x94 the number of banned builds.'
b'Each of the next mm lines contains a description of a banned build\xc2\xa0\xe2\x80\x94 a sequence of nn integers b1,b2,\xe2\x80\xa6,bnb1,b2,\xe2\x80\xa6,bn (1\xe2\x89\xa4bi\xe2\x89\xa4ci1\xe2\x89\xa4bi\xe2\x89\xa4ci).'
b"The builds are pairwise distinct, and there's at least one build that's not banned."
b'Output'
b'Print the build with the maximum strength that is not banned from the game. If there are multiple builds with maximum strength, print any of them.'
Tags
binary search, brute force, data structures, dfs and similar, graphs, greedy, hashing, implementation, *2000
