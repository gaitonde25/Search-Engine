b'Spring cleanings are probably the most boring parts of our lives, except this year, when Fl\xc3\xb3ra and her mother found a dusty old tree graph under the carpet.'
b"This tree has NN nodes (numbered from 11 to NN), connected by N\xe2\x88\x921N\xe2\x88\x921 edges. The edges gathered too much dust, so Fl\xc3\xb3ra's mom decided to clean them. "
b'Cleaning the edges of an arbitrary tree is done by repeating the following process:   She chooses 2 different leaves (a node is a leaf if it is connected to exactly one other node by an edge), and cleans every edge lying on the shortest path between them. If this path has dd edges, then the cost of cleaning this path is dd.'
b"She doesn't want to harm the leaves of the tree, so she chooses every one of them at most once. A tree is cleaned when all of its edges are cleaned. The cost of this is the sum of costs for all cleaned paths."
b'Fl\xc3\xb3ra thinks the tree they found is too small and simple, so she imagines QQ variations of it. In the ii-th variation, she adds a total of DiDi extra leaves to the original tree: for each new leaf, she chooses a node from the original tree, and connects that node with the new leaf by an edge. Note that some nodes may stop being leaves during this step.'
b'For all these QQ variations, we are interested in the minimum cost that is required to clean the tree.'
b'Input'
b'The first line contains two space-separated integer, NN and QQ (3\xe2\x89\xa4N\xe2\x89\xa41053\xe2\x89\xa4N\xe2\x89\xa4105, 1\xe2\x89\xa4Q\xe2\x89\xa41051\xe2\x89\xa4Q\xe2\x89\xa4105) \xe2\x80\x93 the number of nodes the tree has and the number of variations.'
b' Each of the next N\xe2\x88\x921N\xe2\x88\x921 lines contains two space-separated integers uu and vv denoting that nodes uu and vv are connected by an edge (1\xe2\x89\xa4u,v\xe2\x89\xa4N1\xe2\x89\xa4u,v\xe2\x89\xa4N).'
b' The next QQ lines describe the variations.  The first integer in the iith line is DiDi (1\xe2\x89\xa4Di\xe2\x89\xa41051\xe2\x89\xa4Di\xe2\x89\xa4105). Then DiDi space-separated integers follow: if the jjth number is ajaj, it means that Fl\xc3\xb3ra adds a new leaf to node ajaj (1\xe2\x89\xa4aj\xe2\x89\xa4N1\xe2\x89\xa4aj\xe2\x89\xa4N). We may add more than one leaf to the same node. \xe2\x88\x91Q1Di\xe2\x89\xa4105\xe2\x88\x911QDi\xe2\x89\xa4105 i.e. the sum of DiDi in all varations is at most 105105.'
b'After each variation, Fl\xc3\xb3ra restarts and adds extra leaves to the original tree.'
b'Output'
b'You should print QQ lines. In the ii-th line, print a single integer: the minimum cost required to clean the ii-th variation of the tree. If the tree cannot be cleaned, print \xe2\x88\x921\xe2\x88\x921.'
Tags
*special problem, data structures, dfs and similar, graphs, trees, *2300
