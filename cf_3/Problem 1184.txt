b"Ivan is a programming teacher. During the academic year, he plans to give nn lectures on nn different topics. Each topic should be used in exactly one lecture. Ivan wants to choose which topic will he explain during the 11-st, 22-nd, ..., nn-th lecture \xe2\x80\x94 formally, he wants to choose some permutation of integers from 11 to nn (let's call this permutation qq). qiqi is the index of the topic Ivan will explain during the ii-th lecture."
b'For each topic (except exactly one), there exists a prerequisite topic (for the topic ii, the prerequisite topic is pipi). Ivan cannot give a lecture on a topic before giving a lecture on its prerequisite topic. There exists at least one valid ordering of topics according to these prerequisite constraints.'
b'Ordering the topics correctly can help students understand the lectures better. Ivan has kk special pairs of topics (xi,yi)(xi,yi) such that he knows that the students will understand the yiyi-th topic better if the lecture on it is conducted right after the lecture on the xixi-th topic. Ivan wants to satisfy the constraints on every such pair, that is, for every i\xe2\x88\x88[1,k]i\xe2\x88\x88[1,k], there should exist some j\xe2\x88\x88[1,n\xe2\x88\x921]j\xe2\x88\x88[1,n\xe2\x88\x921] such that qj=xiqj=xi and qj+1=yiqj+1=yi.'
b'Now Ivan wants to know if there exists an ordering of topics that satisfies all these constraints, and if at least one exists, find any of them. '
b'Input'
b'The first line contains two integers nn and kk (2\xe2\x89\xa4n\xe2\x89\xa43\xe2\x8b\x851052\xe2\x89\xa4n\xe2\x89\xa43\xe2\x8b\x85105, 1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921) \xe2\x80\x94 the number of topics and the number of special pairs of topics, respectively.'
b'The second line contains nn integers p1p1, p2p2, ..., pnpn (0\xe2\x89\xa4pi\xe2\x89\xa4n0\xe2\x89\xa4pi\xe2\x89\xa4n), where pipi is the prerequisite topic for the topic ii (or pi=0pi=0 if the ii-th topic has no prerequisite topics). Exactly one of these integers is 00. At least one ordering of topics such that for every ii the pipi-th topic is placed before the ii-th topic exists.'
b'Then kk lines follow, the ii-th line contains two integers xixi and yiyi (1\xe2\x89\xa4xi,yi\xe2\x89\xa4n1\xe2\x89\xa4xi,yi\xe2\x89\xa4n; xi\xe2\x89\xa0yixi\xe2\x89\xa0yi) \xe2\x80\x94 the topics from the ii-th special pair. All values of xixi are pairwise distinct; similarly, all valus of yiyi are pairwise distinct.'
b'Output'
b'If there is no ordering of topics meeting all the constraints, print 00.'
b'Otherwise, print nn pairwise distinct integers q1q1, q2q2, ..., qnqn (1\xe2\x89\xa4qi\xe2\x89\xa4n1\xe2\x89\xa4qi\xe2\x89\xa4n) \xe2\x80\x94 the ordering of topics meeting all of the constraints. If there are multiple answers, print any of them.'
Tags
constructive algorithms, dfs and similar, dsu, graphs, implementation, sortings, trees, *2400
