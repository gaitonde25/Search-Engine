b'Limak is a smart brown bear who loves chemistry, reactions and transforming elements.'
b"In Bearland (Limak's home) there are n elements, numbered 1 through n. There are also special machines, that can transform elements. Each machine is described by two integers ai,\xe2\x80\x89bi representing two elements, not necessarily distinct. One can use a machine either to transform an element ai to bi or to transform bi to ai. Machines in Bearland aren't very resistant and each of them can be used at most once. It is possible that ai\xe2\x80\x89=\xe2\x80\x89bi and that many machines have the same pair ai,\xe2\x80\x89bi."
b"Radewoosh is Limak's biggest enemy and rival. He wants to test Limak in the chemistry. They will meet tomorrow and both of them will bring all their machines. Limak has m machines but he doesn't know much about his enemy. They agreed Radewoosh will choose two distinct elements, let's denote them as x and y. Limak will be allowed to use both his and Radewoosh's machines. He may use zero or more (maybe even all) machines to achieve the goal, each machine at most once. Limak will start from an element x and his task will be to first get an element y and then to again get an element x\xc2\xa0\xe2\x80\x94 then we say that he succeeds. After that Radewoosh would agree that Limak knows the chemistry (and Radewoosh would go away)."
b'Radewoosh likes some particular non-empty set of favorite elements and he will choose x,\xe2\x80\x89y from that set. Limak doesn\'t know exactly which elements are in the set and also he doesn\'t know what machines Radewoosh has. Limak has heard q gossips (queries) though and each of them consists of Radewoosh\'s machines and favorite elements. For each gossip Limak wonders if he would be able to succeed tomorrow for every pair x,\xe2\x80\x89y chosen from the set of favorite elements. If yes then print "YES" (without the quotes). But if there exists a pair (x,\xe2\x80\x89y) from the given set that Limak wouldn\'t be able to succeed then you should print "NO" (without the quotes).'
b'Input'
b"The first line contains three integers n, m and q (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89300\xe2\x80\x89000,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89300\xe2\x80\x89000)\xc2\xa0\xe2\x80\x94 the number of elements, the number of Limak's machines and the number of gossips, respectively."
b"Each of the next m lines contains two integers ai and bi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) describing one of Limak's machines."
b'Then, the description of q gossips follows.'
b'The first line of the description of the i-th gossip contains two integers ni and mi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ni\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89300\xe2\x80\x89000,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89300\xe2\x80\x89000). The second line contains ni distinct integers xi,\xe2\x80\x891,\xe2\x80\x89xi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89xi,\xe2\x80\x89ni (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)\xc2\xa0\xe2\x80\x94 Radewoosh\'s favorite elements in the i-th gossip. Note that ni\xe2\x80\x89=\xe2\x80\x891 is allowed, in this case there are no pairs of distinct elements, so Limak automatically wins (the answer is "YES"). Then mi lines follow, each containing two integers ai,\xe2\x80\x89j,\xe2\x80\x89bi,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89j,\xe2\x80\x89bi,\xe2\x80\x89j) describing one of Radewoosh\'s machines in the i-th gossip.'
b"The sum of ni over all gossips won't exceed 300\xe2\x80\x89000. Also, the sum of mi over all gossips won't exceed 300\xe2\x80\x89000."
b"Important: Because we want you to process the gossips online, in order to know the elements in Radewoosh's favorite set and elements that his machines can transform, for on each number that denotes them in the input you should use following function:"
b'int rotate(int element){   element=(element+R)%n;   if (element==0) {       element=n;   }   return element;}'
b'where R is initially equal to 0 and is increased by the number of the query any time the answer is "YES". Queries are numbered starting with 1 in the order they appear in the input.'
b'Output'
b'You should print q lines. The i-th of them should contain "YES" (without quotes) if for the i-th gossip for each pair of elements x and y (in the set xi,\xe2\x80\x891,\xe2\x80\x89xi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89xi,\xe2\x80\x89ni) Limak is able to succeed. Otherwise you should print "NO" (without quotes).'
Tags
data structures, dfs and similar, graphs, trees, *3300
