b'  '
b'William is not only interested in trading but also in betting on sports matches. nn teams participate in each match. Each team is characterized by strength aiai. Each two teams i<ji<j play with each other exactly once. Team ii wins with probability aiai+ajaiai+aj and team jj wins with probability ajai+ajajai+aj.'
b'The team is called a winner if it directly or indirectly defeated all other teams. Team aa defeated (directly or indirectly) team bb if there is a sequence of teams c1c1, c2c2, ... ckck such that c1=ac1=a, ck=bck=b and team cici defeated team ci+1ci+1 for all ii from 11 to k\xe2\x88\x921k\xe2\x88\x921. Note that it is possible that team aa defeated team bb and in the same time team bb defeated team aa.'
b'William wants you to find the expected value of the number of winners.'
b'Input'
b'The first line contains a single integer nn (1\xe2\x89\xa4n\xe2\x89\xa4141\xe2\x89\xa4n\xe2\x89\xa414), which is the total number of teams participating in a match.'
b'The second line contains nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa41061\xe2\x89\xa4ai\xe2\x89\xa4106) \xc2\xa0\xe2\x80\x94 the strengths of teams participating in a match.'
b'Output'
b'Output a single integer \xc2\xa0\xe2\x80\x94 the expected value of the number of winners of the tournament modulo 109+7109+7.'
b'Formally, let M=109+7M=109+7. It can be demonstrated that the answer can be presented as a irreducible fraction pqpq, where pp and qq are integers and q\xe2\x89\xa1\xcc\xb80(modM)q\xe2\x89\xa20(modM). Output a single integer equal to p\xe2\x8b\x85q\xe2\x88\x921modMp\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output an integer xx such that 0\xe2\x89\xa4x<M0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)x\xe2\x8b\x85q\xe2\x89\xa1p(modM).'
Tags
bitmasks, combinatorics, dp, graphs, math, probabilities, *2500
