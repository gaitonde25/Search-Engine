b'2k2k teams participate in a playoff tournament. The tournament consists of 2k\xe2\x88\x9212k\xe2\x88\x921 games. They are held as follows: first of all, the teams are split into pairs: team 11 plays against team 22, team 33 plays against team 44 (exactly in this order), and so on (so, 2k\xe2\x88\x9212k\xe2\x88\x921 games are played in that phase). When a team loses a game, it is eliminated, and each game results in elimination of one team (there are no ties). After that, only 2k\xe2\x88\x9212k\xe2\x88\x921 teams remain. If only one team remains, it is declared the champion; otherwise, 2k\xe2\x88\x9222k\xe2\x88\x922 games are played: in the first one of them, the winner of the game "11 vs 22" plays against the winner of the game "33 vs 44", then the winner of the game "55 vs 66" plays against the winner of the game "77 vs 88", and so on. This process repeats until only one team remains.'
b'After the tournament ends, the teams are assigned places according to the tournament phase when they were eliminated. In particular:'
b'  the winner of the tournament gets place 11;  the team eliminated in the finals gets place 22;  both teams eliminated in the semifinals get place 33;  all teams eliminated in the quarterfinals get place 55;  all teams eliminated in the 1/8 finals get place 99, and so on. '
b'For example, this picture describes one of the possible ways the tournament can go with k=3k=3, and the resulting places of the teams:'
b'  '
b'After a tournament which was conducted by the aforementioned rules ended, its results were encoded in the following way. Let pipi be the place of the ii-th team in the tournament. The hash value of the tournament hh is calculated as h=(\xe2\x88\x91i=12ki\xe2\x8b\x85Api)mod998244353h=(\xe2\x88\x91i=12ki\xe2\x8b\x85Api)mod998244353, where AA is some given integer.'
b'Unfortunately, due to a system crash, almost all tournament-related data was lost. The only pieces of data that remain are the values of kk, AA and hh. You are asked to restore the resulting placing of the teams in the tournament, if it is possible at all.'
b'Input'
b'The only line contains three integers kk, AA and hh (1\xe2\x89\xa4k\xe2\x89\xa451\xe2\x89\xa4k\xe2\x89\xa45; 100\xe2\x89\xa4A\xe2\x89\xa4108100\xe2\x89\xa4A\xe2\x89\xa4108; 0\xe2\x89\xa4h\xe2\x89\xa49982443520\xe2\x89\xa4h\xe2\x89\xa4998244352).'
b'Output'
b'If it is impossible to find any placing of the teams that is consistent with the data you have, print one integer \xe2\x88\x921\xe2\x88\x921.'
b'Otherwise, print 2k2k integers, where ii-th integer should be equal to pipi (the place of the ii-th team). Note that your answer should be consistent with one of the possible ways the tournament could go, and note that the initial structure of the tournament is fixed (for example, teams 11 and 22 always play in the first phase of the tournament against each other). If there are multiple ways to restore the places of the teams which are consistent with the data you have, print any of them.'
Tags
bitmasks, brute force, hashing, implementation, meet-in-the-middle, *2600
