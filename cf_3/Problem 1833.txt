b'This is the hard version of the problem. The only difference between easy and hard versions is the constraint of mm. You can make hacks only if both versions are solved.'
b'Chiori loves dolls and now she is going to decorate her bedroom!'
b''
b'\xc2\xa0'
b'As a doll collector, Chiori has got nn dolls. The ii-th doll has a non-negative integer value aiai (ai<2mai<2m, mm is given). Chiori wants to pick some (maybe zero) dolls for the decoration, so there are 2n2n different picking ways.'
b'Let xx be the bitwise-xor-sum of values of dolls Chiori picks (in case Chiori picks no dolls x=0x=0). The value of this picking way is equal to the number of 11-bits in the binary representation of xx. More formally, it is also equal to the number of indices 0\xe2\x89\xa4i<m0\xe2\x89\xa4i<m, such that \xe2\x8c\x8ax2i\xe2\x8c\x8b\xe2\x8c\x8ax2i\xe2\x8c\x8b is odd.'
b'Tell her the number of picking ways with value ii for each integer ii from 00 to mm. Due to the answers can be very huge, print them by modulo 998244353998244353.'
b'Input'
b'The first line contains two integers nn and mm (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851051\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105, 0\xe2\x89\xa4m\xe2\x89\xa4530\xe2\x89\xa4m\xe2\x89\xa453) \xc2\xa0\xe2\x80\x94 the number of dolls and the maximum value of the picking way.'
b'The second line contains nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an (0\xe2\x89\xa4ai<2m0\xe2\x89\xa4ai<2m) \xc2\xa0\xe2\x80\x94 the values of dolls.'
b'Output'
b'Print m+1m+1 integers p0,p1,\xe2\x80\xa6,pmp0,p1,\xe2\x80\xa6,pm \xc2\xa0\xe2\x80\x94 pipi is equal to the number of picking ways with value ii by modulo 998244353998244353.'
Tags
bitmasks, brute force, combinatorics, math, *3500
