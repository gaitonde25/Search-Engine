b'Heidi enjoyed performing the simulation because she knew exactly when a new universe would be formed and where, and when a non-existent link would be broken and where.'
b'However, the multiverse itself works in mysterious ways. Well, it works using probabilities, which to some people is mysterious.'
b"At each unit time, when a decision is made, one of the two events will happen randomly. Let's denote ll as the current length of the multiverse. With a probability of pcreate=1\xe2\x88\x92lmpcreate=1\xe2\x88\x92lm, a universe will be created. With a probability of pbreak=lmpbreak=lm, a non-existent link will be broken at some position."
b'More specifically, '
b'  When a universe is created, it will manifest itself between any two adjacent universes or at one of the ends. Each position occurs with a probability of 1l+11l+1.   When a link is broken, it could be cut between any two adjacent universes, each with a probability of 1l\xe2\x88\x9211l\xe2\x88\x921. After separating the multiverse into two segments, the segment NOT containing the Doctor will cease to exist. '
b'As earlier, the Doctor remains in the same universe. However, if at some point the multiverse breaks in such a way that the Doctor finds himself at the leftmost or rightmost end of it, the TARDIS stops functioning.'
b'In such a case, the Doctor must actually walk across the multiverse to find the tools to fix it.'
b'We are interested in the expected value of the length of the multiverse when such an event occurs.'
b'Input'
b'The first and only line contains three integers nn, kk and mm (1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x89\xa4m\xe2\x89\xa4250)(1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x89\xa4m\xe2\x89\xa4250), the initial length of the multiverse, the initial position of the Doctor, and the maximum possible length of the multiverse.'
b'Output'
b'Output a single integer on a single line, indicating the expected length of the multiverse.'
b'If the answer is pqpq, please print rr where p\xe2\x89\xa1r\xe2\x8b\x85q(mod\xc2\xa0109+7)p\xe2\x89\xa1r\xe2\x8b\x85q(mod\xc2\xa0109+7).'
Tags
math, matrices, *3100
