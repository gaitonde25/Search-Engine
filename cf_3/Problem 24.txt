b'You are given a rooted tree consisting of nn vertices numbered from 11 to nn. The root is vertex 11. There is also a string ss denoting the color of each vertex: if si=Bsi=B, then vertex ii is black, and if si=Wsi=W, then vertex ii is white.'
b'A subtree of the tree is called balanced if the number of white vertices equals the number of black vertices. Count the number of balanced subtrees.'
b'A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root. In this problem, all trees have root 11.'
b'The tree is specified by an array of parents a2,\xe2\x80\xa6,ana2,\xe2\x80\xa6,an containing n\xe2\x88\x921n\xe2\x88\x921 numbers: aiai is the parent of the vertex with the number ii for all i=2,\xe2\x80\xa6,ni=2,\xe2\x80\xa6,n. The parent of a vertex uu is a vertex that is the next vertex on a simple path from uu to the root.'
b'The subtree of a vertex uu is the set of all vertices that pass through uu on a simple path to the root. For example, in the picture below, 77 is in the subtree of 33 because the simple path 7\xe2\x86\x925\xe2\x86\x923\xe2\x86\x9217\xe2\x86\x925\xe2\x86\x923\xe2\x86\x921 passes through 33. Note that a vertex is included in its subtree, and the subtree of the root is the entire tree.'
b'  The picture shows the tree for n=7n=7, a=[1,1,2,3,3,5]a=[1,1,2,3,3,5], and s=WBBWWBWs=WBBWWBW. The subtree at the vertex 33 is balanced. '
b'Input'
b'The first line of input contains an integer tt (1\xe2\x89\xa4t\xe2\x89\xa41041\xe2\x89\xa4t\xe2\x89\xa4104) \xe2\x80\x94 the number of test cases.'
b'The first line of each test case contains an integer nn (2\xe2\x89\xa4n\xe2\x89\xa440002\xe2\x89\xa4n\xe2\x89\xa44000)\xc2\xa0\xe2\x80\x94 the number of vertices in the tree.'
b'The second line of each test case contains n\xe2\x88\x921n\xe2\x88\x921 integers a2,\xe2\x80\xa6,ana2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai<i1\xe2\x89\xa4ai<i)\xc2\xa0\xe2\x80\x94 the parents of the vertices 2,\xe2\x80\xa6,n2,\xe2\x80\xa6,n.'
b'The third line of each test case contains a string ss of length nn consisting of the characters BB and WW\xc2\xa0\xe2\x80\x94 the coloring of the tree.'
b'It is guaranteed that the sum of the values nn over all test cases does not exceed 2\xe2\x8b\x851052\xe2\x8b\x85105.'
b'Output'
b'For each test case, output a single integer\xc2\xa0\xe2\x80\x94 the number of balanced subtrees.'
Tags
dfs and similar, dp, graphs, trees, *1300
