b'An electrical grid in Berland palaces consists of 2 grids: main and reserve. Wires in palaces are made of expensive material, so selling some of them would be a good idea!'
b'Each grid (main and reserve) has a head node (its number is 11). Every other node gets electricity from the head node. Each node can be reached from the head node by a unique path. Also, both grids have exactly nn nodes, which do not spread electricity further.'
b'In other words, every grid is a rooted directed tree on nn leaves with a root in the node, which number is 11. Each tree has independent enumeration and nodes from one grid are not connected with nodes of another grid.'
b"Also, the palace has nn electrical devices. Each device is connected with one node of the main grid and with one node of the reserve grid. Devices connect only with nodes, from which electricity is not spread further (these nodes are the tree's leaves). Each grid's leaf is connected with exactly one device."
b'  In this example the main grid contains 66 nodes (the top tree) and the reserve grid contains 44 nodes (the lower tree). There are 33 devices with numbers colored in blue. '
b'It is guaranteed that the whole grid (two grids and nn devices) can be shown in this way (like in the picture above):'
b"  main grid is a top tree, whose wires are directed 'from the top to the down',  reserve grid is a lower tree, whose wires are directed 'from the down to the top',  devices\xc2\xa0\xe2\x80\x94 horizontal row between two grids, which are numbered from 11 to nn from the left to the right,  wires between nodes do not intersect. "
b'Formally, for each tree exists a depth-first search from the node with number 11, that visits leaves in order of connection to devices 1,2,\xe2\x80\xa6,n1,2,\xe2\x80\xa6,n (firstly, the node, that is connected to the device 11, then the node, that is connected to the device 22, etc.).'
b'Businessman wants to sell (remove) maximal amount of wires so that each device will be powered from at least one grid (main or reserve). In other words, for each device should exist at least one path to the head node (in the main grid or the reserve grid), which contains only nodes from one grid.'
b'Input'
b'The first line contains an integer nn (1\xe2\x89\xa4n\xe2\x89\xa410001\xe2\x89\xa4n\xe2\x89\xa41000) \xe2\x80\x94 the number of devices in the palace.'
b'The next line contains an integer aa (1+n\xe2\x89\xa4a\xe2\x89\xa41000+n1+n\xe2\x89\xa4a\xe2\x89\xa41000+n) \xe2\x80\x94 the amount of nodes in the main grid.'
b'Next line contains a\xe2\x88\x921a\xe2\x88\x921 integers pipi (1\xe2\x89\xa4pi\xe2\x89\xa4a1\xe2\x89\xa4pi\xe2\x89\xa4a). Each integer pipi means that the main grid contains a wire from pipi-th node to (i+1)(i+1)-th.'
b'The next line contains nn integers xixi (1\xe2\x89\xa4xi\xe2\x89\xa4a1\xe2\x89\xa4xi\xe2\x89\xa4a) \xe2\x80\x94 the number of a node in the main grid that is connected to the ii-th device.'
b'The next line contains an integer bb (1+n\xe2\x89\xa4b\xe2\x89\xa41000+n1+n\xe2\x89\xa4b\xe2\x89\xa41000+n) \xe2\x80\x94 the amount of nodes in the reserve grid.'
b'Next line contains b\xe2\x88\x921b\xe2\x88\x921 integers qiqi (1\xe2\x89\xa4qi\xe2\x89\xa4b1\xe2\x89\xa4qi\xe2\x89\xa4b). Each integer qiqi means that the reserve grid contains a wire from qiqi-th node to (i+1)(i+1)-th.'
b'The next line contains nn integers yiyi (1\xe2\x89\xa4yi\xe2\x89\xa4b1\xe2\x89\xa4yi\xe2\x89\xa4b) \xe2\x80\x94 the number of a node in the reserve grid that is connected to the ii-th device.'
b'It is guaranteed that each grid is a tree, which has exactly nn leaves and each leaf is connected with one device. Also, it is guaranteed, that for each tree exists a depth-first search from the node 11, that visits leaves in order of connection to devices.'
b'Output'
b'Print a single integer \xe2\x80\x94 the maximal amount of wires that can be cut so that each device is powered.'
Tags
data structures, dfs and similar, dp, flows, graphs, trees, *2400
