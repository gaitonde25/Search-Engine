b'As you may already know, Du\xc5\xa1an is keen on playing with railway models. He has a big map with cities that are connected with railways. His map can be seen as a graph where vertices are cities and the railways connecting them are the edges. So far, the graph corresponding to his map is a tree. As you already know, a tree is a connected acyclic undirected graph.'
b"He is curious to find out whether his railway can be optimized somehow. He wants to add so-called shortcuts, which are also railways connecting pairs of cities. This shortcut will represent the railways in the unique path in the tree between the pair of cities it connects. Since Du\xc5\xa1an doesn't like repeating the railways, he has also defined good paths in his newly obtained network (notice that after adding the shortcuts, his graph is no more a tree). He calls a path good, if no edge appears more than once, either as a regular railway edge or as an edge represented by some shortcut (Every shortcut in a good path has length 1, but uses up all the edges it represents - they can't appear again in that path). Having defined good paths, he defines good distance between two cities to be the length of the shortest good path between them. Finally, the shortcutting diameter of his network is the largest good distance between any two cities."
b'Now he is curious to find out whether it is possible to achieve shortcutting diameter less or equal than kk, while adding as few shortcuts as possible.'
b'Your solution should add no more than 10\xe2\x8b\x85n10\xe2\x8b\x85n shortcuts.'
b'Input'
b"The first line in the standard input contains an integer nn (1\xe2\x89\xa4n\xe2\x89\xa41041\xe2\x89\xa4n\xe2\x89\xa4104), representing the number of the cities in Du\xc5\xa1an's railway map, and an integer k (3\xe2\x89\xa4k\xe2\x89\xa4n3\xe2\x89\xa4k\xe2\x89\xa4n) representing the shortcutting diameter that he wants to achieve."
b'Each of the following n\xe2\x88\x921n\xe2\x88\x921 lines will contain two integers uiui and vivi (1\xe2\x89\xa4ui,vi\xe2\x89\xa4n,ui\xe2\x89\xa0vi1\xe2\x89\xa4ui,vi\xe2\x89\xa4n,ui\xe2\x89\xa0vi), meaning that there is a railway between cities uiui and vivi.'
b'Output'
b'The first line of the output should contain a number tt representing the number of the shortcuts that were added.'
b'Each of the following tt lines should contain two integers uiui and vivi, signifying that a shortcut is added between cities uiui and vivi.'
Tags
divide and conquer, graphs, trees, *3500
