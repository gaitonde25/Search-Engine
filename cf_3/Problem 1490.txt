b'Easy and hard versions are actually different problems, so we advise you to read both statements carefully.'
b'You are given a weighted rooted tree, vertex 11 is the root of this tree.'
b'A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. A parent of a vertex vv is the last different from vv vertex on the path from the root to the vertex vv. Children of vertex vv are all vertices for which vv is the parent. A vertex is a leaf if it has no children. The weighted tree is such a tree that each edge of this tree has some weight.'
b'The weight of the path is the sum of edges weights on this path. The weight of the path from the vertex to itself is 00.'
b'You can make a sequence of zero or more moves. On each move, you select an edge and divide its weight by 22 rounding down. More formally, during one move, you choose some edge ii and divide its weight by 22 rounding down (wi:=\xe2\x8c\x8awi2\xe2\x8c\x8bwi:=\xe2\x8c\x8awi2\xe2\x8c\x8b).'
b'Your task is to find the minimum number of moves required to make the sum of weights of paths from the root to each leaf at most SS. In other words, if w(i,j)w(i,j) is the weight of the path from the vertex ii to the vertex jj, then you have to make \xe2\x88\x91v\xe2\x88\x88leavesw(root,v)\xe2\x89\xa4S\xe2\x88\x91v\xe2\x88\x88leavesw(root,v)\xe2\x89\xa4S, where leavesleaves is the list of all leaves.'
b'You have to answer tt independent test cases.'
b'Input'
b'The first line of the input contains one integer tt (1\xe2\x89\xa4t\xe2\x89\xa42\xe2\x8b\x851041\xe2\x89\xa4t\xe2\x89\xa42\xe2\x8b\x85104) \xe2\x80\x94 the number of test cases. Then tt test cases follow.'
b'The first line of the test case contains two integers nn and SS (2\xe2\x89\xa4n\xe2\x89\xa4105;1\xe2\x89\xa4S\xe2\x89\xa410162\xe2\x89\xa4n\xe2\x89\xa4105;1\xe2\x89\xa4S\xe2\x89\xa41016) \xe2\x80\x94 the number of vertices in the tree and the maximum possible sum of weights you have to obtain. The next n\xe2\x88\x921n\xe2\x88\x921 lines describe edges of the tree. The edge ii is described as three integers vivi, uiui and wiwi (1\xe2\x89\xa4vi,ui\xe2\x89\xa4n;1\xe2\x89\xa4wi\xe2\x89\xa41061\xe2\x89\xa4vi,ui\xe2\x89\xa4n;1\xe2\x89\xa4wi\xe2\x89\xa4106), where vivi and uiui are vertices the edge ii connects and wiwi is the weight of this edge.'
b'It is guaranteed that the sum of nn does not exceed 105105 (\xe2\x88\x91n\xe2\x89\xa4105\xe2\x88\x91n\xe2\x89\xa4105).'
b'Output'
b'For each test case, print the answer: the minimum number of moves required to make the sum of weights of paths from the root to each leaf at most SS.'
Tags
data structures, dfs and similar, greedy, trees, *2000
